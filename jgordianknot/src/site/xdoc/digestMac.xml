<document>
    <properties>
        <title>GordianKnot Digests and Macs</title>
        <author email="Tony.Washer@yahoo.co.uk">Tony Washer</author>
    </properties>
    <body>
        <section name="Overview">
            <p>GordianKnot supports most Digests and Macs available from BouncyCastle plus some additional algorithms.</p>
            <p>JCA provides a subset of available algorithms as indicated</p>
        </section>
        <section name="Digests">
            <p>A digest is created by specifying a <strong>GordianDigestSpec</strong> which comprises the digestType/OutputLength plus StateLength if applicable.
                The digest can be used in much the same way as a JCA Digest, allowing reset, update and finalise methods.</p>
            <subsection name="Sample">
                <source>
                    /* Access factory */
                    final GordianFactory myBaseFactory = GordianGenerator.createFactory();
                    final GordianDigestFactory myDigestFactory = myBaseFactory.getDigestFactory();

                    /* Create digest */
                    final GordianDigestSpec mySpec = GordianDigestSpec.sha2(GordianLength.LEN_256);
                    final GordianDigest myDigest = myDigestFactory.createDigest(mySpec);

                    /* Calculate digest */
                    final byte[] myMessage = ...
                    myDigest.update(myMessage);
                    final byte[] myResult = myDigest.finish();
                </source>
            </subsection>
            <subsection name="Algorithms">
                <p>The following algorithms are supported.</p>
                <table class="defTable">
                    <tr><td class="defHdr">Algorithm</td><td class="defHdr">StateLength</td><td class="defHdr">OutputLengths</td>
                        <td class="defHdr">JCA</td><td class="defHdr">Notes</td></tr>
                    <tr><td rowspan="2">SHA2</td><td>512</td><td>224,256,384,512</td><td>Y</td><td/></tr>
                    <tr><td>256</td><td>224,256</td><td>Y</td><td/></tr>
                    <tr><td>Tiger</td><td/><td>192</td><td>Y</td><td/></tr>
                    <tr><td>WHIRLPOOL</td><td/><td>512</td><td>Y</td><td/></tr>
                    <tr><td rowspan="2">Streebog</td><td>512</td><td>512</td><td>Y</td><td rowspan="2">GOST3411-2012</td></tr>
                    <tr><td>256</td><td>256</td><td>Y</td></tr>
                    <tr><td>GOST</td><td/><td>256</td><td>Y</td><td>GOST3411-94</td></tr>
                    <tr><td rowspan="2">RipeMD</td><td>128</td><td>128,160</td><td>Y</td><td/></tr>
                    <tr><td>256</td><td>256,320</td><td>Y</td><td/></tr>
                    <tr><td>SHA3</td><td/><td>224,256,384,512</td><td>Y</td><td/></tr>
                    <tr><td rowspan="3">Skein</td><td>256</td><td>128,160,224,256</td><td>Y</td><td/></tr>
                    <tr><td>512</td><td>128,160,224,256,384,512</td><td>Y</td><td/></tr>
                    <tr><td>1024</td><td>384,512,1024</td><td>Y</td><td/></tr>
                    <tr><td>SM3</td><td/><td>256</td><td>Y</td><td/></tr>
                    <tr><td>Blake2s</td><td>256</td><td>128,160,224,256</td><td>Y</td><td/></tr>
                    <tr><td>Blake2b</td><td>512</td><td>160,256,384,512</td><td>Y</td><td/></tr>
                    <tr><td>SHA1</td><td/><td>160</td><td>Y</td><td/></tr>
                    <tr><td>MD2</td><td/><td>128</td><td>Y</td><td/></tr>
                    <tr><td>MD4</td><td/><td>128</td><td>Y</td><td/></tr>
                    <tr><td>MD5</td><td/><td>128</td><td>Y</td><td/></tr>
                    <tr><td rowspan="2">SHAKE</td><td>128</td><td>128,160,224,256</td><td/><td/></tr>
                    <tr><td>256</td><td>256,384,512</td><td/><td/></tr>
                    <tr><td>Kupyna</td><td/><td>256,384,512</td><td>Y</td><td>DSTU7564</td></tr>
                    <tr><td>JH</td><td/><td>224,256,384,512</td><td/><td/></tr>
                    <tr><td>Groestl</td><td/><td>224,256,384,512</td><td/><td/></tr>
                    <tr><td>CubeHash</td><td/><td>224,256,384,512</td><td/><td/></tr>
                    <tr><td rowspan="2">Kangaroo</td><td>128</td><td>128,160,224,256</td><td/><td>Kangaroo12</td></tr>
                    <tr><td>256</td><td>256,384,512</td><td/><td>Marsupimal14</td></tr>
                    <tr><td>Haraka</td><td>256, 512</td><td>256</td><td>Y</td><td>Note that input must be same length as stateLength</td></tr>
                </table>
            </subsection>
        </section>
        <section name="Macs">
            <p>A mac is created by specifying a macSpec which comprises the macType plus additional configuration (e.g. digestSpec/symKeySpec) as appropriate.
                The mac can be used in much the same way as a JCA Mac, allowing init, reset, update and finalise methods.</p>
            <p>A keyGenerator for a macSpec can be created, which can be used to generate random keys for the mac</p>
            <subsection name="Sample">
                <source>
                    /* Access factory */
                    final GordianFactory myBaseFactory = GordianGenerator.createFactory();
                    final GordianMacFactory myMacFactory = myBaseFactory.getMacFactory();

                    /* Create mac */
                    final GordianMacSpec mySpec = GordianMacSpec.poly1305(GordianSymKeySpec.aes(GordianLength.LEN_256));
                    final GordianMac myMac = myMacFactory.createMac(mySpec);

                    /* Create key */
                    final GordianKeyGenerator&lt;GordianMacSpec&gt; myGenerator = myMacFactory.getKeyGenerator(mySpec);
                    final GordianKey&lt;GordianMacSpec&gt; myKey = myGenerator.generateKey();

                    /* Calculate mac */
                    final byte[] myMessage = ...
                    final GordianMacParameters myParams = GordianMacParameters.keyWithRandomNonce(myKey);
                    myMac.init(myParams);
                    myMac.update(myMessage);
                    final byte[] myResult = myMac.finish();
                </source>
            </subsection>
            <subsection name="Algorithms">
                <p>The following algorithms are supported, with the JCA subset indicated.</p>
                <table class="defTable">
                    <tr><td class="defHdr">Algorithm</td><td class="defHdr">OutputLengths</td><td class="defHdr">KeyLengths</td>
                        <td class="defHdr">JCA</td><td class="defHdr">Notes</td></tr>
                    <tr><td>HMac</td><td>digest length</td><td>All</td><td>Y</td><td>Jca does not support SM3, BLAKE, SHAKE, JH, Groestl, CubeHash or Kupyna</td></tr>
                    <tr><td>GMac</td><td>128</td><td>As per cipher</td><td>Y</td><td>For all supported 128 bit block ciphers except Kalyna (BUG). Jca does not support Kuznyechik</td></tr>
                    <tr><td>CMac</td><td>cipher block length</td><td>As per cipher</td><td>Y</td><td>Jca has limited  set of supported ciphers</td></tr>
                    <tr><td>Poly1305Mac</td><td>128</td><td>256</td><td>Y</td><td>For all supported 128 bit block ciphers with 128 bit keys. JCA does not support Kalyna.</td></tr>
                    <tr><td>SkeinMac</td><td>digest length</td><td>All</td><td>Y</td><td/></tr>
                    <tr><td>VMPCMac</td><td>160</td><td>All</td><td>Y</td><td/></tr>
                    <tr><td>BlakeMac</td><td>digest length</td><td>less or equal to stateLength</td><td/><td/></tr>
                    <tr><td>KupynaMac</td><td>digest length</td><td/><td/><td/></tr>
                    <tr><td>KalynaMac</td><td>cipher block length</td><td>As per cipher</td><td/><td/></tr>
                    <tr><td>CBCMac</td><td>cipher block length</td><td>As per cipher</td><td/><td/></tr>
                    <tr><td>CFBMac</td><td>cipher block length</td><td>As per cipher</td><td/><td/></tr>
                    <tr><td>GOSTMac</td><td>32</td><td>256</td><td>Y</td><td/></tr>
                    <tr><td>SipHash</td><td>64, 128</td><td>128</td><td>Y</td><td/></tr>
                    <tr><td>ZucMac</td><td>32,64,128</td><td>128,256</td><td/><td>For 128 bit keys the only output length supported is 32</td></tr>
                    <tr><td>KMAC</td><td>as per SHAKE</td><td>All</td><td/><td>Key Length must be at least as long as the underlying SHAKE state length</td></tr>
                </table>
            </subsection>
        </section>
    </body>
</document>
