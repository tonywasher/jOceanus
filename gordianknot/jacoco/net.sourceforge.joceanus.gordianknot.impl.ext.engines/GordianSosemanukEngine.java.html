<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GordianSosemanukEngine.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">GordianKnot Security Framework</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.joceanus.gordianknot.impl.ext.engines</a> &gt; <span class="el_source">GordianSosemanukEngine.java</span></div><h1>GordianSosemanukEngine.java</h1><pre class="source lang-java linenums">/*******************************************************************************
 * GordianKnot: Security Suite
 * Copyright 2012,2025 Tony Washer
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not
 * use this file except in compliance with the License.  You may obtain a copy
 * of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations under
 * the License.
 ******************************************************************************/
package net.sourceforge.joceanus.gordianknot.impl.ext.engines;

import org.bouncycastle.crypto.CipherParameters;
import org.bouncycastle.crypto.DataLengthException;
import org.bouncycastle.crypto.OutputLengthException;
import org.bouncycastle.crypto.StreamCipher;
import org.bouncycastle.crypto.params.KeyParameter;
import org.bouncycastle.crypto.params.ParametersWithIV;
import org.bouncycastle.util.Memoable;

/**
 * StreamCipher implementation based on the SosemanukFast java implementation.
 * &lt;p&gt;
 * Copied from http://www.ecrypt.eu.org/stream/e2-sosemanuk.html.
 */
@SuppressWarnings(&quot;checkstyle:MagicNumber&quot;)
public class GordianSosemanukEngine
        implements StreamCipher, Memoable {
    /**
     * Advanced stream length.
     */
    private static final int STREAM_LEN = 80;

    /**
     * index of next byte in keyStream.
     */
    private int theIndex;

    /**
     * Advanced stream.
     */
<span class="fc" id="L48">    private final byte[] keyStream = new byte[STREAM_LEN];</span>

    /**
     * Reset state.
     */
    private GordianSosemanukEngine theResetState;

    /**
     * Constructor.
     */
<span class="fc" id="L58">    public GordianSosemanukEngine() {</span>
<span class="fc" id="L59">    }</span>

    /**
     * Constructor.
     * @param pSource the source engine
     */
<span class="fc" id="L65">    private GordianSosemanukEngine(final GordianSosemanukEngine pSource) {</span>
<span class="fc" id="L66">        reset(pSource);</span>
<span class="fc" id="L67">    }</span>

    /**
     * initialise a Susemanuk cipher.
     * @param forEncryption whether or not we are for encryption.
     * @param params the parameters required to set up the cipher.
     * @exception IllegalArgumentException if the params argument is inappropriate.
     */
    public void init(final boolean forEncryption,
                     final CipherParameters params) {
        /*
         * Sosemanuk encryption and decryption is completely symmetrical, so the 'forEncryption' is
         * irrelevant. (Like 90% of stream ciphers)
         */

        /* Determine parameters */
<span class="fc" id="L83">        CipherParameters myParams = params;</span>
<span class="fc" id="L84">        byte[] newKey = null;</span>
<span class="fc" id="L85">        byte[] newIV = null;</span>
<span class="pc bpc" id="L86" title="1 of 2 branches missed.">        if ((myParams instanceof ParametersWithIV)) {</span>
<span class="fc" id="L87">            final ParametersWithIV ivParams = (ParametersWithIV) myParams;</span>
<span class="fc" id="L88">            newIV = ivParams.getIV();</span>
<span class="fc" id="L89">            myParams = ivParams.getParameters();</span>
        }
<span class="pc bpc" id="L91" title="1 of 2 branches missed.">        if (myParams instanceof KeyParameter) {</span>
<span class="fc" id="L92">            final KeyParameter keyParam = (KeyParameter) myParams;</span>
<span class="fc" id="L93">            newKey = keyParam.getKey();</span>
        }

        /* Initialise engine and mark as initialised */
<span class="fc" id="L97">        theIndex = 0;</span>
<span class="fc" id="L98">        setKey(newKey);</span>
<span class="fc" id="L99">        setIV(newIV);</span>
<span class="fc" id="L100">        makeStreamBlock(keyStream, 0);</span>

        /* Save reset state */
<span class="fc" id="L103">        theResetState = copy();</span>
<span class="fc" id="L104">    }</span>

    @Override
    public String getAlgorithmName() {
<span class="nc" id="L108">        return &quot;Sosemanuk&quot;;</span>
    }

    @Override
    public int processBytes(final byte[] in,
                            final int inOff,
                            final int len,
                            final byte[] out,
                            final int outOff) {
        /* Check for errors */
<span class="pc bpc" id="L118" title="1 of 2 branches missed.">        if (theResetState == null) {</span>
<span class="nc" id="L119">            throw new IllegalStateException(getAlgorithmName() + &quot; not initialised&quot;);</span>
        }
<span class="pc bpc" id="L121" title="1 of 2 branches missed.">        if ((inOff + len) &gt; in.length) {</span>
<span class="nc" id="L122">            throw new DataLengthException(&quot;input buffer too short&quot;);</span>
        }
<span class="pc bpc" id="L124" title="1 of 2 branches missed.">        if ((outOff + len) &gt; out.length) {</span>
<span class="nc" id="L125">            throw new OutputLengthException(&quot;output buffer too short&quot;);</span>
        }

        /* Loop through the input bytes */
<span class="fc bfc" id="L129" title="All 2 branches covered.">        for (int i = 0; i &lt; len; i++) {</span>
<span class="fc" id="L130">            out[i + outOff] = returnByte(in[i + inOff]);</span>
        }
<span class="fc" id="L132">        return len;</span>
    }

    @Override
    public void reset() {
<span class="pc bpc" id="L137" title="1 of 2 branches missed.">        if (theResetState != null) {</span>
<span class="fc" id="L138">            reset(theResetState);</span>
        }
<span class="fc" id="L140">    }</span>

    @Override
    public byte returnByte(final byte in) {
<span class="fc" id="L144">        final byte out = (byte) (keyStream[theIndex] ^ in);</span>
<span class="fc" id="L145">        theIndex = (theIndex + 1) % STREAM_LEN;</span>

<span class="fc bfc" id="L147" title="All 2 branches covered.">        if (theIndex == 0) {</span>
<span class="fc" id="L148">            makeStreamBlock(keyStream, 0);</span>
        }
<span class="fc" id="L150">        return out;</span>
    }


    @Override
    public GordianSosemanukEngine copy() {
<span class="fc" id="L156">        return new GordianSosemanukEngine(this);</span>
    }

    @Override
    public void reset(final Memoable pState) {
<span class="fc" id="L161">        final GordianSosemanukEngine e = (GordianSosemanukEngine) pState;</span>
<span class="fc" id="L162">        lfsr0 = e.lfsr0;</span>
<span class="fc" id="L163">        lfsr1 = e.lfsr1;</span>
<span class="fc" id="L164">        lfsr2 = e.lfsr2;</span>
<span class="fc" id="L165">        lfsr3 = e.lfsr3;</span>
<span class="fc" id="L166">        lfsr4 = e.lfsr4;</span>
<span class="fc" id="L167">        lfsr5 = e.lfsr5;</span>
<span class="fc" id="L168">        lfsr6 = e.lfsr6;</span>
<span class="fc" id="L169">        lfsr7 = e.lfsr7;</span>
<span class="fc" id="L170">        lfsr8 = e.lfsr8;</span>
<span class="fc" id="L171">        lfsr9 = e.lfsr9;</span>
<span class="fc" id="L172">        fsmR1 = e.fsmR1;</span>
<span class="fc" id="L173">        fsmR2 = e.fsmR2;</span>
<span class="fc" id="L174">        System.arraycopy(e.keyStream, 0, keyStream, 0, STREAM_LEN);</span>
<span class="fc" id="L175">        theIndex = e.theIndex;</span>
<span class="fc" id="L176">    }</span>

    /**
     * LFSR0 State.
     */
    private int lfsr0;

    /**
     * LFSR1 State.
     */
    private int lfsr1;

    /**
     * LFSR2 State.
     */
    private int lfsr2;

    /**
     * LFSR3 State.
     */
    private int lfsr3;

    /**
     * LFSR4 State.
     */
    private int lfsr4;

    /**
     * LFSR5 State.
     */
    private int lfsr5;

    /**
     * LFSR6 State.
     */
    private int lfsr6;

    /**
     * LFSR7 State.
     */
    private int lfsr7;

    /**
     * LFSR8 State.
     */
    private int lfsr8;

    /**
     * LFSR9 State.
     */
    private int lfsr9;

    /**
     * FSMR1 State.
     */
    private int fsmR1;

    /**
     * FSMR2 State.
     */
    private int fsmR2;

    /*
     * The code internals for the SERPENT-derived functions have been
     * semi-automatically generated, using a mixture of C, C
     * preprocessor, vi macros and Forth. The base circuits for
     * the SERPENT S-boxes have been published by Dag Arne Osvik
     * (&quot;Speeding up Serpent&quot;, at the 3rd AES Candidate Conference).
     */

    /**
     * Decode a 32-bit value from a buffer (little-endian).
     *
     * @param buf   the input buffer
     * @param off   the input offset
     * @return  the decoded value
     */
    private static int decode32le(final byte[] buf, final int off) {
<span class="fc" id="L254">        return (buf[off] &amp; 0xFF)</span>
                | ((buf[off + 1] &amp; 0xFF) &lt;&lt; 8)
                | ((buf[off + 2] &amp; 0xFF) &lt;&lt; 16)
                | ((buf[off + 3] &amp; 0xFF) &lt;&lt; 24);
    }

    /**
     * Encode a 32-bit value into a buffer (little-endian).
     *
     * @param val   the value to encode
     * @param buf   the output buffer
     * @param off   the output offset
     */
    private static void encode32le(final int val, final byte[] buf, final int off) {
<span class="fc" id="L268">        buf[off] = (byte) val;</span>
<span class="fc" id="L269">        buf[off + 1] = (byte) (val &gt;&gt; 8);</span>
<span class="fc" id="L270">        buf[off + 2] = (byte) (val &gt;&gt; 16);</span>
<span class="fc" id="L271">        buf[off + 3] = (byte) (val &gt;&gt; 24);</span>
<span class="fc" id="L272">    }</span>

    /**
     * Left-rotate a 32-bit value by some bit.
     *
     * @param val   the value to rotate
     * @param n     the rotation count (between 1 and 31)
     * @return rotated value
     */
    private static int rotateLeft(final int val, final int n) {
<span class="fc" id="L282">        return (val &lt;&lt; n) | (val &gt;&gt;&gt; (32 - n));</span>
    }

    /** Subkeys for Serpent24: 100 32-bit words. */
<span class="fc" id="L286">    private final int[] serpent24SubKeys = new int[100];</span>

    /**
     * Set the private key. The key length must be between 1
     * and 32 bytes.
     *
     * @param key   the private key
     */
    @SuppressWarnings(&quot;checkstyle:MethodLength&quot;)
    public void setKey(final byte[] key) {
<span class="pc bpc" id="L296" title="2 of 4 branches missed.">        if (key.length &lt; 1 || key.length &gt; 32) {</span>
<span class="nc" id="L297">            throw new IllegalArgumentException(&quot;bad key length: &quot; + key.length);</span>
        }
        final byte[] lkey;
<span class="fc bfc" id="L300" title="All 2 branches covered.">        if (key.length == 32) {</span>
<span class="fc" id="L301">            lkey = key;</span>
        } else {
<span class="fc" id="L303">            lkey = new byte[32];</span>
<span class="fc" id="L304">            System.arraycopy(key, 0, lkey, 0, key.length);</span>
<span class="fc" id="L305">            lkey[key.length] = 0x01;</span>
<span class="fc bfc" id="L306" title="All 2 branches covered.">            for (int i = key.length + 1; i &lt; lkey.length; i++) {</span>
<span class="fc" id="L307">                lkey[i] = 0x00;</span>
            }
        }

<span class="fc" id="L311">        int i = 0;</span>

<span class="fc" id="L313">        int w0 = decode32le(lkey, 0);</span>
<span class="fc" id="L314">        int w1 = decode32le(lkey, 4);</span>
<span class="fc" id="L315">        int w2 = decode32le(lkey, 8);</span>
<span class="fc" id="L316">        int w3 = decode32le(lkey, 12);</span>
<span class="fc" id="L317">        int w4 = decode32le(lkey, 16);</span>
<span class="fc" id="L318">        int w5 = decode32le(lkey, 20);</span>
<span class="fc" id="L319">        int w6 = decode32le(lkey, 24);</span>
<span class="fc" id="L320">        int w7 = decode32le(lkey, 28);</span>
<span class="fc" id="L321">        int tt = w0 ^ w3 ^ w5 ^ w7 ^ (0x9E3779B9 ^ (0));</span>
<span class="fc" id="L322">        w0 = rotateLeft(tt, 11);</span>
<span class="fc" id="L323">        tt = w1 ^ w4 ^ w6 ^ w0 ^ (0x9E3779B9 ^ (0 + 1));</span>
<span class="fc" id="L324">        w1 = rotateLeft(tt, 11);</span>
<span class="fc" id="L325">        tt = w2 ^ w5 ^ w7 ^ w1 ^ (0x9E3779B9 ^ (0 + 2));</span>
<span class="fc" id="L326">        w2 = rotateLeft(tt, 11);</span>
<span class="fc" id="L327">        tt = w3 ^ w6 ^ w0 ^ w2 ^ (0x9E3779B9 ^ (0 + 3));</span>
<span class="fc" id="L328">        w3 = rotateLeft(tt, 11);</span>
<span class="fc" id="L329">        int r0 = w0;</span>
<span class="fc" id="L330">        int r1 = w1;</span>
<span class="fc" id="L331">        int r2 = w2;</span>
<span class="fc" id="L332">        int r3 = w3;</span>
<span class="fc" id="L333">        int r4 = r0;</span>
<span class="fc" id="L334">        r0 |= r3;</span>
<span class="fc" id="L335">        r3 ^= r1;</span>
<span class="fc" id="L336">        r1 &amp;= r4;</span>
<span class="fc" id="L337">        r4 ^= r2;</span>
<span class="fc" id="L338">        r2 ^= r3;</span>
<span class="fc" id="L339">        r3 &amp;= r0;</span>
<span class="fc" id="L340">        r4 |= r1;</span>
<span class="fc" id="L341">        r3 ^= r4;</span>
<span class="fc" id="L342">        r0 ^= r1;</span>
<span class="fc" id="L343">        r4 &amp;= r0;</span>
<span class="fc" id="L344">        r1 ^= r3;</span>
<span class="fc" id="L345">        r4 ^= r2;</span>
<span class="fc" id="L346">        r1 |= r0;</span>
<span class="fc" id="L347">        r1 ^= r2;</span>
<span class="fc" id="L348">        r0 ^= r3;</span>
<span class="fc" id="L349">        r2 = r1;</span>
<span class="fc" id="L350">        r1 |= r3;</span>
<span class="fc" id="L351">        r1 ^= r0;</span>
<span class="fc" id="L352">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L353">        serpent24SubKeys[i++] = r2;</span>
<span class="fc" id="L354">        serpent24SubKeys[i++] = r3;</span>
<span class="fc" id="L355">        serpent24SubKeys[i++] = r4;</span>
<span class="fc" id="L356">        tt = w4 ^ w7 ^ w1 ^ w3 ^ (0x9E3779B9 ^ (4));</span>
<span class="fc" id="L357">        w4 = rotateLeft(tt, 11);</span>
<span class="fc" id="L358">        tt = w5 ^ w0 ^ w2 ^ w4 ^ (0x9E3779B9 ^ (4 + 1));</span>
<span class="fc" id="L359">        w5 = rotateLeft(tt, 11);</span>
<span class="fc" id="L360">        tt = w6 ^ w1 ^ w3 ^ w5 ^ (0x9E3779B9 ^ (4 + 2));</span>
<span class="fc" id="L361">        w6 = rotateLeft(tt, 11);</span>
<span class="fc" id="L362">        tt = w7 ^ w2 ^ w4 ^ w6 ^ (0x9E3779B9 ^ (4 + 3));</span>
<span class="fc" id="L363">        w7 = rotateLeft(tt, 11);</span>
<span class="fc" id="L364">        r0 = w4;</span>
<span class="fc" id="L365">        r1 = w5;</span>
<span class="fc" id="L366">        r2 = w6;</span>
<span class="fc" id="L367">        r3 = w7;</span>
<span class="fc" id="L368">        r4 = r0;</span>
<span class="fc" id="L369">        r0 &amp;= r2;</span>
<span class="fc" id="L370">        r0 ^= r3;</span>
<span class="fc" id="L371">        r2 ^= r1;</span>
<span class="fc" id="L372">        r2 ^= r0;</span>
<span class="fc" id="L373">        r3 |= r4;</span>
<span class="fc" id="L374">        r3 ^= r1;</span>
<span class="fc" id="L375">        r4 ^= r2;</span>
<span class="fc" id="L376">        r1 = r3;</span>
<span class="fc" id="L377">        r3 |= r4;</span>
<span class="fc" id="L378">        r3 ^= r0;</span>
<span class="fc" id="L379">        r0 &amp;= r1;</span>
<span class="fc" id="L380">        r4 ^= r0;</span>
<span class="fc" id="L381">        r1 ^= r3;</span>
<span class="fc" id="L382">        r1 ^= r4;</span>
<span class="fc" id="L383">        r4 = ~r4;</span>
<span class="fc" id="L384">        serpent24SubKeys[i++] = r2;</span>
<span class="fc" id="L385">        serpent24SubKeys[i++] = r3;</span>
<span class="fc" id="L386">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L387">        serpent24SubKeys[i++] = r4;</span>
<span class="fc" id="L388">        tt = w0 ^ w3 ^ w5 ^ w7 ^ (0x9E3779B9 ^ (8));</span>
<span class="fc" id="L389">        w0 = rotateLeft(tt, 11);</span>
<span class="fc" id="L390">        tt = w1 ^ w4 ^ w6 ^ w0 ^ (0x9E3779B9 ^ (8 + 1));</span>
<span class="fc" id="L391">        w1 = rotateLeft(tt, 11);</span>
<span class="fc" id="L392">        tt = w2 ^ w5 ^ w7 ^ w1 ^ (0x9E3779B9 ^ (8 + 2));</span>
<span class="fc" id="L393">        w2 = rotateLeft(tt, 11);</span>
<span class="fc" id="L394">        tt = w3 ^ w6 ^ w0 ^ w2 ^ (0x9E3779B9 ^ (8 + 3));</span>
<span class="fc" id="L395">        w3 = rotateLeft(tt, 11);</span>
<span class="fc" id="L396">        r0 = w0;</span>
<span class="fc" id="L397">        r1 = w1;</span>
<span class="fc" id="L398">        r2 = w2;</span>
<span class="fc" id="L399">        r3 = w3;</span>
<span class="fc" id="L400">        r0 = ~r0;</span>
<span class="fc" id="L401">        r2 = ~r2;</span>
<span class="fc" id="L402">        r4 = r0;</span>
<span class="fc" id="L403">        r0 &amp;= r1;</span>
<span class="fc" id="L404">        r2 ^= r0;</span>
<span class="fc" id="L405">        r0 |= r3;</span>
<span class="fc" id="L406">        r3 ^= r2;</span>
<span class="fc" id="L407">        r1 ^= r0;</span>
<span class="fc" id="L408">        r0 ^= r4;</span>
<span class="fc" id="L409">        r4 |= r1;</span>
<span class="fc" id="L410">        r1 ^= r3;</span>
<span class="fc" id="L411">        r2 |= r0;</span>
<span class="fc" id="L412">        r2 &amp;= r4;</span>
<span class="fc" id="L413">        r0 ^= r1;</span>
<span class="fc" id="L414">        r1 &amp;= r2;</span>
<span class="fc" id="L415">        r1 ^= r0;</span>
<span class="fc" id="L416">        r0 &amp;= r2;</span>
<span class="fc" id="L417">        r0 ^= r4;</span>
<span class="fc" id="L418">        serpent24SubKeys[i++] = r2;</span>
<span class="fc" id="L419">        serpent24SubKeys[i++] = r0;</span>
<span class="fc" id="L420">        serpent24SubKeys[i++] = r3;</span>
<span class="fc" id="L421">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L422">        tt = w4 ^ w7 ^ w1 ^ w3 ^ (0x9E3779B9 ^ (12));</span>
<span class="fc" id="L423">        w4 = rotateLeft(tt, 11);</span>
<span class="fc" id="L424">        tt = w5 ^ w0 ^ w2 ^ w4 ^ (0x9E3779B9 ^ (12 + 1));</span>
<span class="fc" id="L425">        w5 = rotateLeft(tt, 11);</span>
<span class="fc" id="L426">        tt = w6 ^ w1 ^ w3 ^ w5 ^ (0x9E3779B9 ^ (12 + 2));</span>
<span class="fc" id="L427">        w6 = rotateLeft(tt, 11);</span>
<span class="fc" id="L428">        tt = w7 ^ w2 ^ w4 ^ w6 ^ (0x9E3779B9 ^ (12 + 3));</span>
<span class="fc" id="L429">        w7 = rotateLeft(tt, 11);</span>
<span class="fc" id="L430">        r0 = w4;</span>
<span class="fc" id="L431">        r1 = w5;</span>
<span class="fc" id="L432">        r2 = w6;</span>
<span class="fc" id="L433">        r3 = w7;</span>
<span class="fc" id="L434">        r3 ^= r0;</span>
<span class="fc" id="L435">        r4 = r1;</span>
<span class="fc" id="L436">        r1 &amp;= r3;</span>
<span class="fc" id="L437">        r4 ^= r2;</span>
<span class="fc" id="L438">        r1 ^= r0;</span>
<span class="fc" id="L439">        r0 |= r3;</span>
<span class="fc" id="L440">        r0 ^= r4;</span>
<span class="fc" id="L441">        r4 ^= r3;</span>
<span class="fc" id="L442">        r3 ^= r2;</span>
<span class="fc" id="L443">        r2 |= r1;</span>
<span class="fc" id="L444">        r2 ^= r4;</span>
<span class="fc" id="L445">        r4 = ~r4;</span>
<span class="fc" id="L446">        r4 |= r1;</span>
<span class="fc" id="L447">        r1 ^= r3;</span>
<span class="fc" id="L448">        r1 ^= r4;</span>
<span class="fc" id="L449">        r3 |= r0;</span>
<span class="fc" id="L450">        r1 ^= r3;</span>
<span class="fc" id="L451">        r4 ^= r3;</span>
<span class="fc" id="L452">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L453">        serpent24SubKeys[i++] = r4;</span>
<span class="fc" id="L454">        serpent24SubKeys[i++] = r2;</span>
<span class="fc" id="L455">        serpent24SubKeys[i++] = r0;</span>
<span class="fc" id="L456">        tt = w0 ^ w3 ^ w5 ^ w7 ^ (0x9E3779B9 ^ (16));</span>
<span class="fc" id="L457">        w0 = rotateLeft(tt, 11);</span>
<span class="fc" id="L458">        tt = w1 ^ w4 ^ w6 ^ w0 ^ (0x9E3779B9 ^ (16 + 1));</span>
<span class="fc" id="L459">        w1 = rotateLeft(tt, 11);</span>
<span class="fc" id="L460">        tt = w2 ^ w5 ^ w7 ^ w1 ^ (0x9E3779B9 ^ (16 + 2));</span>
<span class="fc" id="L461">        w2 = rotateLeft(tt, 11);</span>
<span class="fc" id="L462">        tt = w3 ^ w6 ^ w0 ^ w2 ^ (0x9E3779B9 ^ (16 + 3));</span>
<span class="fc" id="L463">        w3 = rotateLeft(tt, 11);</span>
<span class="fc" id="L464">        r0 = w0;</span>
<span class="fc" id="L465">        r1 = w1;</span>
<span class="fc" id="L466">        r2 = w2;</span>
<span class="fc" id="L467">        r3 = w3;</span>
<span class="fc" id="L468">        r4 = r1;</span>
<span class="fc" id="L469">        r1 |= r2;</span>
<span class="fc" id="L470">        r1 ^= r3;</span>
<span class="fc" id="L471">        r4 ^= r2;</span>
<span class="fc" id="L472">        r2 ^= r1;</span>
<span class="fc" id="L473">        r3 |= r4;</span>
<span class="fc" id="L474">        r3 &amp;= r0;</span>
<span class="fc" id="L475">        r4 ^= r2;</span>
<span class="fc" id="L476">        r3 ^= r1;</span>
<span class="fc" id="L477">        r1 |= r4;</span>
<span class="fc" id="L478">        r1 ^= r0;</span>
<span class="fc" id="L479">        r0 |= r4;</span>
<span class="fc" id="L480">        r0 ^= r2;</span>
<span class="fc" id="L481">        r1 ^= r4;</span>
<span class="fc" id="L482">        r2 ^= r1;</span>
<span class="fc" id="L483">        r1 &amp;= r0;</span>
<span class="fc" id="L484">        r1 ^= r4;</span>
<span class="fc" id="L485">        r2 = ~r2;</span>
<span class="fc" id="L486">        r2 |= r0;</span>
<span class="fc" id="L487">        r4 ^= r2;</span>
<span class="fc" id="L488">        serpent24SubKeys[i++] = r4;</span>
<span class="fc" id="L489">        serpent24SubKeys[i++] = r3;</span>
<span class="fc" id="L490">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L491">        serpent24SubKeys[i++] = r0;</span>
<span class="fc" id="L492">        tt = w4 ^ w7 ^ w1 ^ w3 ^ (0x9E3779B9 ^ (20));</span>
<span class="fc" id="L493">        w4 = rotateLeft(tt, 11);</span>
<span class="fc" id="L494">        tt = w5 ^ w0 ^ w2 ^ w4 ^ (0x9E3779B9 ^ (20 + 1));</span>
<span class="fc" id="L495">        w5 = rotateLeft(tt, 11);</span>
<span class="fc" id="L496">        tt = w6 ^ w1 ^ w3 ^ w5 ^ (0x9E3779B9 ^ (20 + 2));</span>
<span class="fc" id="L497">        w6 = rotateLeft(tt, 11);</span>
<span class="fc" id="L498">        tt = w7 ^ w2 ^ w4 ^ w6 ^ (0x9E3779B9 ^ (20 + 3));</span>
<span class="fc" id="L499">        w7 = rotateLeft(tt, 11);</span>
<span class="fc" id="L500">        r0 = w4;</span>
<span class="fc" id="L501">        r1 = w5;</span>
<span class="fc" id="L502">        r2 = w6;</span>
<span class="fc" id="L503">        r3 = w7;</span>
<span class="fc" id="L504">        r2 = ~r2;</span>
<span class="fc" id="L505">        r4 = r3;</span>
<span class="fc" id="L506">        r3 &amp;= r0;</span>
<span class="fc" id="L507">        r0 ^= r4;</span>
<span class="fc" id="L508">        r3 ^= r2;</span>
<span class="fc" id="L509">        r2 |= r4;</span>
<span class="fc" id="L510">        r1 ^= r3;</span>
<span class="fc" id="L511">        r2 ^= r0;</span>
<span class="fc" id="L512">        r0 |= r1;</span>
<span class="fc" id="L513">        r2 ^= r1;</span>
<span class="fc" id="L514">        r4 ^= r0;</span>
<span class="fc" id="L515">        r0 |= r3;</span>
<span class="fc" id="L516">        r0 ^= r2;</span>
<span class="fc" id="L517">        r4 ^= r3;</span>
<span class="fc" id="L518">        r4 ^= r0;</span>
<span class="fc" id="L519">        r3 = ~r3;</span>
<span class="fc" id="L520">        r2 &amp;= r4;</span>
<span class="fc" id="L521">        r2 ^= r3;</span>
<span class="fc" id="L522">        serpent24SubKeys[i++] = r0;</span>
<span class="fc" id="L523">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L524">        serpent24SubKeys[i++] = r4;</span>
<span class="fc" id="L525">        serpent24SubKeys[i++] = r2;</span>
<span class="fc" id="L526">        tt = w0 ^ w3 ^ w5 ^ w7 ^ (0x9E3779B9 ^ (24));</span>
<span class="fc" id="L527">        w0 = rotateLeft(tt, 11);</span>
<span class="fc" id="L528">        tt = w1 ^ w4 ^ w6 ^ w0 ^ (0x9E3779B9 ^ (24 + 1));</span>
<span class="fc" id="L529">        w1 = rotateLeft(tt, 11);</span>
<span class="fc" id="L530">        tt = w2 ^ w5 ^ w7 ^ w1 ^ (0x9E3779B9 ^ (24 + 2));</span>
<span class="fc" id="L531">        w2 = rotateLeft(tt, 11);</span>
<span class="fc" id="L532">        tt = w3 ^ w6 ^ w0 ^ w2 ^ (0x9E3779B9 ^ (24 + 3));</span>
<span class="fc" id="L533">        w3 = rotateLeft(tt, 11);</span>
<span class="fc" id="L534">        r0 = w0;</span>
<span class="fc" id="L535">        r1 = w1;</span>
<span class="fc" id="L536">        r2 = w2;</span>
<span class="fc" id="L537">        r3 = w3;</span>
<span class="fc" id="L538">        r0 ^= r1;</span>
<span class="fc" id="L539">        r1 ^= r3;</span>
<span class="fc" id="L540">        r3 = ~r3;</span>
<span class="fc" id="L541">        r4 = r1;</span>
<span class="fc" id="L542">        r1 &amp;= r0;</span>
<span class="fc" id="L543">        r2 ^= r3;</span>
<span class="fc" id="L544">        r1 ^= r2;</span>
<span class="fc" id="L545">        r2 |= r4;</span>
<span class="fc" id="L546">        r4 ^= r3;</span>
<span class="fc" id="L547">        r3 &amp;= r1;</span>
<span class="fc" id="L548">        r3 ^= r0;</span>
<span class="fc" id="L549">        r4 ^= r1;</span>
<span class="fc" id="L550">        r4 ^= r2;</span>
<span class="fc" id="L551">        r2 ^= r0;</span>
<span class="fc" id="L552">        r0 &amp;= r3;</span>
<span class="fc" id="L553">        r2 = ~r2;</span>
<span class="fc" id="L554">        r0 ^= r4;</span>
<span class="fc" id="L555">        r4 |= r3;</span>
<span class="fc" id="L556">        r2 ^= r4;</span>
<span class="fc" id="L557">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L558">        serpent24SubKeys[i++] = r3;</span>
<span class="fc" id="L559">        serpent24SubKeys[i++] = r0;</span>
<span class="fc" id="L560">        serpent24SubKeys[i++] = r2;</span>
<span class="fc" id="L561">        tt = w4 ^ w7 ^ w1 ^ w3 ^ (0x9E3779B9 ^ (28));</span>
<span class="fc" id="L562">        w4 = rotateLeft(tt, 11);</span>
<span class="fc" id="L563">        tt = w5 ^ w0 ^ w2 ^ w4 ^ (0x9E3779B9 ^ (28 + 1));</span>
<span class="fc" id="L564">        w5 = rotateLeft(tt, 11);</span>
<span class="fc" id="L565">        tt = w6 ^ w1 ^ w3 ^ w5 ^ (0x9E3779B9 ^ (28 + 2));</span>
<span class="fc" id="L566">        w6 = rotateLeft(tt, 11);</span>
<span class="fc" id="L567">        tt = w7 ^ w2 ^ w4 ^ w6 ^ (0x9E3779B9 ^ (28 + 3));</span>
<span class="fc" id="L568">        w7 = rotateLeft(tt, 11);</span>
<span class="fc" id="L569">        r0 = w4;</span>
<span class="fc" id="L570">        r1 = w5;</span>
<span class="fc" id="L571">        r2 = w6;</span>
<span class="fc" id="L572">        r3 = w7;</span>
<span class="fc" id="L573">        r1 ^= r3;</span>
<span class="fc" id="L574">        r3 = ~r3;</span>
<span class="fc" id="L575">        r2 ^= r3;</span>
<span class="fc" id="L576">        r3 ^= r0;</span>
<span class="fc" id="L577">        r4 = r1;</span>
<span class="fc" id="L578">        r1 &amp;= r3;</span>
<span class="fc" id="L579">        r1 ^= r2;</span>
<span class="fc" id="L580">        r4 ^= r3;</span>
<span class="fc" id="L581">        r0 ^= r4;</span>
<span class="fc" id="L582">        r2 &amp;= r4;</span>
<span class="fc" id="L583">        r2 ^= r0;</span>
<span class="fc" id="L584">        r0 &amp;= r1;</span>
<span class="fc" id="L585">        r3 ^= r0;</span>
<span class="fc" id="L586">        r4 |= r1;</span>
<span class="fc" id="L587">        r4 ^= r0;</span>
<span class="fc" id="L588">        r0 |= r3;</span>
<span class="fc" id="L589">        r0 ^= r2;</span>
<span class="fc" id="L590">        r2 &amp;= r3;</span>
<span class="fc" id="L591">        r0 = ~r0;</span>
<span class="fc" id="L592">        r4 ^= r2;</span>
<span class="fc" id="L593">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L594">        serpent24SubKeys[i++] = r4;</span>
<span class="fc" id="L595">        serpent24SubKeys[i++] = r0;</span>
<span class="fc" id="L596">        serpent24SubKeys[i++] = r3;</span>
<span class="fc" id="L597">        tt = w0 ^ w3 ^ w5 ^ w7 ^ (0x9E3779B9 ^ (32));</span>
<span class="fc" id="L598">        w0 = rotateLeft(tt, 11);</span>
<span class="fc" id="L599">        tt = w1 ^ w4 ^ w6 ^ w0 ^ (0x9E3779B9 ^ (32 + 1));</span>
<span class="fc" id="L600">        w1 = rotateLeft(tt, 11);</span>
<span class="fc" id="L601">        tt = w2 ^ w5 ^ w7 ^ w1 ^ (0x9E3779B9 ^ (32 + 2));</span>
<span class="fc" id="L602">        w2 = rotateLeft(tt, 11);</span>
<span class="fc" id="L603">        tt = w3 ^ w6 ^ w0 ^ w2 ^ (0x9E3779B9 ^ (32 + 3));</span>
<span class="fc" id="L604">        w3 = rotateLeft(tt, 11);</span>
<span class="fc" id="L605">        r0 = w0;</span>
<span class="fc" id="L606">        r1 = w1;</span>
<span class="fc" id="L607">        r2 = w2;</span>
<span class="fc" id="L608">        r3 = w3;</span>
<span class="fc" id="L609">        r4 = r0;</span>
<span class="fc" id="L610">        r0 |= r3;</span>
<span class="fc" id="L611">        r3 ^= r1;</span>
<span class="fc" id="L612">        r1 &amp;= r4;</span>
<span class="fc" id="L613">        r4 ^= r2;</span>
<span class="fc" id="L614">        r2 ^= r3;</span>
<span class="fc" id="L615">        r3 &amp;= r0;</span>
<span class="fc" id="L616">        r4 |= r1;</span>
<span class="fc" id="L617">        r3 ^= r4;</span>
<span class="fc" id="L618">        r0 ^= r1;</span>
<span class="fc" id="L619">        r4 &amp;= r0;</span>
<span class="fc" id="L620">        r1 ^= r3;</span>
<span class="fc" id="L621">        r4 ^= r2;</span>
<span class="fc" id="L622">        r1 |= r0;</span>
<span class="fc" id="L623">        r1 ^= r2;</span>
<span class="fc" id="L624">        r0 ^= r3;</span>
<span class="fc" id="L625">        r2 = r1;</span>
<span class="fc" id="L626">        r1 |= r3;</span>
<span class="fc" id="L627">        r1 ^= r0;</span>
<span class="fc" id="L628">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L629">        serpent24SubKeys[i++] = r2;</span>
<span class="fc" id="L630">        serpent24SubKeys[i++] = r3;</span>
<span class="fc" id="L631">        serpent24SubKeys[i++] = r4;</span>
<span class="fc" id="L632">        tt = w4 ^ w7 ^ w1 ^ w3 ^ (0x9E3779B9 ^ (36));</span>
<span class="fc" id="L633">        w4 = rotateLeft(tt, 11);</span>
<span class="fc" id="L634">        tt = w5 ^ w0 ^ w2 ^ w4 ^ (0x9E3779B9 ^ (36 + 1));</span>
<span class="fc" id="L635">        w5 = rotateLeft(tt, 11);</span>
<span class="fc" id="L636">        tt = w6 ^ w1 ^ w3 ^ w5 ^ (0x9E3779B9 ^ (36 + 2));</span>
<span class="fc" id="L637">        w6 = rotateLeft(tt, 11);</span>
<span class="fc" id="L638">        tt = w7 ^ w2 ^ w4 ^ w6 ^ (0x9E3779B9 ^ (36 + 3));</span>
<span class="fc" id="L639">        w7 = rotateLeft(tt, 11);</span>
<span class="fc" id="L640">        r0 = w4;</span>
<span class="fc" id="L641">        r1 = w5;</span>
<span class="fc" id="L642">        r2 = w6;</span>
<span class="fc" id="L643">        r3 = w7;</span>
<span class="fc" id="L644">        r4 = r0;</span>
<span class="fc" id="L645">        r0 &amp;= r2;</span>
<span class="fc" id="L646">        r0 ^= r3;</span>
<span class="fc" id="L647">        r2 ^= r1;</span>
<span class="fc" id="L648">        r2 ^= r0;</span>
<span class="fc" id="L649">        r3 |= r4;</span>
<span class="fc" id="L650">        r3 ^= r1;</span>
<span class="fc" id="L651">        r4 ^= r2;</span>
<span class="fc" id="L652">        r1 = r3;</span>
<span class="fc" id="L653">        r3 |= r4;</span>
<span class="fc" id="L654">        r3 ^= r0;</span>
<span class="fc" id="L655">        r0 &amp;= r1;</span>
<span class="fc" id="L656">        r4 ^= r0;</span>
<span class="fc" id="L657">        r1 ^= r3;</span>
<span class="fc" id="L658">        r1 ^= r4;</span>
<span class="fc" id="L659">        r4 = ~r4;</span>
<span class="fc" id="L660">        serpent24SubKeys[i++] = r2;</span>
<span class="fc" id="L661">        serpent24SubKeys[i++] = r3;</span>
<span class="fc" id="L662">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L663">        serpent24SubKeys[i++] = r4;</span>
<span class="fc" id="L664">        tt = w0 ^ w3 ^ w5 ^ w7 ^ (0x9E3779B9 ^ (40));</span>
<span class="fc" id="L665">        w0 = rotateLeft(tt, 11);</span>
<span class="fc" id="L666">        tt = w1 ^ w4 ^ w6 ^ w0 ^ (0x9E3779B9 ^ (40 + 1));</span>
<span class="fc" id="L667">        w1 = rotateLeft(tt, 11);</span>
<span class="fc" id="L668">        tt = w2 ^ w5 ^ w7 ^ w1 ^ (0x9E3779B9 ^ (40 + 2));</span>
<span class="fc" id="L669">        w2 = rotateLeft(tt, 11);</span>
<span class="fc" id="L670">        tt = w3 ^ w6 ^ w0 ^ w2 ^ (0x9E3779B9 ^ (40 + 3));</span>
<span class="fc" id="L671">        w3 = rotateLeft(tt, 11);</span>
<span class="fc" id="L672">        r0 = w0;</span>
<span class="fc" id="L673">        r1 = w1;</span>
<span class="fc" id="L674">        r2 = w2;</span>
<span class="fc" id="L675">        r3 = w3;</span>
<span class="fc" id="L676">        r0 = ~r0;</span>
<span class="fc" id="L677">        r2 = ~r2;</span>
<span class="fc" id="L678">        r4 = r0;</span>
<span class="fc" id="L679">        r0 &amp;= r1;</span>
<span class="fc" id="L680">        r2 ^= r0;</span>
<span class="fc" id="L681">        r0 |= r3;</span>
<span class="fc" id="L682">        r3 ^= r2;</span>
<span class="fc" id="L683">        r1 ^= r0;</span>
<span class="fc" id="L684">        r0 ^= r4;</span>
<span class="fc" id="L685">        r4 |= r1;</span>
<span class="fc" id="L686">        r1 ^= r3;</span>
<span class="fc" id="L687">        r2 |= r0;</span>
<span class="fc" id="L688">        r2 &amp;= r4;</span>
<span class="fc" id="L689">        r0 ^= r1;</span>
<span class="fc" id="L690">        r1 &amp;= r2;</span>
<span class="fc" id="L691">        r1 ^= r0;</span>
<span class="fc" id="L692">        r0 &amp;= r2;</span>
<span class="fc" id="L693">        r0 ^= r4;</span>
<span class="fc" id="L694">        serpent24SubKeys[i++] = r2;</span>
<span class="fc" id="L695">        serpent24SubKeys[i++] = r0;</span>
<span class="fc" id="L696">        serpent24SubKeys[i++] = r3;</span>
<span class="fc" id="L697">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L698">        tt = w4 ^ w7 ^ w1 ^ w3 ^ (0x9E3779B9 ^ (44));</span>
<span class="fc" id="L699">        w4 = rotateLeft(tt, 11);</span>
<span class="fc" id="L700">        tt = w5 ^ w0 ^ w2 ^ w4 ^ (0x9E3779B9 ^ (44 + 1));</span>
<span class="fc" id="L701">        w5 = rotateLeft(tt, 11);</span>
<span class="fc" id="L702">        tt = w6 ^ w1 ^ w3 ^ w5 ^ (0x9E3779B9 ^ (44 + 2));</span>
<span class="fc" id="L703">        w6 = rotateLeft(tt, 11);</span>
<span class="fc" id="L704">        tt = w7 ^ w2 ^ w4 ^ w6 ^ (0x9E3779B9 ^ (44 + 3));</span>
<span class="fc" id="L705">        w7 = rotateLeft(tt, 11);</span>
<span class="fc" id="L706">        r0 = w4;</span>
<span class="fc" id="L707">        r1 = w5;</span>
<span class="fc" id="L708">        r2 = w6;</span>
<span class="fc" id="L709">        r3 = w7;</span>
<span class="fc" id="L710">        r3 ^= r0;</span>
<span class="fc" id="L711">        r4 = r1;</span>
<span class="fc" id="L712">        r1 &amp;= r3;</span>
<span class="fc" id="L713">        r4 ^= r2;</span>
<span class="fc" id="L714">        r1 ^= r0;</span>
<span class="fc" id="L715">        r0 |= r3;</span>
<span class="fc" id="L716">        r0 ^= r4;</span>
<span class="fc" id="L717">        r4 ^= r3;</span>
<span class="fc" id="L718">        r3 ^= r2;</span>
<span class="fc" id="L719">        r2 |= r1;</span>
<span class="fc" id="L720">        r2 ^= r4;</span>
<span class="fc" id="L721">        r4 = ~r4;</span>
<span class="fc" id="L722">        r4 |= r1;</span>
<span class="fc" id="L723">        r1 ^= r3;</span>
<span class="fc" id="L724">        r1 ^= r4;</span>
<span class="fc" id="L725">        r3 |= r0;</span>
<span class="fc" id="L726">        r1 ^= r3;</span>
<span class="fc" id="L727">        r4 ^= r3;</span>
<span class="fc" id="L728">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L729">        serpent24SubKeys[i++] = r4;</span>
<span class="fc" id="L730">        serpent24SubKeys[i++] = r2;</span>
<span class="fc" id="L731">        serpent24SubKeys[i++] = r0;</span>
<span class="fc" id="L732">        tt = w0 ^ w3 ^ w5 ^ w7 ^ (0x9E3779B9 ^ (48));</span>
<span class="fc" id="L733">        w0 = rotateLeft(tt, 11);</span>
<span class="fc" id="L734">        tt = w1 ^ w4 ^ w6 ^ w0 ^ (0x9E3779B9 ^ (48 + 1));</span>
<span class="fc" id="L735">        w1 = rotateLeft(tt, 11);</span>
<span class="fc" id="L736">        tt = w2 ^ w5 ^ w7 ^ w1 ^ (0x9E3779B9 ^ (48 + 2));</span>
<span class="fc" id="L737">        w2 = rotateLeft(tt, 11);</span>
<span class="fc" id="L738">        tt = w3 ^ w6 ^ w0 ^ w2 ^ (0x9E3779B9 ^ (48 + 3));</span>
<span class="fc" id="L739">        w3 = rotateLeft(tt, 11);</span>
<span class="fc" id="L740">        r0 = w0;</span>
<span class="fc" id="L741">        r1 = w1;</span>
<span class="fc" id="L742">        r2 = w2;</span>
<span class="fc" id="L743">        r3 = w3;</span>
<span class="fc" id="L744">        r4 = r1;</span>
<span class="fc" id="L745">        r1 |= r2;</span>
<span class="fc" id="L746">        r1 ^= r3;</span>
<span class="fc" id="L747">        r4 ^= r2;</span>
<span class="fc" id="L748">        r2 ^= r1;</span>
<span class="fc" id="L749">        r3 |= r4;</span>
<span class="fc" id="L750">        r3 &amp;= r0;</span>
<span class="fc" id="L751">        r4 ^= r2;</span>
<span class="fc" id="L752">        r3 ^= r1;</span>
<span class="fc" id="L753">        r1 |= r4;</span>
<span class="fc" id="L754">        r1 ^= r0;</span>
<span class="fc" id="L755">        r0 |= r4;</span>
<span class="fc" id="L756">        r0 ^= r2;</span>
<span class="fc" id="L757">        r1 ^= r4;</span>
<span class="fc" id="L758">        r2 ^= r1;</span>
<span class="fc" id="L759">        r1 &amp;= r0;</span>
<span class="fc" id="L760">        r1 ^= r4;</span>
<span class="fc" id="L761">        r2 = ~r2;</span>
<span class="fc" id="L762">        r2 |= r0;</span>
<span class="fc" id="L763">        r4 ^= r2;</span>
<span class="fc" id="L764">        serpent24SubKeys[i++] = r4;</span>
<span class="fc" id="L765">        serpent24SubKeys[i++] = r3;</span>
<span class="fc" id="L766">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L767">        serpent24SubKeys[i++] = r0;</span>
<span class="fc" id="L768">        tt = w4 ^ w7 ^ w1 ^ w3 ^ (0x9E3779B9 ^ (52));</span>
<span class="fc" id="L769">        w4 = rotateLeft(tt, 11);</span>
<span class="fc" id="L770">        tt = w5 ^ w0 ^ w2 ^ w4 ^ (0x9E3779B9 ^ (52 + 1));</span>
<span class="fc" id="L771">        w5 = rotateLeft(tt, 11);</span>
<span class="fc" id="L772">        tt = w6 ^ w1 ^ w3 ^ w5 ^ (0x9E3779B9 ^ (52 + 2));</span>
<span class="fc" id="L773">        w6 = rotateLeft(tt, 11);</span>
<span class="fc" id="L774">        tt = w7 ^ w2 ^ w4 ^ w6 ^ (0x9E3779B9 ^ (52 + 3));</span>
<span class="fc" id="L775">        w7 = rotateLeft(tt, 11);</span>
<span class="fc" id="L776">        r0 = w4;</span>
<span class="fc" id="L777">        r1 = w5;</span>
<span class="fc" id="L778">        r2 = w6;</span>
<span class="fc" id="L779">        r3 = w7;</span>
<span class="fc" id="L780">        r2 = ~r2;</span>
<span class="fc" id="L781">        r4 = r3;</span>
<span class="fc" id="L782">        r3 &amp;= r0;</span>
<span class="fc" id="L783">        r0 ^= r4;</span>
<span class="fc" id="L784">        r3 ^= r2;</span>
<span class="fc" id="L785">        r2 |= r4;</span>
<span class="fc" id="L786">        r1 ^= r3;</span>
<span class="fc" id="L787">        r2 ^= r0;</span>
<span class="fc" id="L788">        r0 |= r1;</span>
<span class="fc" id="L789">        r2 ^= r1;</span>
<span class="fc" id="L790">        r4 ^= r0;</span>
<span class="fc" id="L791">        r0 |= r3;</span>
<span class="fc" id="L792">        r0 ^= r2;</span>
<span class="fc" id="L793">        r4 ^= r3;</span>
<span class="fc" id="L794">        r4 ^= r0;</span>
<span class="fc" id="L795">        r3 = ~r3;</span>
<span class="fc" id="L796">        r2 &amp;= r4;</span>
<span class="fc" id="L797">        r2 ^= r3;</span>
<span class="fc" id="L798">        serpent24SubKeys[i++] = r0;</span>
<span class="fc" id="L799">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L800">        serpent24SubKeys[i++] = r4;</span>
<span class="fc" id="L801">        serpent24SubKeys[i++] = r2;</span>
<span class="fc" id="L802">        tt = w0 ^ w3 ^ w5 ^ w7 ^ (0x9E3779B9 ^ (56));</span>
<span class="fc" id="L803">        w0 = rotateLeft(tt, 11);</span>
<span class="fc" id="L804">        tt = w1 ^ w4 ^ w6 ^ w0 ^ (0x9E3779B9 ^ (56 + 1));</span>
<span class="fc" id="L805">        w1 = rotateLeft(tt, 11);</span>
<span class="fc" id="L806">        tt = w2 ^ w5 ^ w7 ^ w1 ^ (0x9E3779B9 ^ (56 + 2));</span>
<span class="fc" id="L807">        w2 = rotateLeft(tt, 11);</span>
<span class="fc" id="L808">        tt = w3 ^ w6 ^ w0 ^ w2 ^ (0x9E3779B9 ^ (56 + 3));</span>
<span class="fc" id="L809">        w3 = rotateLeft(tt, 11);</span>
<span class="fc" id="L810">        r0 = w0;</span>
<span class="fc" id="L811">        r1 = w1;</span>
<span class="fc" id="L812">        r2 = w2;</span>
<span class="fc" id="L813">        r3 = w3;</span>
<span class="fc" id="L814">        r0 ^= r1;</span>
<span class="fc" id="L815">        r1 ^= r3;</span>
<span class="fc" id="L816">        r3 = ~r3;</span>
<span class="fc" id="L817">        r4 = r1;</span>
<span class="fc" id="L818">        r1 &amp;= r0;</span>
<span class="fc" id="L819">        r2 ^= r3;</span>
<span class="fc" id="L820">        r1 ^= r2;</span>
<span class="fc" id="L821">        r2 |= r4;</span>
<span class="fc" id="L822">        r4 ^= r3;</span>
<span class="fc" id="L823">        r3 &amp;= r1;</span>
<span class="fc" id="L824">        r3 ^= r0;</span>
<span class="fc" id="L825">        r4 ^= r1;</span>
<span class="fc" id="L826">        r4 ^= r2;</span>
<span class="fc" id="L827">        r2 ^= r0;</span>
<span class="fc" id="L828">        r0 &amp;= r3;</span>
<span class="fc" id="L829">        r2 = ~r2;</span>
<span class="fc" id="L830">        r0 ^= r4;</span>
<span class="fc" id="L831">        r4 |= r3;</span>
<span class="fc" id="L832">        r2 ^= r4;</span>
<span class="fc" id="L833">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L834">        serpent24SubKeys[i++] = r3;</span>
<span class="fc" id="L835">        serpent24SubKeys[i++] = r0;</span>
<span class="fc" id="L836">        serpent24SubKeys[i++] = r2;</span>
<span class="fc" id="L837">        tt = w4 ^ w7 ^ w1 ^ w3 ^ (0x9E3779B9 ^ (60));</span>
<span class="fc" id="L838">        w4 = rotateLeft(tt, 11);</span>
<span class="fc" id="L839">        tt = w5 ^ w0 ^ w2 ^ w4 ^ (0x9E3779B9 ^ (60 + 1));</span>
<span class="fc" id="L840">        w5 = rotateLeft(tt, 11);</span>
<span class="fc" id="L841">        tt = w6 ^ w1 ^ w3 ^ w5 ^ (0x9E3779B9 ^ (60 + 2));</span>
<span class="fc" id="L842">        w6 = rotateLeft(tt, 11);</span>
<span class="fc" id="L843">        tt = w7 ^ w2 ^ w4 ^ w6 ^ (0x9E3779B9 ^ (60 + 3));</span>
<span class="fc" id="L844">        w7 = rotateLeft(tt, 11);</span>
<span class="fc" id="L845">        r0 = w4;</span>
<span class="fc" id="L846">        r1 = w5;</span>
<span class="fc" id="L847">        r2 = w6;</span>
<span class="fc" id="L848">        r3 = w7;</span>
<span class="fc" id="L849">        r1 ^= r3;</span>
<span class="fc" id="L850">        r3 = ~r3;</span>
<span class="fc" id="L851">        r2 ^= r3;</span>
<span class="fc" id="L852">        r3 ^= r0;</span>
<span class="fc" id="L853">        r4 = r1;</span>
<span class="fc" id="L854">        r1 &amp;= r3;</span>
<span class="fc" id="L855">        r1 ^= r2;</span>
<span class="fc" id="L856">        r4 ^= r3;</span>
<span class="fc" id="L857">        r0 ^= r4;</span>
<span class="fc" id="L858">        r2 &amp;= r4;</span>
<span class="fc" id="L859">        r2 ^= r0;</span>
<span class="fc" id="L860">        r0 &amp;= r1;</span>
<span class="fc" id="L861">        r3 ^= r0;</span>
<span class="fc" id="L862">        r4 |= r1;</span>
<span class="fc" id="L863">        r4 ^= r0;</span>
<span class="fc" id="L864">        r0 |= r3;</span>
<span class="fc" id="L865">        r0 ^= r2;</span>
<span class="fc" id="L866">        r2 &amp;= r3;</span>
<span class="fc" id="L867">        r0 = ~r0;</span>
<span class="fc" id="L868">        r4 ^= r2;</span>
<span class="fc" id="L869">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L870">        serpent24SubKeys[i++] = r4;</span>
<span class="fc" id="L871">        serpent24SubKeys[i++] = r0;</span>
<span class="fc" id="L872">        serpent24SubKeys[i++] = r3;</span>
<span class="fc" id="L873">        tt = w0 ^ w3 ^ w5 ^ w7 ^ (0x9E3779B9 ^ (64));</span>
<span class="fc" id="L874">        w0 = rotateLeft(tt, 11);</span>
<span class="fc" id="L875">        tt = w1 ^ w4 ^ w6 ^ w0 ^ (0x9E3779B9 ^ (64 + 1));</span>
<span class="fc" id="L876">        w1 = rotateLeft(tt, 11);</span>
<span class="fc" id="L877">        tt = w2 ^ w5 ^ w7 ^ w1 ^ (0x9E3779B9 ^ (64 + 2));</span>
<span class="fc" id="L878">        w2 = rotateLeft(tt, 11);</span>
<span class="fc" id="L879">        tt = w3 ^ w6 ^ w0 ^ w2 ^ (0x9E3779B9 ^ (64 + 3));</span>
<span class="fc" id="L880">        w3 = rotateLeft(tt, 11);</span>
<span class="fc" id="L881">        r0 = w0;</span>
<span class="fc" id="L882">        r1 = w1;</span>
<span class="fc" id="L883">        r2 = w2;</span>
<span class="fc" id="L884">        r3 = w3;</span>
<span class="fc" id="L885">        r4 = r0;</span>
<span class="fc" id="L886">        r0 |= r3;</span>
<span class="fc" id="L887">        r3 ^= r1;</span>
<span class="fc" id="L888">        r1 &amp;= r4;</span>
<span class="fc" id="L889">        r4 ^= r2;</span>
<span class="fc" id="L890">        r2 ^= r3;</span>
<span class="fc" id="L891">        r3 &amp;= r0;</span>
<span class="fc" id="L892">        r4 |= r1;</span>
<span class="fc" id="L893">        r3 ^= r4;</span>
<span class="fc" id="L894">        r0 ^= r1;</span>
<span class="fc" id="L895">        r4 &amp;= r0;</span>
<span class="fc" id="L896">        r1 ^= r3;</span>
<span class="fc" id="L897">        r4 ^= r2;</span>
<span class="fc" id="L898">        r1 |= r0;</span>
<span class="fc" id="L899">        r1 ^= r2;</span>
<span class="fc" id="L900">        r0 ^= r3;</span>
<span class="fc" id="L901">        r2 = r1;</span>
<span class="fc" id="L902">        r1 |= r3;</span>
<span class="fc" id="L903">        r1 ^= r0;</span>
<span class="fc" id="L904">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L905">        serpent24SubKeys[i++] = r2;</span>
<span class="fc" id="L906">        serpent24SubKeys[i++] = r3;</span>
<span class="fc" id="L907">        serpent24SubKeys[i++] = r4;</span>
<span class="fc" id="L908">        tt = w4 ^ w7 ^ w1 ^ w3 ^ (0x9E3779B9 ^ (68));</span>
<span class="fc" id="L909">        w4 = rotateLeft(tt, 11);</span>
<span class="fc" id="L910">        tt = w5 ^ w0 ^ w2 ^ w4 ^ (0x9E3779B9 ^ (68 + 1));</span>
<span class="fc" id="L911">        w5 = rotateLeft(tt, 11);</span>
<span class="fc" id="L912">        tt = w6 ^ w1 ^ w3 ^ w5 ^ (0x9E3779B9 ^ (68 + 2));</span>
<span class="fc" id="L913">        w6 = rotateLeft(tt, 11);</span>
<span class="fc" id="L914">        tt = w7 ^ w2 ^ w4 ^ w6 ^ (0x9E3779B9 ^ (68 + 3));</span>
<span class="fc" id="L915">        w7 = rotateLeft(tt, 11);</span>
<span class="fc" id="L916">        r0 = w4;</span>
<span class="fc" id="L917">        r1 = w5;</span>
<span class="fc" id="L918">        r2 = w6;</span>
<span class="fc" id="L919">        r3 = w7;</span>
<span class="fc" id="L920">        r4 = r0;</span>
<span class="fc" id="L921">        r0 &amp;= r2;</span>
<span class="fc" id="L922">        r0 ^= r3;</span>
<span class="fc" id="L923">        r2 ^= r1;</span>
<span class="fc" id="L924">        r2 ^= r0;</span>
<span class="fc" id="L925">        r3 |= r4;</span>
<span class="fc" id="L926">        r3 ^= r1;</span>
<span class="fc" id="L927">        r4 ^= r2;</span>
<span class="fc" id="L928">        r1 = r3;</span>
<span class="fc" id="L929">        r3 |= r4;</span>
<span class="fc" id="L930">        r3 ^= r0;</span>
<span class="fc" id="L931">        r0 &amp;= r1;</span>
<span class="fc" id="L932">        r4 ^= r0;</span>
<span class="fc" id="L933">        r1 ^= r3;</span>
<span class="fc" id="L934">        r1 ^= r4;</span>
<span class="fc" id="L935">        r4 = ~r4;</span>
<span class="fc" id="L936">        serpent24SubKeys[i++] = r2;</span>
<span class="fc" id="L937">        serpent24SubKeys[i++] = r3;</span>
<span class="fc" id="L938">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L939">        serpent24SubKeys[i++] = r4;</span>
<span class="fc" id="L940">        tt = w0 ^ w3 ^ w5 ^ w7 ^ (0x9E3779B9 ^ (72));</span>
<span class="fc" id="L941">        w0 = rotateLeft(tt, 11);</span>
<span class="fc" id="L942">        tt = w1 ^ w4 ^ w6 ^ w0 ^ (0x9E3779B9 ^ (72 + 1));</span>
<span class="fc" id="L943">        w1 = rotateLeft(tt, 11);</span>
<span class="fc" id="L944">        tt = w2 ^ w5 ^ w7 ^ w1 ^ (0x9E3779B9 ^ (72 + 2));</span>
<span class="fc" id="L945">        w2 = rotateLeft(tt, 11);</span>
<span class="fc" id="L946">        tt = w3 ^ w6 ^ w0 ^ w2 ^ (0x9E3779B9 ^ (72 + 3));</span>
<span class="fc" id="L947">        w3 = rotateLeft(tt, 11);</span>
<span class="fc" id="L948">        r0 = w0;</span>
<span class="fc" id="L949">        r1 = w1;</span>
<span class="fc" id="L950">        r2 = w2;</span>
<span class="fc" id="L951">        r3 = w3;</span>
<span class="fc" id="L952">        r0 = ~r0;</span>
<span class="fc" id="L953">        r2 = ~r2;</span>
<span class="fc" id="L954">        r4 = r0;</span>
<span class="fc" id="L955">        r0 &amp;= r1;</span>
<span class="fc" id="L956">        r2 ^= r0;</span>
<span class="fc" id="L957">        r0 |= r3;</span>
<span class="fc" id="L958">        r3 ^= r2;</span>
<span class="fc" id="L959">        r1 ^= r0;</span>
<span class="fc" id="L960">        r0 ^= r4;</span>
<span class="fc" id="L961">        r4 |= r1;</span>
<span class="fc" id="L962">        r1 ^= r3;</span>
<span class="fc" id="L963">        r2 |= r0;</span>
<span class="fc" id="L964">        r2 &amp;= r4;</span>
<span class="fc" id="L965">        r0 ^= r1;</span>
<span class="fc" id="L966">        r1 &amp;= r2;</span>
<span class="fc" id="L967">        r1 ^= r0;</span>
<span class="fc" id="L968">        r0 &amp;= r2;</span>
<span class="fc" id="L969">        r0 ^= r4;</span>
<span class="fc" id="L970">        serpent24SubKeys[i++] = r2;</span>
<span class="fc" id="L971">        serpent24SubKeys[i++] = r0;</span>
<span class="fc" id="L972">        serpent24SubKeys[i++] = r3;</span>
<span class="fc" id="L973">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L974">        tt = w4 ^ w7 ^ w1 ^ w3 ^ (0x9E3779B9 ^ (76));</span>
<span class="fc" id="L975">        w4 = rotateLeft(tt, 11);</span>
<span class="fc" id="L976">        tt = w5 ^ w0 ^ w2 ^ w4 ^ (0x9E3779B9 ^ (76 + 1));</span>
<span class="fc" id="L977">        w5 = rotateLeft(tt, 11);</span>
<span class="fc" id="L978">        tt = w6 ^ w1 ^ w3 ^ w5 ^ (0x9E3779B9 ^ (76 + 2));</span>
<span class="fc" id="L979">        w6 = rotateLeft(tt, 11);</span>
<span class="fc" id="L980">        tt = w7 ^ w2 ^ w4 ^ w6 ^ (0x9E3779B9 ^ (76 + 3));</span>
<span class="fc" id="L981">        w7 = rotateLeft(tt, 11);</span>
<span class="fc" id="L982">        r0 = w4;</span>
<span class="fc" id="L983">        r1 = w5;</span>
<span class="fc" id="L984">        r2 = w6;</span>
<span class="fc" id="L985">        r3 = w7;</span>
<span class="fc" id="L986">        r3 ^= r0;</span>
<span class="fc" id="L987">        r4 = r1;</span>
<span class="fc" id="L988">        r1 &amp;= r3;</span>
<span class="fc" id="L989">        r4 ^= r2;</span>
<span class="fc" id="L990">        r1 ^= r0;</span>
<span class="fc" id="L991">        r0 |= r3;</span>
<span class="fc" id="L992">        r0 ^= r4;</span>
<span class="fc" id="L993">        r4 ^= r3;</span>
<span class="fc" id="L994">        r3 ^= r2;</span>
<span class="fc" id="L995">        r2 |= r1;</span>
<span class="fc" id="L996">        r2 ^= r4;</span>
<span class="fc" id="L997">        r4 = ~r4;</span>
<span class="fc" id="L998">        r4 |= r1;</span>
<span class="fc" id="L999">        r1 ^= r3;</span>
<span class="fc" id="L1000">        r1 ^= r4;</span>
<span class="fc" id="L1001">        r3 |= r0;</span>
<span class="fc" id="L1002">        r1 ^= r3;</span>
<span class="fc" id="L1003">        r4 ^= r3;</span>
<span class="fc" id="L1004">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L1005">        serpent24SubKeys[i++] = r4;</span>
<span class="fc" id="L1006">        serpent24SubKeys[i++] = r2;</span>
<span class="fc" id="L1007">        serpent24SubKeys[i++] = r0;</span>
<span class="fc" id="L1008">        tt = w0 ^ w3 ^ w5 ^ w7 ^ (0x9E3779B9 ^ (80));</span>
<span class="fc" id="L1009">        w0 = rotateLeft(tt, 11);</span>
<span class="fc" id="L1010">        tt = w1 ^ w4 ^ w6 ^ w0 ^ (0x9E3779B9 ^ (80 + 1));</span>
<span class="fc" id="L1011">        w1 = rotateLeft(tt, 11);</span>
<span class="fc" id="L1012">        tt = w2 ^ w5 ^ w7 ^ w1 ^ (0x9E3779B9 ^ (80 + 2));</span>
<span class="fc" id="L1013">        w2 = rotateLeft(tt, 11);</span>
<span class="fc" id="L1014">        tt = w3 ^ w6 ^ w0 ^ w2 ^ (0x9E3779B9 ^ (80 + 3));</span>
<span class="fc" id="L1015">        w3 = rotateLeft(tt, 11);</span>
<span class="fc" id="L1016">        r0 = w0;</span>
<span class="fc" id="L1017">        r1 = w1;</span>
<span class="fc" id="L1018">        r2 = w2;</span>
<span class="fc" id="L1019">        r3 = w3;</span>
<span class="fc" id="L1020">        r4 = r1;</span>
<span class="fc" id="L1021">        r1 |= r2;</span>
<span class="fc" id="L1022">        r1 ^= r3;</span>
<span class="fc" id="L1023">        r4 ^= r2;</span>
<span class="fc" id="L1024">        r2 ^= r1;</span>
<span class="fc" id="L1025">        r3 |= r4;</span>
<span class="fc" id="L1026">        r3 &amp;= r0;</span>
<span class="fc" id="L1027">        r4 ^= r2;</span>
<span class="fc" id="L1028">        r3 ^= r1;</span>
<span class="fc" id="L1029">        r1 |= r4;</span>
<span class="fc" id="L1030">        r1 ^= r0;</span>
<span class="fc" id="L1031">        r0 |= r4;</span>
<span class="fc" id="L1032">        r0 ^= r2;</span>
<span class="fc" id="L1033">        r1 ^= r4;</span>
<span class="fc" id="L1034">        r2 ^= r1;</span>
<span class="fc" id="L1035">        r1 &amp;= r0;</span>
<span class="fc" id="L1036">        r1 ^= r4;</span>
<span class="fc" id="L1037">        r2 = ~r2;</span>
<span class="fc" id="L1038">        r2 |= r0;</span>
<span class="fc" id="L1039">        r4 ^= r2;</span>
<span class="fc" id="L1040">        serpent24SubKeys[i++] = r4;</span>
<span class="fc" id="L1041">        serpent24SubKeys[i++] = r3;</span>
<span class="fc" id="L1042">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L1043">        serpent24SubKeys[i++] = r0;</span>
<span class="fc" id="L1044">        tt = w4 ^ w7 ^ w1 ^ w3 ^ (0x9E3779B9 ^ (84));</span>
<span class="fc" id="L1045">        w4 = rotateLeft(tt, 11);</span>
<span class="fc" id="L1046">        tt = w5 ^ w0 ^ w2 ^ w4 ^ (0x9E3779B9 ^ (84 + 1));</span>
<span class="fc" id="L1047">        w5 = rotateLeft(tt, 11);</span>
<span class="fc" id="L1048">        tt = w6 ^ w1 ^ w3 ^ w5 ^ (0x9E3779B9 ^ (84 + 2));</span>
<span class="fc" id="L1049">        w6 = rotateLeft(tt, 11);</span>
<span class="fc" id="L1050">        tt = w7 ^ w2 ^ w4 ^ w6 ^ (0x9E3779B9 ^ (84 + 3));</span>
<span class="fc" id="L1051">        w7 = rotateLeft(tt, 11);</span>
<span class="fc" id="L1052">        r0 = w4;</span>
<span class="fc" id="L1053">        r1 = w5;</span>
<span class="fc" id="L1054">        r2 = w6;</span>
<span class="fc" id="L1055">        r3 = w7;</span>
<span class="fc" id="L1056">        r2 = ~r2;</span>
<span class="fc" id="L1057">        r4 = r3;</span>
<span class="fc" id="L1058">        r3 &amp;= r0;</span>
<span class="fc" id="L1059">        r0 ^= r4;</span>
<span class="fc" id="L1060">        r3 ^= r2;</span>
<span class="fc" id="L1061">        r2 |= r4;</span>
<span class="fc" id="L1062">        r1 ^= r3;</span>
<span class="fc" id="L1063">        r2 ^= r0;</span>
<span class="fc" id="L1064">        r0 |= r1;</span>
<span class="fc" id="L1065">        r2 ^= r1;</span>
<span class="fc" id="L1066">        r4 ^= r0;</span>
<span class="fc" id="L1067">        r0 |= r3;</span>
<span class="fc" id="L1068">        r0 ^= r2;</span>
<span class="fc" id="L1069">        r4 ^= r3;</span>
<span class="fc" id="L1070">        r4 ^= r0;</span>
<span class="fc" id="L1071">        r3 = ~r3;</span>
<span class="fc" id="L1072">        r2 &amp;= r4;</span>
<span class="fc" id="L1073">        r2 ^= r3;</span>
<span class="fc" id="L1074">        serpent24SubKeys[i++] = r0;</span>
<span class="fc" id="L1075">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L1076">        serpent24SubKeys[i++] = r4;</span>
<span class="fc" id="L1077">        serpent24SubKeys[i++] = r2;</span>
<span class="fc" id="L1078">        tt = w0 ^ w3 ^ w5 ^ w7 ^ (0x9E3779B9 ^ (88));</span>
<span class="fc" id="L1079">        w0 = rotateLeft(tt, 11);</span>
<span class="fc" id="L1080">        tt = w1 ^ w4 ^ w6 ^ w0 ^ (0x9E3779B9 ^ (88 + 1));</span>
<span class="fc" id="L1081">        w1 = rotateLeft(tt, 11);</span>
<span class="fc" id="L1082">        tt = w2 ^ w5 ^ w7 ^ w1 ^ (0x9E3779B9 ^ (88 + 2));</span>
<span class="fc" id="L1083">        w2 = rotateLeft(tt, 11);</span>
<span class="fc" id="L1084">        tt = w3 ^ w6 ^ w0 ^ w2 ^ (0x9E3779B9 ^ (88 + 3));</span>
<span class="fc" id="L1085">        w3 = rotateLeft(tt, 11);</span>
<span class="fc" id="L1086">        r0 = w0;</span>
<span class="fc" id="L1087">        r1 = w1;</span>
<span class="fc" id="L1088">        r2 = w2;</span>
<span class="fc" id="L1089">        r3 = w3;</span>
<span class="fc" id="L1090">        r0 ^= r1;</span>
<span class="fc" id="L1091">        r1 ^= r3;</span>
<span class="fc" id="L1092">        r3 = ~r3;</span>
<span class="fc" id="L1093">        r4 = r1;</span>
<span class="fc" id="L1094">        r1 &amp;= r0;</span>
<span class="fc" id="L1095">        r2 ^= r3;</span>
<span class="fc" id="L1096">        r1 ^= r2;</span>
<span class="fc" id="L1097">        r2 |= r4;</span>
<span class="fc" id="L1098">        r4 ^= r3;</span>
<span class="fc" id="L1099">        r3 &amp;= r1;</span>
<span class="fc" id="L1100">        r3 ^= r0;</span>
<span class="fc" id="L1101">        r4 ^= r1;</span>
<span class="fc" id="L1102">        r4 ^= r2;</span>
<span class="fc" id="L1103">        r2 ^= r0;</span>
<span class="fc" id="L1104">        r0 &amp;= r3;</span>
<span class="fc" id="L1105">        r2 = ~r2;</span>
<span class="fc" id="L1106">        r0 ^= r4;</span>
<span class="fc" id="L1107">        r4 |= r3;</span>
<span class="fc" id="L1108">        r2 ^= r4;</span>
<span class="fc" id="L1109">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L1110">        serpent24SubKeys[i++] = r3;</span>
<span class="fc" id="L1111">        serpent24SubKeys[i++] = r0;</span>
<span class="fc" id="L1112">        serpent24SubKeys[i++] = r2;</span>
<span class="fc" id="L1113">        tt = w4 ^ w7 ^ w1 ^ w3 ^ (0x9E3779B9 ^ (92));</span>
<span class="fc" id="L1114">        w4 = rotateLeft(tt, 11);</span>
<span class="fc" id="L1115">        tt = w5 ^ w0 ^ w2 ^ w4 ^ (0x9E3779B9 ^ (92 + 1));</span>
<span class="fc" id="L1116">        w5 = rotateLeft(tt, 11);</span>
<span class="fc" id="L1117">        tt = w6 ^ w1 ^ w3 ^ w5 ^ (0x9E3779B9 ^ (92 + 2));</span>
<span class="fc" id="L1118">        w6 = rotateLeft(tt, 11);</span>
<span class="fc" id="L1119">        tt = w7 ^ w2 ^ w4 ^ w6 ^ (0x9E3779B9 ^ (92 + 3));</span>
<span class="fc" id="L1120">        w7 = rotateLeft(tt, 11);</span>
<span class="fc" id="L1121">        r0 = w4;</span>
<span class="fc" id="L1122">        r1 = w5;</span>
<span class="fc" id="L1123">        r2 = w6;</span>
<span class="fc" id="L1124">        r3 = w7;</span>
<span class="fc" id="L1125">        r1 ^= r3;</span>
<span class="fc" id="L1126">        r3 = ~r3;</span>
<span class="fc" id="L1127">        r2 ^= r3;</span>
<span class="fc" id="L1128">        r3 ^= r0;</span>
<span class="fc" id="L1129">        r4 = r1;</span>
<span class="fc" id="L1130">        r1 &amp;= r3;</span>
<span class="fc" id="L1131">        r1 ^= r2;</span>
<span class="fc" id="L1132">        r4 ^= r3;</span>
<span class="fc" id="L1133">        r0 ^= r4;</span>
<span class="fc" id="L1134">        r2 &amp;= r4;</span>
<span class="fc" id="L1135">        r2 ^= r0;</span>
<span class="fc" id="L1136">        r0 &amp;= r1;</span>
<span class="fc" id="L1137">        r3 ^= r0;</span>
<span class="fc" id="L1138">        r4 |= r1;</span>
<span class="fc" id="L1139">        r4 ^= r0;</span>
<span class="fc" id="L1140">        r0 |= r3;</span>
<span class="fc" id="L1141">        r0 ^= r2;</span>
<span class="fc" id="L1142">        r2 &amp;= r3;</span>
<span class="fc" id="L1143">        r0 = ~r0;</span>
<span class="fc" id="L1144">        r4 ^= r2;</span>
<span class="fc" id="L1145">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L1146">        serpent24SubKeys[i++] = r4;</span>
<span class="fc" id="L1147">        serpent24SubKeys[i++] = r0;</span>
<span class="fc" id="L1148">        serpent24SubKeys[i++] = r3;</span>
<span class="fc" id="L1149">        tt = w0 ^ w3 ^ w5 ^ w7 ^ (0x9E3779B9 ^ (96));</span>
<span class="fc" id="L1150">        w0 = rotateLeft(tt, 11);</span>
<span class="fc" id="L1151">        tt = w1 ^ w4 ^ w6 ^ w0 ^ (0x9E3779B9 ^ (96 + 1));</span>
<span class="fc" id="L1152">        w1 = rotateLeft(tt, 11);</span>
<span class="fc" id="L1153">        tt = w2 ^ w5 ^ w7 ^ w1 ^ (0x9E3779B9 ^ (96 + 2));</span>
<span class="fc" id="L1154">        w2 = rotateLeft(tt, 11);</span>
<span class="fc" id="L1155">        tt = w3 ^ w6 ^ w0 ^ w2 ^ (0x9E3779B9 ^ (96 + 3));</span>
<span class="fc" id="L1156">        w3 = rotateLeft(tt, 11);</span>
<span class="fc" id="L1157">        r0 = w0;</span>
<span class="fc" id="L1158">        r1 = w1;</span>
<span class="fc" id="L1159">        r2 = w2;</span>
<span class="fc" id="L1160">        r3 = w3;</span>
<span class="fc" id="L1161">        r4 = r0;</span>
<span class="fc" id="L1162">        r0 |= r3;</span>
<span class="fc" id="L1163">        r3 ^= r1;</span>
<span class="fc" id="L1164">        r1 &amp;= r4;</span>
<span class="fc" id="L1165">        r4 ^= r2;</span>
<span class="fc" id="L1166">        r2 ^= r3;</span>
<span class="fc" id="L1167">        r3 &amp;= r0;</span>
<span class="fc" id="L1168">        r4 |= r1;</span>
<span class="fc" id="L1169">        r3 ^= r4;</span>
<span class="fc" id="L1170">        r0 ^= r1;</span>
<span class="fc" id="L1171">        r4 &amp;= r0;</span>
<span class="fc" id="L1172">        r1 ^= r3;</span>
<span class="fc" id="L1173">        r4 ^= r2;</span>
<span class="fc" id="L1174">        r1 |= r0;</span>
<span class="fc" id="L1175">        r1 ^= r2;</span>
<span class="fc" id="L1176">        r0 ^= r3;</span>
<span class="fc" id="L1177">        r2 = r1;</span>
<span class="fc" id="L1178">        r1 |= r3;</span>
<span class="fc" id="L1179">        r1 ^= r0;</span>
<span class="fc" id="L1180">        serpent24SubKeys[i++] = r1;</span>
<span class="fc" id="L1181">        serpent24SubKeys[i++] = r2;</span>
<span class="fc" id="L1182">        serpent24SubKeys[i++] = r3;</span>
<span class="fc" id="L1183">        serpent24SubKeys[i++] = r4;</span>
<span class="fc" id="L1184">    }</span>

    /**
     * Set the IV. The IV length must lie between 0 and 16 (inclusive).
     * &lt;code&gt;null&lt;/code&gt; is accepted, and yields the same result
     * than an IV of length 0.
     *
     * @param iv   the IV (or &lt;code&gt;null&lt;/code&gt;)
     */
    @SuppressWarnings(&quot;checkstyle:MethodLength&quot;)
    public void setIV(final byte[] iv) {
<span class="fc" id="L1195">        byte[] myIV = iv;</span>
<span class="pc bpc" id="L1196" title="1 of 2 branches missed.">        if (myIV == null) {</span>
<span class="nc" id="L1197">            myIV = new byte[0];</span>
        }
<span class="pc bpc" id="L1199" title="1 of 2 branches missed.">        if (myIV.length &gt; 16) {</span>
<span class="nc" id="L1200">            throw new IllegalArgumentException(&quot;bad IV length: &quot; + myIV.length);</span>
        }
        final byte[] piv;
<span class="pc bpc" id="L1203" title="1 of 2 branches missed.">        if (myIV.length == 16) {</span>
<span class="fc" id="L1204">            piv = myIV;</span>
        } else {
<span class="nc" id="L1206">            piv = new byte[16];</span>
<span class="nc" id="L1207">            System.arraycopy(myIV, 0, piv, 0, myIV.length);</span>
<span class="nc bnc" id="L1208" title="All 2 branches missed.">            for (int i = myIV.length; i &lt; piv.length; i++) {</span>
<span class="nc" id="L1209">                piv[i] = 0x00;</span>
            }
        }

<span class="fc" id="L1213">        int r0 = decode32le(piv, 0);</span>
<span class="fc" id="L1214">        int r1 = decode32le(piv, 4);</span>
<span class="fc" id="L1215">        int r2 = decode32le(piv, 8);</span>
<span class="fc" id="L1216">        int r3 = decode32le(piv, 12);</span>
        int r4;

<span class="fc" id="L1219">        r0 ^= serpent24SubKeys[0];</span>
<span class="fc" id="L1220">        r1 ^= serpent24SubKeys[0 + 1];</span>
<span class="fc" id="L1221">        r2 ^= serpent24SubKeys[0 + 2];</span>
<span class="fc" id="L1222">        r3 ^= serpent24SubKeys[0 + 3];</span>
<span class="fc" id="L1223">        r3 ^= r0;</span>
<span class="fc" id="L1224">        r4 = r1;</span>
<span class="fc" id="L1225">        r1 &amp;= r3;</span>
<span class="fc" id="L1226">        r4 ^= r2;</span>
<span class="fc" id="L1227">        r1 ^= r0;</span>
<span class="fc" id="L1228">        r0 |= r3;</span>
<span class="fc" id="L1229">        r0 ^= r4;</span>
<span class="fc" id="L1230">        r4 ^= r3;</span>
<span class="fc" id="L1231">        r3 ^= r2;</span>
<span class="fc" id="L1232">        r2 |= r1;</span>
<span class="fc" id="L1233">        r2 ^= r4;</span>
<span class="fc" id="L1234">        r4 = ~r4;</span>
<span class="fc" id="L1235">        r4 |= r1;</span>
<span class="fc" id="L1236">        r1 ^= r3;</span>
<span class="fc" id="L1237">        r1 ^= r4;</span>
<span class="fc" id="L1238">        r3 |= r0;</span>
<span class="fc" id="L1239">        r1 ^= r3;</span>
<span class="fc" id="L1240">        r4 ^= r3;</span>
<span class="fc" id="L1241">        r1 = rotateLeft(r1, 13);</span>
<span class="fc" id="L1242">        r2 = rotateLeft(r2, 3);</span>
<span class="fc" id="L1243">        r4 = r4 ^ r1 ^ r2;</span>
<span class="fc" id="L1244">        r0 = r0 ^ r2 ^ (r1 &lt;&lt; 3);</span>
<span class="fc" id="L1245">        r4 = rotateLeft(r4, 1);</span>
<span class="fc" id="L1246">        r0 = rotateLeft(r0, 7);</span>
<span class="fc" id="L1247">        r1 = r1 ^ r4 ^ r0;</span>
<span class="fc" id="L1248">        r2 = r2 ^ r0 ^ (r4 &lt;&lt; 7);</span>
<span class="fc" id="L1249">        r1 = rotateLeft(r1, 5);</span>
<span class="fc" id="L1250">        r2 = rotateLeft(r2, 22);</span>
<span class="fc" id="L1251">        r1 ^= serpent24SubKeys[4];</span>
<span class="fc" id="L1252">        r4 ^= serpent24SubKeys[4 + 1];</span>
<span class="fc" id="L1253">        r2 ^= serpent24SubKeys[4 + 2];</span>
<span class="fc" id="L1254">        r0 ^= serpent24SubKeys[4 + 3];</span>
<span class="fc" id="L1255">        r1 = ~r1;</span>
<span class="fc" id="L1256">        r2 = ~r2;</span>
<span class="fc" id="L1257">        r3 = r1;</span>
<span class="fc" id="L1258">        r1 &amp;= r4;</span>
<span class="fc" id="L1259">        r2 ^= r1;</span>
<span class="fc" id="L1260">        r1 |= r0;</span>
<span class="fc" id="L1261">        r0 ^= r2;</span>
<span class="fc" id="L1262">        r4 ^= r1;</span>
<span class="fc" id="L1263">        r1 ^= r3;</span>
<span class="fc" id="L1264">        r3 |= r4;</span>
<span class="fc" id="L1265">        r4 ^= r0;</span>
<span class="fc" id="L1266">        r2 |= r1;</span>
<span class="fc" id="L1267">        r2 &amp;= r3;</span>
<span class="fc" id="L1268">        r1 ^= r4;</span>
<span class="fc" id="L1269">        r4 &amp;= r2;</span>
<span class="fc" id="L1270">        r4 ^= r1;</span>
<span class="fc" id="L1271">        r1 &amp;= r2;</span>
<span class="fc" id="L1272">        r1 ^= r3;</span>
<span class="fc" id="L1273">        r2 = rotateLeft(r2, 13);</span>
<span class="fc" id="L1274">        r0 = rotateLeft(r0, 3);</span>
<span class="fc" id="L1275">        r1 = r1 ^ r2 ^ r0;</span>
<span class="fc" id="L1276">        r4 = r4 ^ r0 ^ (r2 &lt;&lt; 3);</span>
<span class="fc" id="L1277">        r1 = rotateLeft(r1, 1);</span>
<span class="fc" id="L1278">        r4 = rotateLeft(r4, 7);</span>
<span class="fc" id="L1279">        r2 = r2 ^ r1 ^ r4;</span>
<span class="fc" id="L1280">        r0 = r0 ^ r4 ^ (r1 &lt;&lt; 7);</span>
<span class="fc" id="L1281">        r2 = rotateLeft(r2, 5);</span>
<span class="fc" id="L1282">        r0 = rotateLeft(r0, 22);</span>
<span class="fc" id="L1283">        r2 ^= serpent24SubKeys[8];</span>
<span class="fc" id="L1284">        r1 ^= serpent24SubKeys[8 + 1];</span>
<span class="fc" id="L1285">        r0 ^= serpent24SubKeys[8 + 2];</span>
<span class="fc" id="L1286">        r4 ^= serpent24SubKeys[8 + 3];</span>
<span class="fc" id="L1287">        r3 = r2;</span>
<span class="fc" id="L1288">        r2 &amp;= r0;</span>
<span class="fc" id="L1289">        r2 ^= r4;</span>
<span class="fc" id="L1290">        r0 ^= r1;</span>
<span class="fc" id="L1291">        r0 ^= r2;</span>
<span class="fc" id="L1292">        r4 |= r3;</span>
<span class="fc" id="L1293">        r4 ^= r1;</span>
<span class="fc" id="L1294">        r3 ^= r0;</span>
<span class="fc" id="L1295">        r1 = r4;</span>
<span class="fc" id="L1296">        r4 |= r3;</span>
<span class="fc" id="L1297">        r4 ^= r2;</span>
<span class="fc" id="L1298">        r2 &amp;= r1;</span>
<span class="fc" id="L1299">        r3 ^= r2;</span>
<span class="fc" id="L1300">        r1 ^= r4;</span>
<span class="fc" id="L1301">        r1 ^= r3;</span>
<span class="fc" id="L1302">        r3 = ~r3;</span>
<span class="fc" id="L1303">        r0 = rotateLeft(r0, 13);</span>
<span class="fc" id="L1304">        r1 = rotateLeft(r1, 3);</span>
<span class="fc" id="L1305">        r4 = r4 ^ r0 ^ r1;</span>
<span class="fc" id="L1306">        r3 = r3 ^ r1 ^ (r0 &lt;&lt; 3);</span>
<span class="fc" id="L1307">        r4 = rotateLeft(r4, 1);</span>
<span class="fc" id="L1308">        r3 = rotateLeft(r3, 7);</span>
<span class="fc" id="L1309">        r0 = r0 ^ r4 ^ r3;</span>
<span class="fc" id="L1310">        r1 = r1 ^ r3 ^ (r4 &lt;&lt; 7);</span>
<span class="fc" id="L1311">        r0 = rotateLeft(r0, 5);</span>
<span class="fc" id="L1312">        r1 = rotateLeft(r1, 22);</span>
<span class="fc" id="L1313">        r0 ^= serpent24SubKeys[12];</span>
<span class="fc" id="L1314">        r4 ^= serpent24SubKeys[12 + 1];</span>
<span class="fc" id="L1315">        r1 ^= serpent24SubKeys[12 + 2];</span>
<span class="fc" id="L1316">        r3 ^= serpent24SubKeys[12 + 3];</span>
<span class="fc" id="L1317">        r2 = r0;</span>
<span class="fc" id="L1318">        r0 |= r3;</span>
<span class="fc" id="L1319">        r3 ^= r4;</span>
<span class="fc" id="L1320">        r4 &amp;= r2;</span>
<span class="fc" id="L1321">        r2 ^= r1;</span>
<span class="fc" id="L1322">        r1 ^= r3;</span>
<span class="fc" id="L1323">        r3 &amp;= r0;</span>
<span class="fc" id="L1324">        r2 |= r4;</span>
<span class="fc" id="L1325">        r3 ^= r2;</span>
<span class="fc" id="L1326">        r0 ^= r4;</span>
<span class="fc" id="L1327">        r2 &amp;= r0;</span>
<span class="fc" id="L1328">        r4 ^= r3;</span>
<span class="fc" id="L1329">        r2 ^= r1;</span>
<span class="fc" id="L1330">        r4 |= r0;</span>
<span class="fc" id="L1331">        r4 ^= r1;</span>
<span class="fc" id="L1332">        r0 ^= r3;</span>
<span class="fc" id="L1333">        r1 = r4;</span>
<span class="fc" id="L1334">        r4 |= r3;</span>
<span class="fc" id="L1335">        r4 ^= r0;</span>
<span class="fc" id="L1336">        r4 = rotateLeft(r4, 13);</span>
<span class="fc" id="L1337">        r3 = rotateLeft(r3, 3);</span>
<span class="fc" id="L1338">        r1 = r1 ^ r4 ^ r3;</span>
<span class="fc" id="L1339">        r2 = r2 ^ r3 ^ (r4 &lt;&lt; 3);</span>
<span class="fc" id="L1340">        r1 = rotateLeft(r1, 1);</span>
<span class="fc" id="L1341">        r2 = rotateLeft(r2, 7);</span>
<span class="fc" id="L1342">        r4 = r4 ^ r1 ^ r2;</span>
<span class="fc" id="L1343">        r3 = r3 ^ r2 ^ (r1 &lt;&lt; 7);</span>
<span class="fc" id="L1344">        r4 = rotateLeft(r4, 5);</span>
<span class="fc" id="L1345">        r3 = rotateLeft(r3, 22);</span>
<span class="fc" id="L1346">        r4 ^= serpent24SubKeys[16];</span>
<span class="fc" id="L1347">        r1 ^= serpent24SubKeys[16 + 1];</span>
<span class="fc" id="L1348">        r3 ^= serpent24SubKeys[16 + 2];</span>
<span class="fc" id="L1349">        r2 ^= serpent24SubKeys[16 + 3];</span>
<span class="fc" id="L1350">        r1 ^= r2;</span>
<span class="fc" id="L1351">        r2 = ~r2;</span>
<span class="fc" id="L1352">        r3 ^= r2;</span>
<span class="fc" id="L1353">        r2 ^= r4;</span>
<span class="fc" id="L1354">        r0 = r1;</span>
<span class="fc" id="L1355">        r1 &amp;= r2;</span>
<span class="fc" id="L1356">        r1 ^= r3;</span>
<span class="fc" id="L1357">        r0 ^= r2;</span>
<span class="fc" id="L1358">        r4 ^= r0;</span>
<span class="fc" id="L1359">        r3 &amp;= r0;</span>
<span class="fc" id="L1360">        r3 ^= r4;</span>
<span class="fc" id="L1361">        r4 &amp;= r1;</span>
<span class="fc" id="L1362">        r2 ^= r4;</span>
<span class="fc" id="L1363">        r0 |= r1;</span>
<span class="fc" id="L1364">        r0 ^= r4;</span>
<span class="fc" id="L1365">        r4 |= r2;</span>
<span class="fc" id="L1366">        r4 ^= r3;</span>
<span class="fc" id="L1367">        r3 &amp;= r2;</span>
<span class="fc" id="L1368">        r4 = ~r4;</span>
<span class="fc" id="L1369">        r0 ^= r3;</span>
<span class="fc" id="L1370">        r1 = rotateLeft(r1, 13);</span>
<span class="fc" id="L1371">        r4 = rotateLeft(r4, 3);</span>
<span class="fc" id="L1372">        r0 = r0 ^ r1 ^ r4;</span>
<span class="fc" id="L1373">        r2 = r2 ^ r4 ^ (r1 &lt;&lt; 3);</span>
<span class="fc" id="L1374">        r0 = rotateLeft(r0, 1);</span>
<span class="fc" id="L1375">        r2 = rotateLeft(r2, 7);</span>
<span class="fc" id="L1376">        r1 = r1 ^ r0 ^ r2;</span>
<span class="fc" id="L1377">        r4 = r4 ^ r2 ^ (r0 &lt;&lt; 7);</span>
<span class="fc" id="L1378">        r1 = rotateLeft(r1, 5);</span>
<span class="fc" id="L1379">        r4 = rotateLeft(r4, 22);</span>
<span class="fc" id="L1380">        r1 ^= serpent24SubKeys[20];</span>
<span class="fc" id="L1381">        r0 ^= serpent24SubKeys[20 + 1];</span>
<span class="fc" id="L1382">        r4 ^= serpent24SubKeys[20 + 2];</span>
<span class="fc" id="L1383">        r2 ^= serpent24SubKeys[20 + 3];</span>
<span class="fc" id="L1384">        r1 ^= r0;</span>
<span class="fc" id="L1385">        r0 ^= r2;</span>
<span class="fc" id="L1386">        r2 = ~r2;</span>
<span class="fc" id="L1387">        r3 = r0;</span>
<span class="fc" id="L1388">        r0 &amp;= r1;</span>
<span class="fc" id="L1389">        r4 ^= r2;</span>
<span class="fc" id="L1390">        r0 ^= r4;</span>
<span class="fc" id="L1391">        r4 |= r3;</span>
<span class="fc" id="L1392">        r3 ^= r2;</span>
<span class="fc" id="L1393">        r2 &amp;= r0;</span>
<span class="fc" id="L1394">        r2 ^= r1;</span>
<span class="fc" id="L1395">        r3 ^= r0;</span>
<span class="fc" id="L1396">        r3 ^= r4;</span>
<span class="fc" id="L1397">        r4 ^= r1;</span>
<span class="fc" id="L1398">        r1 &amp;= r2;</span>
<span class="fc" id="L1399">        r4 = ~r4;</span>
<span class="fc" id="L1400">        r1 ^= r3;</span>
<span class="fc" id="L1401">        r3 |= r2;</span>
<span class="fc" id="L1402">        r4 ^= r3;</span>
<span class="fc" id="L1403">        r0 = rotateLeft(r0, 13);</span>
<span class="fc" id="L1404">        r1 = rotateLeft(r1, 3);</span>
<span class="fc" id="L1405">        r2 = r2 ^ r0 ^ r1;</span>
<span class="fc" id="L1406">        r4 = r4 ^ r1 ^ (r0 &lt;&lt; 3);</span>
<span class="fc" id="L1407">        r2 = rotateLeft(r2, 1);</span>
<span class="fc" id="L1408">        r4 = rotateLeft(r4, 7);</span>
<span class="fc" id="L1409">        r0 = r0 ^ r2 ^ r4;</span>
<span class="fc" id="L1410">        r1 = r1 ^ r4 ^ (r2 &lt;&lt; 7);</span>
<span class="fc" id="L1411">        r0 = rotateLeft(r0, 5);</span>
<span class="fc" id="L1412">        r1 = rotateLeft(r1, 22);</span>
<span class="fc" id="L1413">        r0 ^= serpent24SubKeys[24];</span>
<span class="fc" id="L1414">        r2 ^= serpent24SubKeys[24 + 1];</span>
<span class="fc" id="L1415">        r1 ^= serpent24SubKeys[24 + 2];</span>
<span class="fc" id="L1416">        r4 ^= serpent24SubKeys[24 + 3];</span>
<span class="fc" id="L1417">        r1 = ~r1;</span>
<span class="fc" id="L1418">        r3 = r4;</span>
<span class="fc" id="L1419">        r4 &amp;= r0;</span>
<span class="fc" id="L1420">        r0 ^= r3;</span>
<span class="fc" id="L1421">        r4 ^= r1;</span>
<span class="fc" id="L1422">        r1 |= r3;</span>
<span class="fc" id="L1423">        r2 ^= r4;</span>
<span class="fc" id="L1424">        r1 ^= r0;</span>
<span class="fc" id="L1425">        r0 |= r2;</span>
<span class="fc" id="L1426">        r1 ^= r2;</span>
<span class="fc" id="L1427">        r3 ^= r0;</span>
<span class="fc" id="L1428">        r0 |= r4;</span>
<span class="fc" id="L1429">        r0 ^= r1;</span>
<span class="fc" id="L1430">        r3 ^= r4;</span>
<span class="fc" id="L1431">        r3 ^= r0;</span>
<span class="fc" id="L1432">        r4 = ~r4;</span>
<span class="fc" id="L1433">        r1 &amp;= r3;</span>
<span class="fc" id="L1434">        r1 ^= r4;</span>
<span class="fc" id="L1435">        r0 = rotateLeft(r0, 13);</span>
<span class="fc" id="L1436">        r3 = rotateLeft(r3, 3);</span>
<span class="fc" id="L1437">        r2 = r2 ^ r0 ^ r3;</span>
<span class="fc" id="L1438">        r1 = r1 ^ r3 ^ (r0 &lt;&lt; 3);</span>
<span class="fc" id="L1439">        r2 = rotateLeft(r2, 1);</span>
<span class="fc" id="L1440">        r1 = rotateLeft(r1, 7);</span>
<span class="fc" id="L1441">        r0 = r0 ^ r2 ^ r1;</span>
<span class="fc" id="L1442">        r3 = r3 ^ r1 ^ (r2 &lt;&lt; 7);</span>
<span class="fc" id="L1443">        r0 = rotateLeft(r0, 5);</span>
<span class="fc" id="L1444">        r3 = rotateLeft(r3, 22);</span>
<span class="fc" id="L1445">        r0 ^= serpent24SubKeys[28];</span>
<span class="fc" id="L1446">        r2 ^= serpent24SubKeys[28 + 1];</span>
<span class="fc" id="L1447">        r3 ^= serpent24SubKeys[28 + 2];</span>
<span class="fc" id="L1448">        r1 ^= serpent24SubKeys[28 + 3];</span>
<span class="fc" id="L1449">        r4 = r2;</span>
<span class="fc" id="L1450">        r2 |= r3;</span>
<span class="fc" id="L1451">        r2 ^= r1;</span>
<span class="fc" id="L1452">        r4 ^= r3;</span>
<span class="fc" id="L1453">        r3 ^= r2;</span>
<span class="fc" id="L1454">        r1 |= r4;</span>
<span class="fc" id="L1455">        r1 &amp;= r0;</span>
<span class="fc" id="L1456">        r4 ^= r3;</span>
<span class="fc" id="L1457">        r1 ^= r2;</span>
<span class="fc" id="L1458">        r2 |= r4;</span>
<span class="fc" id="L1459">        r2 ^= r0;</span>
<span class="fc" id="L1460">        r0 |= r4;</span>
<span class="fc" id="L1461">        r0 ^= r3;</span>
<span class="fc" id="L1462">        r2 ^= r4;</span>
<span class="fc" id="L1463">        r3 ^= r2;</span>
<span class="fc" id="L1464">        r2 &amp;= r0;</span>
<span class="fc" id="L1465">        r2 ^= r4;</span>
<span class="fc" id="L1466">        r3 = ~r3;</span>
<span class="fc" id="L1467">        r3 |= r0;</span>
<span class="fc" id="L1468">        r4 ^= r3;</span>
<span class="fc" id="L1469">        r4 = rotateLeft(r4, 13);</span>
<span class="fc" id="L1470">        r2 = rotateLeft(r2, 3);</span>
<span class="fc" id="L1471">        r1 = r1 ^ r4 ^ r2;</span>
<span class="fc" id="L1472">        r0 = r0 ^ r2 ^ (r4 &lt;&lt; 3);</span>
<span class="fc" id="L1473">        r1 = rotateLeft(r1, 1);</span>
<span class="fc" id="L1474">        r0 = rotateLeft(r0, 7);</span>
<span class="fc" id="L1475">        r4 = r4 ^ r1 ^ r0;</span>
<span class="fc" id="L1476">        r2 = r2 ^ r0 ^ (r1 &lt;&lt; 7);</span>
<span class="fc" id="L1477">        r4 = rotateLeft(r4, 5);</span>
<span class="fc" id="L1478">        r2 = rotateLeft(r2, 22);</span>
<span class="fc" id="L1479">        r4 ^= serpent24SubKeys[32];</span>
<span class="fc" id="L1480">        r1 ^= serpent24SubKeys[32 + 1];</span>
<span class="fc" id="L1481">        r2 ^= serpent24SubKeys[32 + 2];</span>
<span class="fc" id="L1482">        r0 ^= serpent24SubKeys[32 + 3];</span>
<span class="fc" id="L1483">        r0 ^= r4;</span>
<span class="fc" id="L1484">        r3 = r1;</span>
<span class="fc" id="L1485">        r1 &amp;= r0;</span>
<span class="fc" id="L1486">        r3 ^= r2;</span>
<span class="fc" id="L1487">        r1 ^= r4;</span>
<span class="fc" id="L1488">        r4 |= r0;</span>
<span class="fc" id="L1489">        r4 ^= r3;</span>
<span class="fc" id="L1490">        r3 ^= r0;</span>
<span class="fc" id="L1491">        r0 ^= r2;</span>
<span class="fc" id="L1492">        r2 |= r1;</span>
<span class="fc" id="L1493">        r2 ^= r3;</span>
<span class="fc" id="L1494">        r3 = ~r3;</span>
<span class="fc" id="L1495">        r3 |= r1;</span>
<span class="fc" id="L1496">        r1 ^= r0;</span>
<span class="fc" id="L1497">        r1 ^= r3;</span>
<span class="fc" id="L1498">        r0 |= r4;</span>
<span class="fc" id="L1499">        r1 ^= r0;</span>
<span class="fc" id="L1500">        r3 ^= r0;</span>
<span class="fc" id="L1501">        r1 = rotateLeft(r1, 13);</span>
<span class="fc" id="L1502">        r2 = rotateLeft(r2, 3);</span>
<span class="fc" id="L1503">        r3 = r3 ^ r1 ^ r2;</span>
<span class="fc" id="L1504">        r4 = r4 ^ r2 ^ (r1 &lt;&lt; 3);</span>
<span class="fc" id="L1505">        r3 = rotateLeft(r3, 1);</span>
<span class="fc" id="L1506">        r4 = rotateLeft(r4, 7);</span>
<span class="fc" id="L1507">        r1 = r1 ^ r3 ^ r4;</span>
<span class="fc" id="L1508">        r2 = r2 ^ r4 ^ (r3 &lt;&lt; 7);</span>
<span class="fc" id="L1509">        r1 = rotateLeft(r1, 5);</span>
<span class="fc" id="L1510">        r2 = rotateLeft(r2, 22);</span>
<span class="fc" id="L1511">        r1 ^= serpent24SubKeys[36];</span>
<span class="fc" id="L1512">        r3 ^= serpent24SubKeys[36 + 1];</span>
<span class="fc" id="L1513">        r2 ^= serpent24SubKeys[36 + 2];</span>
<span class="fc" id="L1514">        r4 ^= serpent24SubKeys[36 + 3];</span>
<span class="fc" id="L1515">        r1 = ~r1;</span>
<span class="fc" id="L1516">        r2 = ~r2;</span>
<span class="fc" id="L1517">        r0 = r1;</span>
<span class="fc" id="L1518">        r1 &amp;= r3;</span>
<span class="fc" id="L1519">        r2 ^= r1;</span>
<span class="fc" id="L1520">        r1 |= r4;</span>
<span class="fc" id="L1521">        r4 ^= r2;</span>
<span class="fc" id="L1522">        r3 ^= r1;</span>
<span class="fc" id="L1523">        r1 ^= r0;</span>
<span class="fc" id="L1524">        r0 |= r3;</span>
<span class="fc" id="L1525">        r3 ^= r4;</span>
<span class="fc" id="L1526">        r2 |= r1;</span>
<span class="fc" id="L1527">        r2 &amp;= r0;</span>
<span class="fc" id="L1528">        r1 ^= r3;</span>
<span class="fc" id="L1529">        r3 &amp;= r2;</span>
<span class="fc" id="L1530">        r3 ^= r1;</span>
<span class="fc" id="L1531">        r1 &amp;= r2;</span>
<span class="fc" id="L1532">        r1 ^= r0;</span>
<span class="fc" id="L1533">        r2 = rotateLeft(r2, 13);</span>
<span class="fc" id="L1534">        r4 = rotateLeft(r4, 3);</span>
<span class="fc" id="L1535">        r1 = r1 ^ r2 ^ r4;</span>
<span class="fc" id="L1536">        r3 = r3 ^ r4 ^ (r2 &lt;&lt; 3);</span>
<span class="fc" id="L1537">        r1 = rotateLeft(r1, 1);</span>
<span class="fc" id="L1538">        r3 = rotateLeft(r3, 7);</span>
<span class="fc" id="L1539">        r2 = r2 ^ r1 ^ r3;</span>
<span class="fc" id="L1540">        r4 = r4 ^ r3 ^ (r1 &lt;&lt; 7);</span>
<span class="fc" id="L1541">        r2 = rotateLeft(r2, 5);</span>
<span class="fc" id="L1542">        r4 = rotateLeft(r4, 22);</span>
<span class="fc" id="L1543">        r2 ^= serpent24SubKeys[40];</span>
<span class="fc" id="L1544">        r1 ^= serpent24SubKeys[40 + 1];</span>
<span class="fc" id="L1545">        r4 ^= serpent24SubKeys[40 + 2];</span>
<span class="fc" id="L1546">        r3 ^= serpent24SubKeys[40 + 3];</span>
<span class="fc" id="L1547">        r0 = r2;</span>
<span class="fc" id="L1548">        r2 &amp;= r4;</span>
<span class="fc" id="L1549">        r2 ^= r3;</span>
<span class="fc" id="L1550">        r4 ^= r1;</span>
<span class="fc" id="L1551">        r4 ^= r2;</span>
<span class="fc" id="L1552">        r3 |= r0;</span>
<span class="fc" id="L1553">        r3 ^= r1;</span>
<span class="fc" id="L1554">        r0 ^= r4;</span>
<span class="fc" id="L1555">        r1 = r3;</span>
<span class="fc" id="L1556">        r3 |= r0;</span>
<span class="fc" id="L1557">        r3 ^= r2;</span>
<span class="fc" id="L1558">        r2 &amp;= r1;</span>
<span class="fc" id="L1559">        r0 ^= r2;</span>
<span class="fc" id="L1560">        r1 ^= r3;</span>
<span class="fc" id="L1561">        r1 ^= r0;</span>
<span class="fc" id="L1562">        r0 = ~r0;</span>
<span class="fc" id="L1563">        r4 = rotateLeft(r4, 13);</span>
<span class="fc" id="L1564">        r1 = rotateLeft(r1, 3);</span>
<span class="fc" id="L1565">        r3 = r3 ^ r4 ^ r1;</span>
<span class="fc" id="L1566">        r0 = r0 ^ r1 ^ (r4 &lt;&lt; 3);</span>
<span class="fc" id="L1567">        r3 = rotateLeft(r3, 1);</span>
<span class="fc" id="L1568">        r0 = rotateLeft(r0, 7);</span>
<span class="fc" id="L1569">        r4 = r4 ^ r3 ^ r0;</span>
<span class="fc" id="L1570">        r1 = r1 ^ r0 ^ (r3 &lt;&lt; 7);</span>
<span class="fc" id="L1571">        r4 = rotateLeft(r4, 5);</span>
<span class="fc" id="L1572">        r1 = rotateLeft(r1, 22);</span>
<span class="fc" id="L1573">        r4 ^= serpent24SubKeys[44];</span>
<span class="fc" id="L1574">        r3 ^= serpent24SubKeys[44 + 1];</span>
<span class="fc" id="L1575">        r1 ^= serpent24SubKeys[44 + 2];</span>
<span class="fc" id="L1576">        r0 ^= serpent24SubKeys[44 + 3];</span>
<span class="fc" id="L1577">        r2 = r4;</span>
<span class="fc" id="L1578">        r4 |= r0;</span>
<span class="fc" id="L1579">        r0 ^= r3;</span>
<span class="fc" id="L1580">        r3 &amp;= r2;</span>
<span class="fc" id="L1581">        r2 ^= r1;</span>
<span class="fc" id="L1582">        r1 ^= r0;</span>
<span class="fc" id="L1583">        r0 &amp;= r4;</span>
<span class="fc" id="L1584">        r2 |= r3;</span>
<span class="fc" id="L1585">        r0 ^= r2;</span>
<span class="fc" id="L1586">        r4 ^= r3;</span>
<span class="fc" id="L1587">        r2 &amp;= r4;</span>
<span class="fc" id="L1588">        r3 ^= r0;</span>
<span class="fc" id="L1589">        r2 ^= r1;</span>
<span class="fc" id="L1590">        r3 |= r4;</span>
<span class="fc" id="L1591">        r3 ^= r1;</span>
<span class="fc" id="L1592">        r4 ^= r0;</span>
<span class="fc" id="L1593">        r1 = r3;</span>
<span class="fc" id="L1594">        r3 |= r0;</span>
<span class="fc" id="L1595">        r3 ^= r4;</span>
<span class="fc" id="L1596">        r3 = rotateLeft(r3, 13);</span>
<span class="fc" id="L1597">        r0 = rotateLeft(r0, 3);</span>
<span class="fc" id="L1598">        r1 = r1 ^ r3 ^ r0;</span>
<span class="fc" id="L1599">        r2 = r2 ^ r0 ^ (r3 &lt;&lt; 3);</span>
<span class="fc" id="L1600">        r1 = rotateLeft(r1, 1);</span>
<span class="fc" id="L1601">        r2 = rotateLeft(r2, 7);</span>
<span class="fc" id="L1602">        r3 = r3 ^ r1 ^ r2;</span>
<span class="fc" id="L1603">        r0 = r0 ^ r2 ^ (r1 &lt;&lt; 7);</span>
<span class="fc" id="L1604">        r3 = rotateLeft(r3, 5);</span>
<span class="fc" id="L1605">        r0 = rotateLeft(r0, 22);</span>
<span class="fc" id="L1606">        lfsr9 = r3;</span>
<span class="fc" id="L1607">        lfsr8 = r1;</span>
<span class="fc" id="L1608">        lfsr7 = r0;</span>
<span class="fc" id="L1609">        lfsr6 = r2;</span>
<span class="fc" id="L1610">        r3 ^= serpent24SubKeys[48];</span>
<span class="fc" id="L1611">        r1 ^= serpent24SubKeys[48 + 1];</span>
<span class="fc" id="L1612">        r0 ^= serpent24SubKeys[48 + 2];</span>
<span class="fc" id="L1613">        r2 ^= serpent24SubKeys[48 + 3];</span>
<span class="fc" id="L1614">        r1 ^= r2;</span>
<span class="fc" id="L1615">        r2 = ~r2;</span>
<span class="fc" id="L1616">        r0 ^= r2;</span>
<span class="fc" id="L1617">        r2 ^= r3;</span>
<span class="fc" id="L1618">        r4 = r1;</span>
<span class="fc" id="L1619">        r1 &amp;= r2;</span>
<span class="fc" id="L1620">        r1 ^= r0;</span>
<span class="fc" id="L1621">        r4 ^= r2;</span>
<span class="fc" id="L1622">        r3 ^= r4;</span>
<span class="fc" id="L1623">        r0 &amp;= r4;</span>
<span class="fc" id="L1624">        r0 ^= r3;</span>
<span class="fc" id="L1625">        r3 &amp;= r1;</span>
<span class="fc" id="L1626">        r2 ^= r3;</span>
<span class="fc" id="L1627">        r4 |= r1;</span>
<span class="fc" id="L1628">        r4 ^= r3;</span>
<span class="fc" id="L1629">        r3 |= r2;</span>
<span class="fc" id="L1630">        r3 ^= r0;</span>
<span class="fc" id="L1631">        r0 &amp;= r2;</span>
<span class="fc" id="L1632">        r3 = ~r3;</span>
<span class="fc" id="L1633">        r4 ^= r0;</span>
<span class="fc" id="L1634">        r1 = rotateLeft(r1, 13);</span>
<span class="fc" id="L1635">        r3 = rotateLeft(r3, 3);</span>
<span class="fc" id="L1636">        r4 = r4 ^ r1 ^ r3;</span>
<span class="fc" id="L1637">        r2 = r2 ^ r3 ^ (r1 &lt;&lt; 3);</span>
<span class="fc" id="L1638">        r4 = rotateLeft(r4, 1);</span>
<span class="fc" id="L1639">        r2 = rotateLeft(r2, 7);</span>
<span class="fc" id="L1640">        r1 = r1 ^ r4 ^ r2;</span>
<span class="fc" id="L1641">        r3 = r3 ^ r2 ^ (r4 &lt;&lt; 7);</span>
<span class="fc" id="L1642">        r1 = rotateLeft(r1, 5);</span>
<span class="fc" id="L1643">        r3 = rotateLeft(r3, 22);</span>
<span class="fc" id="L1644">        r1 ^= serpent24SubKeys[52];</span>
<span class="fc" id="L1645">        r4 ^= serpent24SubKeys[52 + 1];</span>
<span class="fc" id="L1646">        r3 ^= serpent24SubKeys[52 + 2];</span>
<span class="fc" id="L1647">        r2 ^= serpent24SubKeys[52 + 3];</span>
<span class="fc" id="L1648">        r1 ^= r4;</span>
<span class="fc" id="L1649">        r4 ^= r2;</span>
<span class="fc" id="L1650">        r2 = ~r2;</span>
<span class="fc" id="L1651">        r0 = r4;</span>
<span class="fc" id="L1652">        r4 &amp;= r1;</span>
<span class="fc" id="L1653">        r3 ^= r2;</span>
<span class="fc" id="L1654">        r4 ^= r3;</span>
<span class="fc" id="L1655">        r3 |= r0;</span>
<span class="fc" id="L1656">        r0 ^= r2;</span>
<span class="fc" id="L1657">        r2 &amp;= r4;</span>
<span class="fc" id="L1658">        r2 ^= r1;</span>
<span class="fc" id="L1659">        r0 ^= r4;</span>
<span class="fc" id="L1660">        r0 ^= r3;</span>
<span class="fc" id="L1661">        r3 ^= r1;</span>
<span class="fc" id="L1662">        r1 &amp;= r2;</span>
<span class="fc" id="L1663">        r3 = ~r3;</span>
<span class="fc" id="L1664">        r1 ^= r0;</span>
<span class="fc" id="L1665">        r0 |= r2;</span>
<span class="fc" id="L1666">        r3 ^= r0;</span>
<span class="fc" id="L1667">        r4 = rotateLeft(r4, 13);</span>
<span class="fc" id="L1668">        r1 = rotateLeft(r1, 3);</span>
<span class="fc" id="L1669">        r2 = r2 ^ r4 ^ r1;</span>
<span class="fc" id="L1670">        r3 = r3 ^ r1 ^ (r4 &lt;&lt; 3);</span>
<span class="fc" id="L1671">        r2 = rotateLeft(r2, 1);</span>
<span class="fc" id="L1672">        r3 = rotateLeft(r3, 7);</span>
<span class="fc" id="L1673">        r4 = r4 ^ r2 ^ r3;</span>
<span class="fc" id="L1674">        r1 = r1 ^ r3 ^ (r2 &lt;&lt; 7);</span>
<span class="fc" id="L1675">        r4 = rotateLeft(r4, 5);</span>
<span class="fc" id="L1676">        r1 = rotateLeft(r1, 22);</span>
<span class="fc" id="L1677">        r4 ^= serpent24SubKeys[56];</span>
<span class="fc" id="L1678">        r2 ^= serpent24SubKeys[56 + 1];</span>
<span class="fc" id="L1679">        r1 ^= serpent24SubKeys[56 + 2];</span>
<span class="fc" id="L1680">        r3 ^= serpent24SubKeys[56 + 3];</span>
<span class="fc" id="L1681">        r1 = ~r1;</span>
<span class="fc" id="L1682">        r0 = r3;</span>
<span class="fc" id="L1683">        r3 &amp;= r4;</span>
<span class="fc" id="L1684">        r4 ^= r0;</span>
<span class="fc" id="L1685">        r3 ^= r1;</span>
<span class="fc" id="L1686">        r1 |= r0;</span>
<span class="fc" id="L1687">        r2 ^= r3;</span>
<span class="fc" id="L1688">        r1 ^= r4;</span>
<span class="fc" id="L1689">        r4 |= r2;</span>
<span class="fc" id="L1690">        r1 ^= r2;</span>
<span class="fc" id="L1691">        r0 ^= r4;</span>
<span class="fc" id="L1692">        r4 |= r3;</span>
<span class="fc" id="L1693">        r4 ^= r1;</span>
<span class="fc" id="L1694">        r0 ^= r3;</span>
<span class="fc" id="L1695">        r0 ^= r4;</span>
<span class="fc" id="L1696">        r3 = ~r3;</span>
<span class="fc" id="L1697">        r1 &amp;= r0;</span>
<span class="fc" id="L1698">        r1 ^= r3;</span>
<span class="fc" id="L1699">        r4 = rotateLeft(r4, 13);</span>
<span class="fc" id="L1700">        r0 = rotateLeft(r0, 3);</span>
<span class="fc" id="L1701">        r2 = r2 ^ r4 ^ r0;</span>
<span class="fc" id="L1702">        r1 = r1 ^ r0 ^ (r4 &lt;&lt; 3);</span>
<span class="fc" id="L1703">        r2 = rotateLeft(r2, 1);</span>
<span class="fc" id="L1704">        r1 = rotateLeft(r1, 7);</span>
<span class="fc" id="L1705">        r4 = r4 ^ r2 ^ r1;</span>
<span class="fc" id="L1706">        r0 = r0 ^ r1 ^ (r2 &lt;&lt; 7);</span>
<span class="fc" id="L1707">        r4 = rotateLeft(r4, 5);</span>
<span class="fc" id="L1708">        r0 = rotateLeft(r0, 22);</span>
<span class="fc" id="L1709">        r4 ^= serpent24SubKeys[60];</span>
<span class="fc" id="L1710">        r2 ^= serpent24SubKeys[60 + 1];</span>
<span class="fc" id="L1711">        r0 ^= serpent24SubKeys[60 + 2];</span>
<span class="fc" id="L1712">        r1 ^= serpent24SubKeys[60 + 3];</span>
<span class="fc" id="L1713">        r3 = r2;</span>
<span class="fc" id="L1714">        r2 |= r0;</span>
<span class="fc" id="L1715">        r2 ^= r1;</span>
<span class="fc" id="L1716">        r3 ^= r0;</span>
<span class="fc" id="L1717">        r0 ^= r2;</span>
<span class="fc" id="L1718">        r1 |= r3;</span>
<span class="fc" id="L1719">        r1 &amp;= r4;</span>
<span class="fc" id="L1720">        r3 ^= r0;</span>
<span class="fc" id="L1721">        r1 ^= r2;</span>
<span class="fc" id="L1722">        r2 |= r3;</span>
<span class="fc" id="L1723">        r2 ^= r4;</span>
<span class="fc" id="L1724">        r4 |= r3;</span>
<span class="fc" id="L1725">        r4 ^= r0;</span>
<span class="fc" id="L1726">        r2 ^= r3;</span>
<span class="fc" id="L1727">        r0 ^= r2;</span>
<span class="fc" id="L1728">        r2 &amp;= r4;</span>
<span class="fc" id="L1729">        r2 ^= r3;</span>
<span class="fc" id="L1730">        r0 = ~r0;</span>
<span class="fc" id="L1731">        r0 |= r4;</span>
<span class="fc" id="L1732">        r3 ^= r0;</span>
<span class="fc" id="L1733">        r3 = rotateLeft(r3, 13);</span>
<span class="fc" id="L1734">        r2 = rotateLeft(r2, 3);</span>
<span class="fc" id="L1735">        r1 = r1 ^ r3 ^ r2;</span>
<span class="fc" id="L1736">        r4 = r4 ^ r2 ^ (r3 &lt;&lt; 3);</span>
<span class="fc" id="L1737">        r1 = rotateLeft(r1, 1);</span>
<span class="fc" id="L1738">        r4 = rotateLeft(r4, 7);</span>
<span class="fc" id="L1739">        r3 = r3 ^ r1 ^ r4;</span>
<span class="fc" id="L1740">        r2 = r2 ^ r4 ^ (r1 &lt;&lt; 7);</span>
<span class="fc" id="L1741">        r3 = rotateLeft(r3, 5);</span>
<span class="fc" id="L1742">        r2 = rotateLeft(r2, 22);</span>
<span class="fc" id="L1743">        r3 ^= serpent24SubKeys[64];</span>
<span class="fc" id="L1744">        r1 ^= serpent24SubKeys[64 + 1];</span>
<span class="fc" id="L1745">        r2 ^= serpent24SubKeys[64 + 2];</span>
<span class="fc" id="L1746">        r4 ^= serpent24SubKeys[64 + 3];</span>
<span class="fc" id="L1747">        r4 ^= r3;</span>
<span class="fc" id="L1748">        r0 = r1;</span>
<span class="fc" id="L1749">        r1 &amp;= r4;</span>
<span class="fc" id="L1750">        r0 ^= r2;</span>
<span class="fc" id="L1751">        r1 ^= r3;</span>
<span class="fc" id="L1752">        r3 |= r4;</span>
<span class="fc" id="L1753">        r3 ^= r0;</span>
<span class="fc" id="L1754">        r0 ^= r4;</span>
<span class="fc" id="L1755">        r4 ^= r2;</span>
<span class="fc" id="L1756">        r2 |= r1;</span>
<span class="fc" id="L1757">        r2 ^= r0;</span>
<span class="fc" id="L1758">        r0 = ~r0;</span>
<span class="fc" id="L1759">        r0 |= r1;</span>
<span class="fc" id="L1760">        r1 ^= r4;</span>
<span class="fc" id="L1761">        r1 ^= r0;</span>
<span class="fc" id="L1762">        r4 |= r3;</span>
<span class="fc" id="L1763">        r1 ^= r4;</span>
<span class="fc" id="L1764">        r0 ^= r4;</span>
<span class="fc" id="L1765">        r1 = rotateLeft(r1, 13);</span>
<span class="fc" id="L1766">        r2 = rotateLeft(r2, 3);</span>
<span class="fc" id="L1767">        r0 = r0 ^ r1 ^ r2;</span>
<span class="fc" id="L1768">        r3 = r3 ^ r2 ^ (r1 &lt;&lt; 3);</span>
<span class="fc" id="L1769">        r0 = rotateLeft(r0, 1);</span>
<span class="fc" id="L1770">        r3 = rotateLeft(r3, 7);</span>
<span class="fc" id="L1771">        r1 = r1 ^ r0 ^ r3;</span>
<span class="fc" id="L1772">        r2 = r2 ^ r3 ^ (r0 &lt;&lt; 7);</span>
<span class="fc" id="L1773">        r1 = rotateLeft(r1, 5);</span>
<span class="fc" id="L1774">        r2 = rotateLeft(r2, 22);</span>
<span class="fc" id="L1775">        r1 ^= serpent24SubKeys[68];</span>
<span class="fc" id="L1776">        r0 ^= serpent24SubKeys[68 + 1];</span>
<span class="fc" id="L1777">        r2 ^= serpent24SubKeys[68 + 2];</span>
<span class="fc" id="L1778">        r3 ^= serpent24SubKeys[68 + 3];</span>
<span class="fc" id="L1779">        r1 = ~r1;</span>
<span class="fc" id="L1780">        r2 = ~r2;</span>
<span class="fc" id="L1781">        r4 = r1;</span>
<span class="fc" id="L1782">        r1 &amp;= r0;</span>
<span class="fc" id="L1783">        r2 ^= r1;</span>
<span class="fc" id="L1784">        r1 |= r3;</span>
<span class="fc" id="L1785">        r3 ^= r2;</span>
<span class="fc" id="L1786">        r0 ^= r1;</span>
<span class="fc" id="L1787">        r1 ^= r4;</span>
<span class="fc" id="L1788">        r4 |= r0;</span>
<span class="fc" id="L1789">        r0 ^= r3;</span>
<span class="fc" id="L1790">        r2 |= r1;</span>
<span class="fc" id="L1791">        r2 &amp;= r4;</span>
<span class="fc" id="L1792">        r1 ^= r0;</span>
<span class="fc" id="L1793">        r0 &amp;= r2;</span>
<span class="fc" id="L1794">        r0 ^= r1;</span>
<span class="fc" id="L1795">        r1 &amp;= r2;</span>
<span class="fc" id="L1796">        r1 ^= r4;</span>
<span class="fc" id="L1797">        r2 = rotateLeft(r2, 13);</span>
<span class="fc" id="L1798">        r3 = rotateLeft(r3, 3);</span>
<span class="fc" id="L1799">        r1 = r1 ^ r2 ^ r3;</span>
<span class="fc" id="L1800">        r0 = r0 ^ r3 ^ (r2 &lt;&lt; 3);</span>
<span class="fc" id="L1801">        r1 = rotateLeft(r1, 1);</span>
<span class="fc" id="L1802">        r0 = rotateLeft(r0, 7);</span>
<span class="fc" id="L1803">        r2 = r2 ^ r1 ^ r0;</span>
<span class="fc" id="L1804">        r3 = r3 ^ r0 ^ (r1 &lt;&lt; 7);</span>
<span class="fc" id="L1805">        r2 = rotateLeft(r2, 5);</span>
<span class="fc" id="L1806">        r3 = rotateLeft(r3, 22);</span>
<span class="fc" id="L1807">        fsmR1 = r2;</span>
<span class="fc" id="L1808">        lfsr4 = r1;</span>
<span class="fc" id="L1809">        fsmR2 = r3;</span>
<span class="fc" id="L1810">        lfsr5 = r0;</span>
<span class="fc" id="L1811">        r2 ^= serpent24SubKeys[72];</span>
<span class="fc" id="L1812">        r1 ^= serpent24SubKeys[72 + 1];</span>
<span class="fc" id="L1813">        r3 ^= serpent24SubKeys[72 + 2];</span>
<span class="fc" id="L1814">        r0 ^= serpent24SubKeys[72 + 3];</span>
<span class="fc" id="L1815">        r4 = r2;</span>
<span class="fc" id="L1816">        r2 &amp;= r3;</span>
<span class="fc" id="L1817">        r2 ^= r0;</span>
<span class="fc" id="L1818">        r3 ^= r1;</span>
<span class="fc" id="L1819">        r3 ^= r2;</span>
<span class="fc" id="L1820">        r0 |= r4;</span>
<span class="fc" id="L1821">        r0 ^= r1;</span>
<span class="fc" id="L1822">        r4 ^= r3;</span>
<span class="fc" id="L1823">        r1 = r0;</span>
<span class="fc" id="L1824">        r0 |= r4;</span>
<span class="fc" id="L1825">        r0 ^= r2;</span>
<span class="fc" id="L1826">        r2 &amp;= r1;</span>
<span class="fc" id="L1827">        r4 ^= r2;</span>
<span class="fc" id="L1828">        r1 ^= r0;</span>
<span class="fc" id="L1829">        r1 ^= r4;</span>
<span class="fc" id="L1830">        r4 = ~r4;</span>
<span class="fc" id="L1831">        r3 = rotateLeft(r3, 13);</span>
<span class="fc" id="L1832">        r1 = rotateLeft(r1, 3);</span>
<span class="fc" id="L1833">        r0 = r0 ^ r3 ^ r1;</span>
<span class="fc" id="L1834">        r4 = r4 ^ r1 ^ (r3 &lt;&lt; 3);</span>
<span class="fc" id="L1835">        r0 = rotateLeft(r0, 1);</span>
<span class="fc" id="L1836">        r4 = rotateLeft(r4, 7);</span>
<span class="fc" id="L1837">        r3 = r3 ^ r0 ^ r4;</span>
<span class="fc" id="L1838">        r1 = r1 ^ r4 ^ (r0 &lt;&lt; 7);</span>
<span class="fc" id="L1839">        r3 = rotateLeft(r3, 5);</span>
<span class="fc" id="L1840">        r1 = rotateLeft(r1, 22);</span>
<span class="fc" id="L1841">        r3 ^= serpent24SubKeys[76];</span>
<span class="fc" id="L1842">        r0 ^= serpent24SubKeys[76 + 1];</span>
<span class="fc" id="L1843">        r1 ^= serpent24SubKeys[76 + 2];</span>
<span class="fc" id="L1844">        r4 ^= serpent24SubKeys[76 + 3];</span>
<span class="fc" id="L1845">        r2 = r3;</span>
<span class="fc" id="L1846">        r3 |= r4;</span>
<span class="fc" id="L1847">        r4 ^= r0;</span>
<span class="fc" id="L1848">        r0 &amp;= r2;</span>
<span class="fc" id="L1849">        r2 ^= r1;</span>
<span class="fc" id="L1850">        r1 ^= r4;</span>
<span class="fc" id="L1851">        r4 &amp;= r3;</span>
<span class="fc" id="L1852">        r2 |= r0;</span>
<span class="fc" id="L1853">        r4 ^= r2;</span>
<span class="fc" id="L1854">        r3 ^= r0;</span>
<span class="fc" id="L1855">        r2 &amp;= r3;</span>
<span class="fc" id="L1856">        r0 ^= r4;</span>
<span class="fc" id="L1857">        r2 ^= r1;</span>
<span class="fc" id="L1858">        r0 |= r3;</span>
<span class="fc" id="L1859">        r0 ^= r1;</span>
<span class="fc" id="L1860">        r3 ^= r4;</span>
<span class="fc" id="L1861">        r1 = r0;</span>
<span class="fc" id="L1862">        r0 |= r4;</span>
<span class="fc" id="L1863">        r0 ^= r3;</span>
<span class="fc" id="L1864">        r0 = rotateLeft(r0, 13);</span>
<span class="fc" id="L1865">        r4 = rotateLeft(r4, 3);</span>
<span class="fc" id="L1866">        r1 = r1 ^ r0 ^ r4;</span>
<span class="fc" id="L1867">        r2 = r2 ^ r4 ^ (r0 &lt;&lt; 3);</span>
<span class="fc" id="L1868">        r1 = rotateLeft(r1, 1);</span>
<span class="fc" id="L1869">        r2 = rotateLeft(r2, 7);</span>
<span class="fc" id="L1870">        r0 = r0 ^ r1 ^ r2;</span>
<span class="fc" id="L1871">        r4 = r4 ^ r2 ^ (r1 &lt;&lt; 7);</span>
<span class="fc" id="L1872">        r0 = rotateLeft(r0, 5);</span>
<span class="fc" id="L1873">        r4 = rotateLeft(r4, 22);</span>
<span class="fc" id="L1874">        r0 ^= serpent24SubKeys[80];</span>
<span class="fc" id="L1875">        r1 ^= serpent24SubKeys[80 + 1];</span>
<span class="fc" id="L1876">        r4 ^= serpent24SubKeys[80 + 2];</span>
<span class="fc" id="L1877">        r2 ^= serpent24SubKeys[80 + 3];</span>
<span class="fc" id="L1878">        r1 ^= r2;</span>
<span class="fc" id="L1879">        r2 = ~r2;</span>
<span class="fc" id="L1880">        r4 ^= r2;</span>
<span class="fc" id="L1881">        r2 ^= r0;</span>
<span class="fc" id="L1882">        r3 = r1;</span>
<span class="fc" id="L1883">        r1 &amp;= r2;</span>
<span class="fc" id="L1884">        r1 ^= r4;</span>
<span class="fc" id="L1885">        r3 ^= r2;</span>
<span class="fc" id="L1886">        r0 ^= r3;</span>
<span class="fc" id="L1887">        r4 &amp;= r3;</span>
<span class="fc" id="L1888">        r4 ^= r0;</span>
<span class="fc" id="L1889">        r0 &amp;= r1;</span>
<span class="fc" id="L1890">        r2 ^= r0;</span>
<span class="fc" id="L1891">        r3 |= r1;</span>
<span class="fc" id="L1892">        r3 ^= r0;</span>
<span class="fc" id="L1893">        r0 |= r2;</span>
<span class="fc" id="L1894">        r0 ^= r4;</span>
<span class="fc" id="L1895">        r4 &amp;= r2;</span>
<span class="fc" id="L1896">        r0 = ~r0;</span>
<span class="fc" id="L1897">        r3 ^= r4;</span>
<span class="fc" id="L1898">        r1 = rotateLeft(r1, 13);</span>
<span class="fc" id="L1899">        r0 = rotateLeft(r0, 3);</span>
<span class="fc" id="L1900">        r3 = r3 ^ r1 ^ r0;</span>
<span class="fc" id="L1901">        r2 = r2 ^ r0 ^ (r1 &lt;&lt; 3);</span>
<span class="fc" id="L1902">        r3 = rotateLeft(r3, 1);</span>
<span class="fc" id="L1903">        r2 = rotateLeft(r2, 7);</span>
<span class="fc" id="L1904">        r1 = r1 ^ r3 ^ r2;</span>
<span class="fc" id="L1905">        r0 = r0 ^ r2 ^ (r3 &lt;&lt; 7);</span>
<span class="fc" id="L1906">        r1 = rotateLeft(r1, 5);</span>
<span class="fc" id="L1907">        r0 = rotateLeft(r0, 22);</span>
<span class="fc" id="L1908">        r1 ^= serpent24SubKeys[84];</span>
<span class="fc" id="L1909">        r3 ^= serpent24SubKeys[84 + 1];</span>
<span class="fc" id="L1910">        r0 ^= serpent24SubKeys[84 + 2];</span>
<span class="fc" id="L1911">        r2 ^= serpent24SubKeys[84 + 3];</span>
<span class="fc" id="L1912">        r1 ^= r3;</span>
<span class="fc" id="L1913">        r3 ^= r2;</span>
<span class="fc" id="L1914">        r2 = ~r2;</span>
<span class="fc" id="L1915">        r4 = r3;</span>
<span class="fc" id="L1916">        r3 &amp;= r1;</span>
<span class="fc" id="L1917">        r0 ^= r2;</span>
<span class="fc" id="L1918">        r3 ^= r0;</span>
<span class="fc" id="L1919">        r0 |= r4;</span>
<span class="fc" id="L1920">        r4 ^= r2;</span>
<span class="fc" id="L1921">        r2 &amp;= r3;</span>
<span class="fc" id="L1922">        r2 ^= r1;</span>
<span class="fc" id="L1923">        r4 ^= r3;</span>
<span class="fc" id="L1924">        r4 ^= r0;</span>
<span class="fc" id="L1925">        r0 ^= r1;</span>
<span class="fc" id="L1926">        r1 &amp;= r2;</span>
<span class="fc" id="L1927">        r0 = ~r0;</span>
<span class="fc" id="L1928">        r1 ^= r4;</span>
<span class="fc" id="L1929">        r4 |= r2;</span>
<span class="fc" id="L1930">        r0 ^= r4;</span>
<span class="fc" id="L1931">        r3 = rotateLeft(r3, 13);</span>
<span class="fc" id="L1932">        r1 = rotateLeft(r1, 3);</span>
<span class="fc" id="L1933">        r2 = r2 ^ r3 ^ r1;</span>
<span class="fc" id="L1934">        r0 = r0 ^ r1 ^ (r3 &lt;&lt; 3);</span>
<span class="fc" id="L1935">        r2 = rotateLeft(r2, 1);</span>
<span class="fc" id="L1936">        r0 = rotateLeft(r0, 7);</span>
<span class="fc" id="L1937">        r3 = r3 ^ r2 ^ r0;</span>
<span class="fc" id="L1938">        r1 = r1 ^ r0 ^ (r2 &lt;&lt; 7);</span>
<span class="fc" id="L1939">        r3 = rotateLeft(r3, 5);</span>
<span class="fc" id="L1940">        r1 = rotateLeft(r1, 22);</span>
<span class="fc" id="L1941">        r3 ^= serpent24SubKeys[88];</span>
<span class="fc" id="L1942">        r2 ^= serpent24SubKeys[88 + 1];</span>
<span class="fc" id="L1943">        r1 ^= serpent24SubKeys[88 + 2];</span>
<span class="fc" id="L1944">        r0 ^= serpent24SubKeys[88 + 3];</span>
<span class="fc" id="L1945">        r1 = ~r1;</span>
<span class="fc" id="L1946">        r4 = r0;</span>
<span class="fc" id="L1947">        r0 &amp;= r3;</span>
<span class="fc" id="L1948">        r3 ^= r4;</span>
<span class="fc" id="L1949">        r0 ^= r1;</span>
<span class="fc" id="L1950">        r1 |= r4;</span>
<span class="fc" id="L1951">        r2 ^= r0;</span>
<span class="fc" id="L1952">        r1 ^= r3;</span>
<span class="fc" id="L1953">        r3 |= r2;</span>
<span class="fc" id="L1954">        r1 ^= r2;</span>
<span class="fc" id="L1955">        r4 ^= r3;</span>
<span class="fc" id="L1956">        r3 |= r0;</span>
<span class="fc" id="L1957">        r3 ^= r1;</span>
<span class="fc" id="L1958">        r4 ^= r0;</span>
<span class="fc" id="L1959">        r4 ^= r3;</span>
<span class="fc" id="L1960">        r0 = ~r0;</span>
<span class="fc" id="L1961">        r1 &amp;= r4;</span>
<span class="fc" id="L1962">        r1 ^= r0;</span>
<span class="fc" id="L1963">        r3 = rotateLeft(r3, 13);</span>
<span class="fc" id="L1964">        r4 = rotateLeft(r4, 3);</span>
<span class="fc" id="L1965">        r2 = r2 ^ r3 ^ r4;</span>
<span class="fc" id="L1966">        r1 = r1 ^ r4 ^ (r3 &lt;&lt; 3);</span>
<span class="fc" id="L1967">        r2 = rotateLeft(r2, 1);</span>
<span class="fc" id="L1968">        r1 = rotateLeft(r1, 7);</span>
<span class="fc" id="L1969">        r3 = r3 ^ r2 ^ r1;</span>
<span class="fc" id="L1970">        r4 = r4 ^ r1 ^ (r2 &lt;&lt; 7);</span>
<span class="fc" id="L1971">        r3 = rotateLeft(r3, 5);</span>
<span class="fc" id="L1972">        r4 = rotateLeft(r4, 22);</span>
<span class="fc" id="L1973">        r3 ^= serpent24SubKeys[92];</span>
<span class="fc" id="L1974">        r2 ^= serpent24SubKeys[92 + 1];</span>
<span class="fc" id="L1975">        r4 ^= serpent24SubKeys[92 + 2];</span>
<span class="fc" id="L1976">        r1 ^= serpent24SubKeys[92 + 3];</span>
<span class="fc" id="L1977">        r0 = r2;</span>
<span class="fc" id="L1978">        r2 |= r4;</span>
<span class="fc" id="L1979">        r2 ^= r1;</span>
<span class="fc" id="L1980">        r0 ^= r4;</span>
<span class="fc" id="L1981">        r4 ^= r2;</span>
<span class="fc" id="L1982">        r1 |= r0;</span>
<span class="fc" id="L1983">        r1 &amp;= r3;</span>
<span class="fc" id="L1984">        r0 ^= r4;</span>
<span class="fc" id="L1985">        r1 ^= r2;</span>
<span class="fc" id="L1986">        r2 |= r0;</span>
<span class="fc" id="L1987">        r2 ^= r3;</span>
<span class="fc" id="L1988">        r3 |= r0;</span>
<span class="fc" id="L1989">        r3 ^= r4;</span>
<span class="fc" id="L1990">        r2 ^= r0;</span>
<span class="fc" id="L1991">        r4 ^= r2;</span>
<span class="fc" id="L1992">        r2 &amp;= r3;</span>
<span class="fc" id="L1993">        r2 ^= r0;</span>
<span class="fc" id="L1994">        r4 = ~r4;</span>
<span class="fc" id="L1995">        r4 |= r3;</span>
<span class="fc" id="L1996">        r0 ^= r4;</span>
<span class="fc" id="L1997">        r0 = rotateLeft(r0, 13);</span>
<span class="fc" id="L1998">        r2 = rotateLeft(r2, 3);</span>
<span class="fc" id="L1999">        r1 = r1 ^ r0 ^ r2;</span>
<span class="fc" id="L2000">        r3 = r3 ^ r2 ^ (r0 &lt;&lt; 3);</span>
<span class="fc" id="L2001">        r1 = rotateLeft(r1, 1);</span>
<span class="fc" id="L2002">        r3 = rotateLeft(r3, 7);</span>
<span class="fc" id="L2003">        r0 = r0 ^ r1 ^ r3;</span>
<span class="fc" id="L2004">        r2 = r2 ^ r3 ^ (r1 &lt;&lt; 7);</span>
<span class="fc" id="L2005">        r0 = rotateLeft(r0, 5);</span>
<span class="fc" id="L2006">        r2 = rotateLeft(r2, 22);</span>
<span class="fc" id="L2007">        r0 ^= serpent24SubKeys[96];</span>
<span class="fc" id="L2008">        r1 ^= serpent24SubKeys[96 + 1];</span>
<span class="fc" id="L2009">        r2 ^= serpent24SubKeys[96 + 2];</span>
<span class="fc" id="L2010">        r3 ^= serpent24SubKeys[96 + 3];</span>
<span class="fc" id="L2011">        lfsr3 = r0;</span>
<span class="fc" id="L2012">        lfsr2 = r1;</span>
<span class="fc" id="L2013">        lfsr1 = r2;</span>
<span class="fc" id="L2014">        lfsr0 = r3;</span>
<span class="fc" id="L2015">    }</span>

    /**
     * mulAlpha[] is used to multiply a word by alpha; mulAlpha[x]
     * is equal to x * alpha^4.
     */
<span class="fc" id="L2021">    private static final int[] MUL_ALPHA = new int[256];</span>

    /**
     * divAlpha[] is used to divide a word by alpha; divAlpha[x]
     * is equal to x / alpha.
     */
<span class="fc" id="L2027">    private static final int[] DIV_ALPHA = new int[256];</span>

    static {
        /*
         * We first build exponential and logarithm tables
         * relatively to beta in F_{2^8}. We set log(0x00) = 0xFF
         * conventionaly, but this is actually not used in our
         * computations.
         */
<span class="fc" id="L2036">        final int[] expb = new int[256];</span>
<span class="fc bfc" id="L2037" title="All 2 branches covered.">        for (int i = 0, x = 0x01; i &lt; 0xFF; i++) {</span>
<span class="fc" id="L2038">            expb[i] = x;</span>
<span class="fc" id="L2039">            x &lt;&lt;= 1;</span>
<span class="fc bfc" id="L2040" title="All 2 branches covered.">            if (x &gt; 0xFF) {</span>
<span class="fc" id="L2041">                x ^= 0x1A9;</span>
            }
        }
<span class="fc" id="L2044">        expb[0xFF] = 0x00;</span>
<span class="fc" id="L2045">        final int[] logb = new int[256];</span>
<span class="fc bfc" id="L2046" title="All 2 branches covered.">        for (int i = 0; i &lt; 0x100; i++) {</span>
<span class="fc" id="L2047">            logb[expb[i]] = i;</span>
        }

        /*
         * We now compute mulAlpha[] and divAlpha[]. For all
         * x != 0, we work with invertible numbers, which are
         * as such powers of beta. Multiplication (in F_{2^8})
         * is then implemented as integer addition modulo 255,
         * over the exponents computed by the logb[] table.
         *
         * We have the following equations:
         * alpha^4 = beta^23 * alpha^3 + beta^245 * alpha^2
         *           + beta^48 * alpha + beta^239
         * 1/alpha = beta^16 * alpha^3 + beta^39 * alpha^2
         *           + beta^6 * alpha + beta^64
         */
<span class="fc" id="L2063">        MUL_ALPHA[0x00] = 0x00000000;</span>
<span class="fc" id="L2064">        DIV_ALPHA[0x00] = 0x00000000;</span>
<span class="fc bfc" id="L2065" title="All 2 branches covered.">        for (int x = 1; x &lt; 0x100; x++) {</span>
<span class="fc" id="L2066">            final int ex = logb[x];</span>
<span class="fc" id="L2067">            MUL_ALPHA[x] = (expb[(ex + 23) % 255] &lt;&lt; 24)</span>
                    | (expb[(ex + 245) % 255] &lt;&lt; 16)
                    | (expb[(ex + 48) % 255] &lt;&lt; 8)
                    | expb[(ex + 239) % 255];
<span class="fc" id="L2071">            DIV_ALPHA[x] = (expb[(ex + 16) % 255] &lt;&lt; 24)</span>
                    | (expb[(ex + 39) % 255] &lt;&lt; 16)
                    | (expb[(ex + 6) % 255] &lt;&lt; 8)
                    | expb[(ex + 64) % 255];
        }
<span class="fc" id="L2076">    }</span>

    /**
     * Produce 80 bytes of output stream into the provided buffer.
     *
     * @param buf   the output buffer
     * @param off   the output offset
     */
    @SuppressWarnings(&quot;checkstyle:MethodLength&quot;)
    private void makeStreamBlock(final byte[] buf, final int off) {
<span class="fc" id="L2086">        int s0 = lfsr0;</span>
<span class="fc" id="L2087">        int s1 = lfsr1;</span>
<span class="fc" id="L2088">        int s2 = lfsr2;</span>
<span class="fc" id="L2089">        int s3 = lfsr3;</span>
<span class="fc" id="L2090">        int s4 = lfsr4;</span>
<span class="fc" id="L2091">        int s5 = lfsr5;</span>
<span class="fc" id="L2092">        int s6 = lfsr6;</span>
<span class="fc" id="L2093">        int s7 = lfsr7;</span>
<span class="fc" id="L2094">        int s8 = lfsr8;</span>
<span class="fc" id="L2095">        int s9 = lfsr9;</span>
<span class="fc" id="L2096">        int r1 = fsmR1;</span>
<span class="fc" id="L2097">        int r2 = fsmR2;</span>

<span class="fc" id="L2099">        int tt = r1;</span>
<span class="fc bfc" id="L2100" title="All 2 branches covered.">        r1 = r2 + (s1 ^ ((r1 &amp; 0x01) != 0 ? s8 : 0));</span>
<span class="fc" id="L2101">        r2 = rotateLeft(tt * 0x54655307, 7);</span>
<span class="fc" id="L2102">        int v0 = s0;</span>
<span class="fc" id="L2103">        s0 = ((s0 &lt;&lt; 8) ^ MUL_ALPHA[s0 &gt;&gt;&gt; 24])</span>
                ^ ((s3 &gt;&gt;&gt; 8) ^ DIV_ALPHA[s3 &amp; 0xFF]) ^ s9;
<span class="fc" id="L2105">        int f0 = (s9 + r1) ^ r2;</span>

<span class="fc" id="L2107">        tt = r1;</span>
<span class="fc bfc" id="L2108" title="All 2 branches covered.">        r1 = r2 + (s2 ^ ((r1 &amp; 0x01) != 0 ? s9 : 0));</span>
<span class="fc" id="L2109">        r2 = rotateLeft(tt * 0x54655307, 7);</span>
<span class="fc" id="L2110">        int v1 = s1;</span>
<span class="fc" id="L2111">        s1 = ((s1 &lt;&lt; 8) ^ MUL_ALPHA[s1 &gt;&gt;&gt; 24])</span>
                ^ ((s4 &gt;&gt;&gt; 8) ^ DIV_ALPHA[s4 &amp; 0xFF]) ^ s0;
<span class="fc" id="L2113">        int f1 = (s0 + r1) ^ r2;</span>

<span class="fc" id="L2115">        tt = r1;</span>
<span class="fc bfc" id="L2116" title="All 2 branches covered.">        r1 = r2 + (s3 ^ ((r1 &amp; 0x01) != 0 ? s0 : 0));</span>
<span class="fc" id="L2117">        r2 = rotateLeft(tt * 0x54655307, 7);</span>
<span class="fc" id="L2118">        int v2 = s2;</span>
<span class="fc" id="L2119">        s2 = ((s2 &lt;&lt; 8) ^ MUL_ALPHA[s2 &gt;&gt;&gt; 24])</span>
                ^ ((s5 &gt;&gt;&gt; 8) ^ DIV_ALPHA[s5 &amp; 0xFF]) ^ s1;
<span class="fc" id="L2121">        int f2 = (s1 + r1) ^ r2;</span>

<span class="fc" id="L2123">        tt = r1;</span>
<span class="fc bfc" id="L2124" title="All 2 branches covered.">        r1 = r2 + (s4 ^ ((r1 &amp; 0x01) != 0 ? s1 : 0));</span>
<span class="fc" id="L2125">        r2 = rotateLeft(tt * 0x54655307, 7);</span>
<span class="fc" id="L2126">        int v3 = s3;</span>
<span class="fc" id="L2127">        s3 = ((s3 &lt;&lt; 8) ^ MUL_ALPHA[s3 &gt;&gt;&gt; 24])</span>
                ^ ((s6 &gt;&gt;&gt; 8) ^ DIV_ALPHA[s6 &amp; 0xFF]) ^ s2;
<span class="fc" id="L2129">        int f3 = (s2 + r1) ^ r2;</span>

        /*
         * Apply the third S-box (number 2) on (f3, f2, f1, f0).
         */
<span class="fc" id="L2134">        int f4 = f0;</span>
<span class="fc" id="L2135">        f0 &amp;= f2;</span>
<span class="fc" id="L2136">        f0 ^= f3;</span>
<span class="fc" id="L2137">        f2 ^= f1;</span>
<span class="fc" id="L2138">        f2 ^= f0;</span>
<span class="fc" id="L2139">        f3 |= f4;</span>
<span class="fc" id="L2140">        f3 ^= f1;</span>
<span class="fc" id="L2141">        f4 ^= f2;</span>
<span class="fc" id="L2142">        f1 = f3;</span>
<span class="fc" id="L2143">        f3 |= f4;</span>
<span class="fc" id="L2144">        f3 ^= f0;</span>
<span class="fc" id="L2145">        f0 &amp;= f1;</span>
<span class="fc" id="L2146">        f4 ^= f0;</span>
<span class="fc" id="L2147">        f1 ^= f3;</span>
<span class="fc" id="L2148">        f1 ^= f4;</span>
<span class="fc" id="L2149">        f4 = ~f4;</span>

        /*
         * S-box result is in (f2, f3, f1, f4).
         */
<span class="fc" id="L2154">        encode32le(f2 ^ v0, buf, off);</span>
<span class="fc" id="L2155">        encode32le(f3 ^ v1, buf, off + 4);</span>
<span class="fc" id="L2156">        encode32le(f1 ^ v2, buf, off + 8);</span>
<span class="fc" id="L2157">        encode32le(f4 ^ v3, buf, off + 12);</span>

<span class="fc" id="L2159">        tt = r1;</span>
<span class="fc bfc" id="L2160" title="All 2 branches covered.">        r1 = r2 + (s5 ^ ((r1 &amp; 0x01) != 0 ? s2 : 0));</span>
<span class="fc" id="L2161">        r2 = rotateLeft(tt * 0x54655307, 7);</span>
<span class="fc" id="L2162">        v0 = s4;</span>
<span class="fc" id="L2163">        s4 = ((s4 &lt;&lt; 8) ^ MUL_ALPHA[s4 &gt;&gt;&gt; 24])</span>
                ^ ((s7 &gt;&gt;&gt; 8) ^ DIV_ALPHA[s7 &amp; 0xFF]) ^ s3;
<span class="fc" id="L2165">        f0 = (s3 + r1) ^ r2;</span>

<span class="fc" id="L2167">        tt = r1;</span>
<span class="fc bfc" id="L2168" title="All 2 branches covered.">        r1 = r2 + (s6 ^ ((r1 &amp; 0x01) != 0 ? s3 : 0));</span>
<span class="fc" id="L2169">        r2 = rotateLeft(tt * 0x54655307, 7);</span>
<span class="fc" id="L2170">        v1 = s5;</span>
<span class="fc" id="L2171">        s5 = ((s5 &lt;&lt; 8) ^ MUL_ALPHA[s5 &gt;&gt;&gt; 24])</span>
                ^ ((s8 &gt;&gt;&gt; 8) ^ DIV_ALPHA[s8 &amp; 0xFF]) ^ s4;
<span class="fc" id="L2173">        f1 = (s4 + r1) ^ r2;</span>

<span class="fc" id="L2175">        tt = r1;</span>
<span class="fc bfc" id="L2176" title="All 2 branches covered.">        r1 = r2 + (s7 ^ ((r1 &amp; 0x01) != 0 ? s4 : 0));</span>
<span class="fc" id="L2177">        r2 = rotateLeft(tt * 0x54655307, 7);</span>
<span class="fc" id="L2178">        v2 = s6;</span>
<span class="fc" id="L2179">        s6 = ((s6 &lt;&lt; 8) ^ MUL_ALPHA[s6 &gt;&gt;&gt; 24])</span>
                ^ ((s9 &gt;&gt;&gt; 8) ^ DIV_ALPHA[s9 &amp; 0xFF]) ^ s5;
<span class="fc" id="L2181">        f2 = (s5 + r1) ^ r2;</span>

<span class="fc" id="L2183">        tt = r1;</span>
<span class="fc bfc" id="L2184" title="All 2 branches covered.">        r1 = r2 + (s8 ^ ((r1 &amp; 0x01) != 0 ? s5 : 0));</span>
<span class="fc" id="L2185">        r2 = rotateLeft(tt * 0x54655307, 7);</span>
<span class="fc" id="L2186">        v3 = s7;</span>
<span class="fc" id="L2187">        s7 = ((s7 &lt;&lt; 8) ^ MUL_ALPHA[s7 &gt;&gt;&gt; 24])</span>
                ^ ((s0 &gt;&gt;&gt; 8) ^ DIV_ALPHA[s0 &amp; 0xFF]) ^ s6;
<span class="fc" id="L2189">        f3 = (s6 + r1) ^ r2;</span>

        /*
         * Apply the third S-box (number 2) on (f3, f2, f1, f0).
         */
<span class="fc" id="L2194">        f4 = f0;</span>
<span class="fc" id="L2195">        f0 &amp;= f2;</span>
<span class="fc" id="L2196">        f0 ^= f3;</span>
<span class="fc" id="L2197">        f2 ^= f1;</span>
<span class="fc" id="L2198">        f2 ^= f0;</span>
<span class="fc" id="L2199">        f3 |= f4;</span>
<span class="fc" id="L2200">        f3 ^= f1;</span>
<span class="fc" id="L2201">        f4 ^= f2;</span>
<span class="fc" id="L2202">        f1 = f3;</span>
<span class="fc" id="L2203">        f3 |= f4;</span>
<span class="fc" id="L2204">        f3 ^= f0;</span>
<span class="fc" id="L2205">        f0 &amp;= f1;</span>
<span class="fc" id="L2206">        f4 ^= f0;</span>
<span class="fc" id="L2207">        f1 ^= f3;</span>
<span class="fc" id="L2208">        f1 ^= f4;</span>
<span class="fc" id="L2209">        f4 = ~f4;</span>

        /*
         * S-box result is in (f2, f3, f1, f4).
         */
<span class="fc" id="L2214">        encode32le(f2 ^ v0, buf, off + 16);</span>
<span class="fc" id="L2215">        encode32le(f3 ^ v1, buf, off + 20);</span>
<span class="fc" id="L2216">        encode32le(f1 ^ v2, buf, off + 24);</span>
<span class="fc" id="L2217">        encode32le(f4 ^ v3, buf, off + 28);</span>

<span class="fc" id="L2219">        tt = r1;</span>
<span class="fc bfc" id="L2220" title="All 2 branches covered.">        r1 = r2 + (s9 ^ ((r1 &amp; 0x01) != 0 ? s6 : 0));</span>
<span class="fc" id="L2221">        r2 = rotateLeft(tt * 0x54655307, 7);</span>
<span class="fc" id="L2222">        v0 = s8;</span>
<span class="fc" id="L2223">        s8 = ((s8 &lt;&lt; 8) ^ MUL_ALPHA[s8 &gt;&gt;&gt; 24])</span>
                ^ ((s1 &gt;&gt;&gt; 8) ^ DIV_ALPHA[s1 &amp; 0xFF]) ^ s7;
<span class="fc" id="L2225">        f0 = (s7 + r1) ^ r2;</span>

<span class="fc" id="L2227">        tt = r1;</span>
<span class="fc bfc" id="L2228" title="All 2 branches covered.">        r1 = r2 + (s0 ^ ((r1 &amp; 0x01) != 0 ? s7 : 0));</span>
<span class="fc" id="L2229">        r2 = rotateLeft(tt * 0x54655307, 7);</span>
<span class="fc" id="L2230">        v1 = s9;</span>
<span class="fc" id="L2231">        s9 = ((s9 &lt;&lt; 8) ^ MUL_ALPHA[s9 &gt;&gt;&gt; 24])</span>
                ^ ((s2 &gt;&gt;&gt; 8) ^ DIV_ALPHA[s2 &amp; 0xFF]) ^ s8;
<span class="fc" id="L2233">        f1 = (s8 + r1) ^ r2;</span>

<span class="fc" id="L2235">        tt = r1;</span>
<span class="fc bfc" id="L2236" title="All 2 branches covered.">        r1 = r2 + (s1 ^ ((r1 &amp; 0x01) != 0 ? s8 : 0));</span>
<span class="fc" id="L2237">        r2 = rotateLeft(tt * 0x54655307, 7);</span>
<span class="fc" id="L2238">        v2 = s0;</span>
<span class="fc" id="L2239">        s0 = ((s0 &lt;&lt; 8) ^ MUL_ALPHA[s0 &gt;&gt;&gt; 24])</span>
                ^ ((s3 &gt;&gt;&gt; 8) ^ DIV_ALPHA[s3 &amp; 0xFF]) ^ s9;
<span class="fc" id="L2241">        f2 = (s9 + r1) ^ r2;</span>

<span class="fc" id="L2243">        tt = r1;</span>
<span class="fc bfc" id="L2244" title="All 2 branches covered.">        r1 = r2 + (s2 ^ ((r1 &amp; 0x01) != 0 ? s9 : 0));</span>
<span class="fc" id="L2245">        r2 = rotateLeft(tt * 0x54655307, 7);</span>
<span class="fc" id="L2246">        v3 = s1;</span>
<span class="fc" id="L2247">        s1 = ((s1 &lt;&lt; 8) ^ MUL_ALPHA[s1 &gt;&gt;&gt; 24])</span>
                ^ ((s4 &gt;&gt;&gt; 8) ^ DIV_ALPHA[s4 &amp; 0xFF]) ^ s0;
<span class="fc" id="L2249">        f3 = (s0 + r1) ^ r2;</span>

        /*
         * Apply the third S-box (number 2) on (f3, f2, f1, f0).
         */
<span class="fc" id="L2254">        f4 = f0;</span>
<span class="fc" id="L2255">        f0 &amp;= f2;</span>
<span class="fc" id="L2256">        f0 ^= f3;</span>
<span class="fc" id="L2257">        f2 ^= f1;</span>
<span class="fc" id="L2258">        f2 ^= f0;</span>
<span class="fc" id="L2259">        f3 |= f4;</span>
<span class="fc" id="L2260">        f3 ^= f1;</span>
<span class="fc" id="L2261">        f4 ^= f2;</span>
<span class="fc" id="L2262">        f1 = f3;</span>
<span class="fc" id="L2263">        f3 |= f4;</span>
<span class="fc" id="L2264">        f3 ^= f0;</span>
<span class="fc" id="L2265">        f0 &amp;= f1;</span>
<span class="fc" id="L2266">        f4 ^= f0;</span>
<span class="fc" id="L2267">        f1 ^= f3;</span>
<span class="fc" id="L2268">        f1 ^= f4;</span>
<span class="fc" id="L2269">        f4 = ~f4;</span>

        /*
         * S-box result is in (f2, f3, f1, f4).
         */
<span class="fc" id="L2274">        encode32le(f2 ^ v0, buf, off + 32);</span>
<span class="fc" id="L2275">        encode32le(f3 ^ v1, buf, off + 36);</span>
<span class="fc" id="L2276">        encode32le(f1 ^ v2, buf, off + 40);</span>
<span class="fc" id="L2277">        encode32le(f4 ^ v3, buf, off + 44);</span>

<span class="fc" id="L2279">        tt = r1;</span>
<span class="fc bfc" id="L2280" title="All 2 branches covered.">        r1 = r2 + (s3 ^ ((r1 &amp; 0x01) != 0 ? s0 : 0));</span>
<span class="fc" id="L2281">        r2 = rotateLeft(tt * 0x54655307, 7);</span>
<span class="fc" id="L2282">        v0 = s2;</span>
<span class="fc" id="L2283">        s2 = ((s2 &lt;&lt; 8) ^ MUL_ALPHA[s2 &gt;&gt;&gt; 24])</span>
                ^ ((s5 &gt;&gt;&gt; 8) ^ DIV_ALPHA[s5 &amp; 0xFF]) ^ s1;
<span class="fc" id="L2285">        f0 = (s1 + r1) ^ r2;</span>

<span class="fc" id="L2287">        tt = r1;</span>
<span class="fc bfc" id="L2288" title="All 2 branches covered.">        r1 = r2 + (s4 ^ ((r1 &amp; 0x01) != 0 ? s1 : 0));</span>
<span class="fc" id="L2289">        r2 = rotateLeft(tt * 0x54655307, 7);</span>
<span class="fc" id="L2290">        v1 = s3;</span>
<span class="fc" id="L2291">        s3 = ((s3 &lt;&lt; 8) ^ MUL_ALPHA[s3 &gt;&gt;&gt; 24])</span>
                ^ ((s6 &gt;&gt;&gt; 8) ^ DIV_ALPHA[s6 &amp; 0xFF]) ^ s2;
<span class="fc" id="L2293">        f1 = (s2 + r1) ^ r2;</span>

<span class="fc" id="L2295">        tt = r1;</span>
<span class="fc bfc" id="L2296" title="All 2 branches covered.">        r1 = r2 + (s5 ^ ((r1 &amp; 0x01) != 0 ? s2 : 0));</span>
<span class="fc" id="L2297">        r2 = rotateLeft(tt * 0x54655307, 7);</span>
<span class="fc" id="L2298">        v2 = s4;</span>
<span class="fc" id="L2299">        s4 = ((s4 &lt;&lt; 8) ^ MUL_ALPHA[s4 &gt;&gt;&gt; 24])</span>
                ^ ((s7 &gt;&gt;&gt; 8) ^ DIV_ALPHA[s7 &amp; 0xFF]) ^ s3;
<span class="fc" id="L2301">        f2 = (s3 + r1) ^ r2;</span>

<span class="fc" id="L2303">        tt = r1;</span>
<span class="fc bfc" id="L2304" title="All 2 branches covered.">        r1 = r2 + (s6 ^ ((r1 &amp; 0x01) != 0 ? s3 : 0));</span>
<span class="fc" id="L2305">        r2 = rotateLeft(tt * 0x54655307, 7);</span>
<span class="fc" id="L2306">        v3 = s5;</span>
<span class="fc" id="L2307">        s5 = ((s5 &lt;&lt; 8) ^ MUL_ALPHA[s5 &gt;&gt;&gt; 24])</span>
                ^ ((s8 &gt;&gt;&gt; 8) ^ DIV_ALPHA[s8 &amp; 0xFF]) ^ s4;
<span class="fc" id="L2309">        f3 = (s4 + r1) ^ r2;</span>

        /*
         * Apply the third S-box (number 2) on (f3, f2, f1, f0).
         */
<span class="fc" id="L2314">        f4 = f0;</span>
<span class="fc" id="L2315">        f0 &amp;= f2;</span>
<span class="fc" id="L2316">        f0 ^= f3;</span>
<span class="fc" id="L2317">        f2 ^= f1;</span>
<span class="fc" id="L2318">        f2 ^= f0;</span>
<span class="fc" id="L2319">        f3 |= f4;</span>
<span class="fc" id="L2320">        f3 ^= f1;</span>
<span class="fc" id="L2321">        f4 ^= f2;</span>
<span class="fc" id="L2322">        f1 = f3;</span>
<span class="fc" id="L2323">        f3 |= f4;</span>
<span class="fc" id="L2324">        f3 ^= f0;</span>
<span class="fc" id="L2325">        f0 &amp;= f1;</span>
<span class="fc" id="L2326">        f4 ^= f0;</span>
<span class="fc" id="L2327">        f1 ^= f3;</span>
<span class="fc" id="L2328">        f1 ^= f4;</span>
<span class="fc" id="L2329">        f4 = ~f4;</span>

        /*
         * S-box result is in (f2, f3, f1, f4).
         */
<span class="fc" id="L2334">        encode32le(f2 ^ v0, buf, off + 48);</span>
<span class="fc" id="L2335">        encode32le(f3 ^ v1, buf, off + 52);</span>
<span class="fc" id="L2336">        encode32le(f1 ^ v2, buf, off + 56);</span>
<span class="fc" id="L2337">        encode32le(f4 ^ v3, buf, off + 60);</span>

<span class="fc" id="L2339">        tt = r1;</span>
<span class="fc bfc" id="L2340" title="All 2 branches covered.">        r1 = r2 + (s7 ^ ((r1 &amp; 0x01) != 0 ? s4 : 0));</span>
<span class="fc" id="L2341">        r2 = rotateLeft(tt * 0x54655307, 7);</span>
<span class="fc" id="L2342">        v0 = s6;</span>
<span class="fc" id="L2343">        s6 = ((s6 &lt;&lt; 8) ^ MUL_ALPHA[s6 &gt;&gt;&gt; 24])</span>
                ^ ((s9 &gt;&gt;&gt; 8) ^ DIV_ALPHA[s9 &amp; 0xFF]) ^ s5;
<span class="fc" id="L2345">        f0 = (s5 + r1) ^ r2;</span>

<span class="fc" id="L2347">        tt = r1;</span>
<span class="fc bfc" id="L2348" title="All 2 branches covered.">        r1 = r2 + (s8 ^ ((r1 &amp; 0x01) != 0 ? s5 : 0));</span>
<span class="fc" id="L2349">        r2 = rotateLeft(tt * 0x54655307, 7);</span>
<span class="fc" id="L2350">        v1 = s7;</span>
<span class="fc" id="L2351">        s7 = ((s7 &lt;&lt; 8) ^ MUL_ALPHA[s7 &gt;&gt;&gt; 24])</span>
                ^ ((s0 &gt;&gt;&gt; 8) ^ DIV_ALPHA[s0 &amp; 0xFF]) ^ s6;
<span class="fc" id="L2353">        f1 = (s6 + r1) ^ r2;</span>

<span class="fc" id="L2355">        tt = r1;</span>
<span class="fc bfc" id="L2356" title="All 2 branches covered.">        r1 = r2 + (s9 ^ ((r1 &amp; 0x01) != 0 ? s6 : 0));</span>
<span class="fc" id="L2357">        r2 = rotateLeft(tt * 0x54655307, 7);</span>
<span class="fc" id="L2358">        v2 = s8;</span>
<span class="fc" id="L2359">        s8 = ((s8 &lt;&lt; 8) ^ MUL_ALPHA[s8 &gt;&gt;&gt; 24])</span>
                ^ ((s1 &gt;&gt;&gt; 8) ^ DIV_ALPHA[s1 &amp; 0xFF]) ^ s7;
<span class="fc" id="L2361">        f2 = (s7 + r1) ^ r2;</span>

<span class="fc" id="L2363">        tt = r1;</span>
<span class="fc bfc" id="L2364" title="All 2 branches covered.">        r1 = r2 + (s0 ^ ((r1 &amp; 0x01) != 0 ? s7 : 0));</span>
<span class="fc" id="L2365">        r2 = rotateLeft(tt * 0x54655307, 7);</span>
<span class="fc" id="L2366">        v3 = s9;</span>
<span class="fc" id="L2367">        s9 = ((s9 &lt;&lt; 8) ^ MUL_ALPHA[s9 &gt;&gt;&gt; 24])</span>
                ^ ((s2 &gt;&gt;&gt; 8) ^ DIV_ALPHA[s2 &amp; 0xFF]) ^ s8;
<span class="fc" id="L2369">        f3 = (s8 + r1) ^ r2;</span>

        /*
         * Apply the third S-box (number 2) on (f3, f2, f1, f0).
         */
<span class="fc" id="L2374">        f4 = f0;</span>
<span class="fc" id="L2375">        f0 &amp;= f2;</span>
<span class="fc" id="L2376">        f0 ^= f3;</span>
<span class="fc" id="L2377">        f2 ^= f1;</span>
<span class="fc" id="L2378">        f2 ^= f0;</span>
<span class="fc" id="L2379">        f3 |= f4;</span>
<span class="fc" id="L2380">        f3 ^= f1;</span>
<span class="fc" id="L2381">        f4 ^= f2;</span>
<span class="fc" id="L2382">        f1 = f3;</span>
<span class="fc" id="L2383">        f3 |= f4;</span>
<span class="fc" id="L2384">        f3 ^= f0;</span>
<span class="fc" id="L2385">        f0 &amp;= f1;</span>
<span class="fc" id="L2386">        f4 ^= f0;</span>
<span class="fc" id="L2387">        f1 ^= f3;</span>
<span class="fc" id="L2388">        f1 ^= f4;</span>
<span class="fc" id="L2389">        f4 = ~f4;</span>

        /*
         * S-box result is in (f2, f3, f1, f4).
         */
<span class="fc" id="L2394">        encode32le(f2 ^ v0, buf, off + 64);</span>
<span class="fc" id="L2395">        encode32le(f3 ^ v1, buf, off + 68);</span>
<span class="fc" id="L2396">        encode32le(f1 ^ v2, buf, off + 72);</span>
<span class="fc" id="L2397">        encode32le(f4 ^ v3, buf, off + 76);</span>

<span class="fc" id="L2399">        lfsr0 = s0;</span>
<span class="fc" id="L2400">        lfsr1 = s1;</span>
<span class="fc" id="L2401">        lfsr2 = s2;</span>
<span class="fc" id="L2402">        lfsr3 = s3;</span>
<span class="fc" id="L2403">        lfsr4 = s4;</span>
<span class="fc" id="L2404">        lfsr5 = s5;</span>
<span class="fc" id="L2405">        lfsr6 = s6;</span>
<span class="fc" id="L2406">        lfsr7 = s7;</span>
<span class="fc" id="L2407">        lfsr8 = s8;</span>
<span class="fc" id="L2408">        lfsr9 = s9;</span>
<span class="fc" id="L2409">        fsmR1 = r1;</span>
<span class="fc" id="L2410">        fsmR2 = r2;</span>
<span class="fc" id="L2411">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>