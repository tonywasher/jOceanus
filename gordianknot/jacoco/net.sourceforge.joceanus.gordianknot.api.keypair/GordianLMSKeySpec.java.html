<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GordianLMSKeySpec.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">GordianKnot Security Framework</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.joceanus.gordianknot.api.keypair</a> &gt; <span class="el_source">GordianLMSKeySpec.java</span></div><h1>GordianLMSKeySpec.java</h1><pre class="source lang-java linenums">/*******************************************************************************
 * GordianKnot: Security Suite
 * Copyright 2012,2025 Tony Washer
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not
 * use this file except in compliance with the License.  You may obtain a copy
 * of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations under
 * the License.
 ******************************************************************************/
package net.sourceforge.joceanus.gordianknot.api.keypair;

import net.sourceforge.joceanus.gordianknot.api.base.GordianLength;
import org.bouncycastle.pqc.crypto.lms.LMOtsParameters;
import org.bouncycastle.pqc.crypto.lms.LMSParameters;
import org.bouncycastle.pqc.crypto.lms.LMSigParameters;

import java.util.ArrayList;
import java.util.List;
import java.util.Objects;

/**
 * LMS KeyTypes.
 */
public class GordianLMSKeySpec {
    /**
     * The Separator.
     */
    private static final String SEP = &quot;-&quot;;

    /**
     * Invalid length error.
     */
    private static final String INVALID_LENGTH = &quot;Invalid Length: &quot;;

    /**
     * The hash.
     */
    private final GordianLMSHash theHash;

    /**
     * The width.
     */
    private final GordianLMSWidth theWidth;

    /**
     * The height.
     */
    private final GordianLMSHeight theHeight;

    /**
     * The length.
     */
    private final GordianLength theLength;

    /**
     * The Parameters.
     */
    private final LMSParameters theParams;

    /**
     * The Validity.
     */
    private final boolean isValid;

    /**
     * The String name.
     */
    private String theName;

    /**
     * Constructor.
     * @param pHashType the hashType
     * @param pHeight the height
     * @param pWidth the width
     * @param pLength the length
     */
    public GordianLMSKeySpec(final GordianLMSHash pHashType,
                             final GordianLMSHeight pHeight,
                             final GordianLMSWidth pWidth,
<span class="fc" id="L87">                             final GordianLength pLength) {</span>
        /* Store parameters */
<span class="fc" id="L89">        theHash = pHashType;</span>
<span class="fc" id="L90">        theWidth = pWidth;</span>
<span class="fc" id="L91">        theHeight = pHeight;</span>
<span class="fc" id="L92">        theLength = pLength;</span>

        /* Check validity */
<span class="fc" id="L95">        isValid = checkValidity();</span>

        /* Calculate parameters */
<span class="pc bpc" id="L98" title="1 of 2 branches missed.">        final LMSigParameters mySig = isValid ? theHeight.getSigParameter(theHash, theLength) : null;</span>
<span class="pc bpc" id="L99" title="1 of 2 branches missed.">        final LMOtsParameters myOts = isValid ? theWidth.getOtsParameter(theHash, theLength) : null;</span>
<span class="pc bpc" id="L100" title="1 of 2 branches missed.">        theParams = isValid ? new LMSParameters(mySig, myOts) : null;</span>
<span class="fc" id="L101">    }</span>

    /**
     * Obtain the hash.
     * @return the hash
     */
    public GordianLMSHash getHash() {
<span class="nc" id="L108">        return theHash;</span>
    }

    /**
     * Obtain the width.
     * @return the width
     */
    public GordianLMSHeight getHeight() {
<span class="nc" id="L116">        return theHeight;</span>
    }

    /**
     * Obtain the width.
     * @return the width
     */
    public GordianLMSWidth getWidth() {
<span class="nc" id="L124">        return theWidth;</span>
    }

    /**
     * Obtain the legth.
     * @return the width
     */
    public GordianLength getLength() {
<span class="nc" id="L132">        return theLength;</span>
    }

    /**
     * Obtain the parameters.
     * @return the parameters
     */
    public LMSParameters getParameters() {
<span class="fc" id="L140">        return theParams;</span>
    }

    /**
     * Is the keySpec high (height &amp;ge; 15)?
     * @return true/false.
     */
    public boolean isHigh() {
<span class="pc bpc" id="L148" title="2 of 4 branches missed.">        return isValid &amp;&amp; theHeight.isHigh();</span>
    }

    /**
     * Is the keySpec valid?
     * @return true/false.
     */
    public boolean isValid() {
<span class="nc" id="L156">        return isValid;</span>
    }

    /**
     * Check spec validity.
     * @return valid true/false
     */
    private boolean checkValidity() {
<span class="pc bpc" id="L164" title="4 of 8 branches missed.">        if (theWidth == null || theHeight == null || theHash == null || theLength == null) {</span>
<span class="nc" id="L165">            return false;</span>
        }
<span class="pc bpc" id="L167" title="1 of 2 branches missed.">        switch (theLength) {</span>
            case LEN_192:
            case LEN_256:
<span class="fc" id="L170">                return true;</span>
            default:
<span class="nc" id="L172">                return false;</span>
        }
    }

    @Override
    public String toString() {
        /* If we have not yet loaded the name */
<span class="pc bpc" id="L179" title="1 of 2 branches missed.">        if (theName == null) {</span>
            /* If the keySpec is valid */
<span class="pc bpc" id="L181" title="1 of 2 branches missed.">            if (isValid) {</span>
                /* Load the name */
<span class="fc" id="L183">                theName = theHash.toString() + SEP + theWidth.toString() + SEP + theHeight.toString() + SEP + theLength.toString();</span>
             }  else {
                /* Report invalid spec */
<span class="nc" id="L186">                theName = &quot;InvalidLMSKeySpec: &quot; + theHash + SEP + theWidth + SEP + theHeight + SEP + theLength;</span>
            }
        }

        /* return the name */
<span class="fc" id="L191">        return theName;</span>
    }

    @Override
    public boolean equals(final Object pThat) {
        /* Handle the trivial cases */
<span class="pc bpc" id="L197" title="1 of 2 branches missed.">        if (this == pThat) {</span>
<span class="nc" id="L198">            return true;</span>
        }
<span class="pc bpc" id="L200" title="1 of 2 branches missed.">        if (pThat == null) {</span>
<span class="nc" id="L201">            return false;</span>
        }

        /* Check fields */
<span class="pc bpc" id="L205" title="4 of 8 branches missed.">        return pThat instanceof GordianLMSKeySpec myThat</span>
                &amp;&amp; theHash == myThat.theHash
                &amp;&amp; theLength == myThat.theLength
                &amp;&amp; theWidth == myThat.theWidth
<span class="pc bpc" id="L209" title="1 of 2 branches missed.">                &amp;&amp; theHeight == myThat.theHeight;</span>
    }

    @Override
    public int hashCode() {
<span class="fc" id="L214">        return Objects.hash(theHash, theHeight, theWidth, theLength);</span>
    }

    /**
     * Obtain a list of all possible specs.
     * @return the list
     */
    public static List&lt;GordianLMSKeySpec&gt; listPossibleKeySpecs() {
        /* Create the list */
<span class="fc" id="L223">        final List&lt;GordianLMSKeySpec&gt; mySpecs = new ArrayList&lt;&gt;();</span>

        /* Add the specs */
<span class="fc bfc" id="L226" title="All 2 branches covered.">        for (final GordianLMSHeight myHeight : GordianLMSHeight.values()) {</span>
<span class="fc bfc" id="L227" title="All 2 branches covered.">            for (final GordianLMSWidth myWidth : GordianLMSWidth.values()) {</span>
<span class="fc" id="L228">                mySpecs.add(new GordianLMSKeySpec(GordianLMSHash.SHA256, myHeight, myWidth, GordianLength.LEN_256));</span>
<span class="fc" id="L229">                mySpecs.add(new GordianLMSKeySpec(GordianLMSHash.SHA256, myHeight, myWidth, GordianLength.LEN_192));</span>
<span class="fc" id="L230">                mySpecs.add(new GordianLMSKeySpec(GordianLMSHash.SHAKE256, myHeight, myWidth, GordianLength.LEN_256));</span>
<span class="fc" id="L231">                mySpecs.add(new GordianLMSKeySpec(GordianLMSHash.SHAKE256, myHeight, myWidth, GordianLength.LEN_192));</span>
            }
        }

        /* Return the list */
<span class="fc" id="L236">        return mySpecs;</span>
    }

    /**
     * Match keySpec against LMSParameters.
     * @param pSigParams the sigParameters
     * @param pOtsParams the otsParameters
     * @return the matching keySpec
     */
    public static GordianLMSKeySpec determineKeySpec(final LMSigParameters pSigParams,
                                                     final LMOtsParameters pOtsParams) {
<span class="fc" id="L247">        final List&lt;GordianLMSKeySpec&gt; mySpecs = listPossibleKeySpecs();</span>
<span class="pc bpc" id="L248" title="1 of 2 branches missed.">        for (GordianLMSKeySpec mySpec : mySpecs) {</span>
<span class="pc bpc" id="L249" title="1 of 2 branches missed.">            if (pSigParams.equals(mySpec.getParameters().getLMSigParam())</span>
<span class="pc bpc" id="L250" title="1 of 2 branches missed.">                &amp;&amp; pOtsParams.equals(mySpec.getParameters().getLMOTSParam())) {</span>
<span class="fc" id="L251">                return mySpec;</span>
            }
<span class="nc" id="L253">        }</span>
<span class="nc" id="L254">        throw new IllegalArgumentException(&quot;Unsupported LMSSpec&quot;);</span>
    }

    /**
     * HSS keySpec.
     */
    public static class GordianHSSKeySpec {
        /**
         * Max depth for HSS key.
         */
        public static final int MAX_DEPTH = 8;

        /**
         * The top level keySpec.
         */
        private final GordianLMSKeySpec theKeySpec;

        /**
         * The tree depth.
         */
        private final int theDepth;

        /**
         * The Validity.
         */
        private final boolean isValid;

        /**
         * The String name.
         */
        private String theName;

        /**
         * Constructor.
         * @param pKeySpec the keySpecs
         * @param pDepth the tree depth
         */
        GordianHSSKeySpec(final GordianLMSKeySpec pKeySpec,
<span class="fc" id="L292">                          final int pDepth) {</span>
            /* Create the list of keySpecs */
<span class="fc" id="L294">            theKeySpec = pKeySpec;</span>
<span class="fc" id="L295">            theDepth = pDepth;</span>
<span class="fc" id="L296">            isValid = checkValidity();</span>
<span class="fc" id="L297">        }</span>

        /**
         * Obtain the parameters.
         * @return the parameters.
         */
        public GordianLMSKeySpec getKeySpec() {
            /* If we are valid */
<span class="pc bpc" id="L305" title="1 of 2 branches missed.">            return isValid</span>
<span class="fc" id="L306">                   ? theKeySpec</span>
<span class="nc" id="L307">                   : null;</span>
        }

        /**
         * Obtain the treeDepth.
         * @return the treeDepth.
         */
        public int getTreeDepth() {
            /* If we are valid */
<span class="pc bpc" id="L316" title="1 of 2 branches missed.">            return isValid</span>
<span class="fc" id="L317">                   ? theDepth</span>
<span class="nc" id="L318">                   : -1;</span>
        }

        /**
         * Is the keySpec valid?
         * @return true/false.
         */
        public boolean isValid() {
<span class="fc" id="L326">            return isValid;</span>
        }

        /**
         * Check spec validity.
         * @return valid true/false
         */
        private boolean checkValidity() {
            /* Depth must be at least 1 and  no more that MAX */
<span class="pc bpc" id="L335" title="2 of 4 branches missed.">            if (theDepth &lt; 1 || theDepth &gt; MAX_DEPTH) {</span>
<span class="nc" id="L336">                return false;</span>
            }

            /* Check keySpec */
<span class="pc bpc" id="L340" title="2 of 4 branches missed.">            return theKeySpec != null &amp;&amp; theKeySpec.isValid;</span>
        }

        @Override
        public String toString() {
            /* If we have not yet loaded the name */
<span class="pc bpc" id="L346" title="1 of 2 branches missed.">            if (theName == null) {</span>
                /* If the keySpec is valid */
<span class="pc bpc" id="L348" title="1 of 2 branches missed.">                if (isValid) {</span>
                    /* Load the name */
<span class="fc" id="L350">                    theName = &quot;HSS-&quot; + theDepth + &quot;-&quot; + theKeySpec;</span>

                }  else {
                    /* Report invalid spec */
<span class="nc" id="L354">                    theName = &quot;InvalidHSSKeySpec: &quot; + theDepth + &quot;:&quot; + theKeySpec;</span>
                }
            }

            /* return the name */
<span class="fc" id="L359">            return theName;</span>
        }

        @Override
        public boolean equals(final Object pThat) {
            /* Handle the trivial cases */
<span class="pc bpc" id="L365" title="1 of 2 branches missed.">            if (this == pThat) {</span>
<span class="nc" id="L366">                return true;</span>
            }
<span class="pc bpc" id="L368" title="1 of 2 branches missed.">            if (pThat == null) {</span>
<span class="nc" id="L369">                return false;</span>
            }

            /* Make sure that the object is hssSpec */
<span class="pc bpc" id="L373" title="1 of 2 branches missed.">            if (pThat.getClass() != this.getClass()) {</span>
<span class="nc" id="L374">                return false;</span>
            }

            /* Access the target hssSpec */
<span class="fc" id="L378">            final GordianHSSKeySpec myThat = (GordianHSSKeySpec) pThat;</span>

            /* Check depth and keySpec are identical */
<span class="pc bpc" id="L381" title="1 of 2 branches missed.">            return theDepth == myThat.theDepth</span>
<span class="pc bpc" id="L382" title="1 of 2 branches missed.">                    &amp;&amp; Objects.equals(theKeySpec, myThat.theKeySpec);</span>
        }

        @Override
        public int hashCode() {
<span class="fc" id="L387">            return theKeySpec.hashCode() + theDepth;</span>
        }
    }

    /**
     * LMS hash.
     */
<span class="fc" id="L394">    public enum GordianLMSHash {</span>
        /**
         * Sha256.
         */
<span class="fc" id="L398">        SHA256,</span>

        /**
         * Shake256.
         */
<span class="fc" id="L403">        SHAKE256;</span>
    }

    /**
     * LMS height.
     */
<span class="fc" id="L409">    public enum GordianLMSHeight {</span>
        /**
         * H5.
         */
<span class="fc" id="L413">        H5,</span>

        /**
         * H10.
         */
<span class="fc" id="L418">        H10,</span>

        /**
         * H15.
         */
<span class="fc" id="L423">        H15,</span>

        /**
         * H20.
         */
<span class="fc" id="L428">        H20,</span>

        /**
         * H25.
         */
<span class="fc" id="L433">        H25;</span>

        /**
         * Obtain the sigParameter.
         * @param pHash the hash
         * @param pLength the length
         * @return the parameter
         */
        private LMSigParameters getSigParameter(final GordianLMSHash pHash,
                                                final GordianLength pLength) {
<span class="pc bpc" id="L443" title="1 of 6 branches missed.">            switch (this) {</span>
<span class="fc" id="L444">                case H5:    return getH5Parameter(pHash, pLength);</span>
<span class="fc" id="L445">                case H10:   return getH10Parameter(pHash, pLength);</span>
<span class="fc" id="L446">                case H15:   return getH15Parameter(pHash, pLength);</span>
<span class="fc" id="L447">                case H20:   return getH20Parameter(pHash, pLength);</span>
<span class="fc" id="L448">                case H25:   return getH25Parameter(pHash, pLength);</span>
<span class="nc" id="L449">                default:    throw new IllegalStateException();</span>
            }
        }

        /**
         * Obtain the H5 sigParameter.
         * @param pHash the hash
         * @param pLength the length
         * @return the parameter
         */
        private LMSigParameters getH5Parameter(final GordianLMSHash pHash,
                                               final GordianLength pLength) {
<span class="pc bpc" id="L461" title="1 of 3 branches missed.">            switch (pLength) {</span>
                case LEN_192:
<span class="fc bfc" id="L463" title="All 2 branches covered.">                    return pHash == GordianLMSHash.SHA256 ? LMSigParameters.lms_sha256_n24_h5 : LMSigParameters.lms_shake256_n24_h5;</span>
                case LEN_256:
<span class="fc bfc" id="L465" title="All 2 branches covered.">                    return pHash == GordianLMSHash.SHA256 ? LMSigParameters.lms_sha256_n32_h5 : LMSigParameters.lms_shake256_n32_h5;</span>
                default:
<span class="nc" id="L467">                    throw new IllegalArgumentException(INVALID_LENGTH + pLength);</span>
            }
        }

        /**
         * Obtain the H10 sigParameter.
         * @param pHash the hash
         * @param pLength the length
         * @return the parameter
         */
        private LMSigParameters getH10Parameter(final GordianLMSHash pHash,
                                                final GordianLength pLength) {
<span class="pc bpc" id="L479" title="1 of 3 branches missed.">            switch (pLength) {</span>
                case LEN_192:
<span class="fc bfc" id="L481" title="All 2 branches covered.">                    return pHash == GordianLMSHash.SHA256 ? LMSigParameters.lms_sha256_n24_h10 : LMSigParameters.lms_shake256_n24_h10;</span>
                case LEN_256:
<span class="fc bfc" id="L483" title="All 2 branches covered.">                    return pHash == GordianLMSHash.SHA256 ? LMSigParameters.lms_sha256_n32_h10 : LMSigParameters.lms_shake256_n32_h10;</span>
                default:
<span class="nc" id="L485">                    throw new IllegalArgumentException(INVALID_LENGTH + pLength);</span>
            }
        }

        /**
         * Obtain the H15 sigParameter.
         * @param pHash the hash
         * @param pLength the length
         * @return the parameter
         */
        private LMSigParameters getH15Parameter(final GordianLMSHash pHash,
                                                final GordianLength pLength) {
<span class="pc bpc" id="L497" title="1 of 3 branches missed.">            switch (pLength) {</span>
                case LEN_192:
<span class="fc bfc" id="L499" title="All 2 branches covered.">                    return pHash == GordianLMSHash.SHA256 ? LMSigParameters.lms_sha256_n24_h15 : LMSigParameters.lms_shake256_n24_h15;</span>
                case LEN_256:
<span class="fc bfc" id="L501" title="All 2 branches covered.">                    return pHash == GordianLMSHash.SHA256 ? LMSigParameters.lms_sha256_n32_h15 : LMSigParameters.lms_shake256_n32_h15;</span>
                default:
<span class="nc" id="L503">                    throw new IllegalArgumentException(INVALID_LENGTH + pLength);</span>
            }
        }

        /**
         * Obtain the H20 sigParameter.
         * @param pHash the hash
         * @param pLength the length
         * @return the parameter
         */
        private LMSigParameters getH20Parameter(final GordianLMSHash pHash,
                                                final GordianLength pLength) {
<span class="pc bpc" id="L515" title="1 of 3 branches missed.">            switch (pLength) {</span>
                case LEN_192:
<span class="fc bfc" id="L517" title="All 2 branches covered.">                    return pHash == GordianLMSHash.SHA256 ? LMSigParameters.lms_sha256_n24_h20 : LMSigParameters.lms_shake256_n24_h20;</span>
                case LEN_256:
<span class="fc bfc" id="L519" title="All 2 branches covered.">                    return pHash == GordianLMSHash.SHA256 ? LMSigParameters.lms_sha256_n32_h20 : LMSigParameters.lms_shake256_n32_h20;</span>
                default:
<span class="nc" id="L521">                    throw new IllegalArgumentException(INVALID_LENGTH + pLength);</span>
            }
        }

        /**
         * Obtain the H25 sigParameter.
         * @param pHash the hash
         * @param pLength the length
         * @return the parameter
         */
        private LMSigParameters getH25Parameter(final GordianLMSHash pHash,
                                                final GordianLength pLength) {
<span class="pc bpc" id="L533" title="1 of 3 branches missed.">            switch (pLength) {</span>
                case LEN_192:
<span class="fc bfc" id="L535" title="All 2 branches covered.">                    return pHash == GordianLMSHash.SHA256 ? LMSigParameters.lms_sha256_n24_h25 : LMSigParameters.lms_shake256_n24_h25;</span>
                case LEN_256:
<span class="fc bfc" id="L537" title="All 2 branches covered.">                    return pHash == GordianLMSHash.SHA256 ? LMSigParameters.lms_sha256_n32_h25 : LMSigParameters.lms_shake256_n32_h25;</span>
                default:
<span class="nc" id="L539">                    throw new IllegalArgumentException(INVALID_LENGTH + pLength);</span>
            }
        }

        /**
         * Is the parameter high (height &amp;ge; 15)?
         * @return true/false.
         */
        public boolean isHigh() {
<span class="pc bpc" id="L548" title="1 of 2 branches missed.">            switch (this) {</span>
                case H15:
                case H20:
                case H25:
<span class="nc" id="L552">                    return true;</span>
                default:
<span class="fc" id="L554">                    return false;</span>
            }
        }
    }

    /**
     * LMS Width.
     */
<span class="fc" id="L562">    public enum GordianLMSWidth {</span>
        /**
         * W1.
         */
<span class="fc" id="L566">        W1,</span>

        /**
         * W2.
         */
<span class="fc" id="L571">        W2,</span>

        /**
         * W4.
         */
<span class="fc" id="L576">        W4,</span>

        /**
         * W8.
         */
<span class="fc" id="L581">        W8;</span>

        /**
         * Obtain the otsParameter.
         * @param pHash the hash
         * @param pLength the length
         * @return the parameter
         */
        private LMOtsParameters getOtsParameter(final GordianLMSHash pHash,
                                                final GordianLength pLength) {
<span class="pc bpc" id="L591" title="1 of 5 branches missed.">            switch (this) {</span>
<span class="fc" id="L592">                case W1:   return getW1Parameter(pHash, pLength);</span>
<span class="fc" id="L593">                case W2:   return getW2Parameter(pHash, pLength);</span>
<span class="fc" id="L594">                case W4:   return getW4Parameter(pHash, pLength);</span>
<span class="fc" id="L595">                case W8:   return getW8Parameter(pHash, pLength);</span>
<span class="nc" id="L596">                default:   throw new IllegalStateException();</span>
            }
        }

        /**
         * Obtain the W1 otsParameter.
         * @param pHash the hash
         * @param pLength the length
         * @return the parameter
         */
        private LMOtsParameters getW1Parameter(final GordianLMSHash pHash,
                                               final GordianLength pLength) {
<span class="pc bpc" id="L608" title="1 of 3 branches missed.">            switch (pLength) {</span>
                case LEN_192:
<span class="fc bfc" id="L610" title="All 2 branches covered.">                    return pHash == GordianLMSHash.SHA256 ? LMOtsParameters.sha256_n24_w1 : LMOtsParameters.shake256_n24_w1;</span>
                case LEN_256:
<span class="fc bfc" id="L612" title="All 2 branches covered.">                    return pHash == GordianLMSHash.SHA256 ? LMOtsParameters.sha256_n32_w1 : LMOtsParameters.shake256_n32_w1;</span>
                default:
<span class="nc" id="L614">                    throw new IllegalArgumentException(INVALID_LENGTH + pLength);</span>
            }
        }

        /**
         * Obtain the W2 otsParameter.
         * @param pHash the hash
         * @param pLength the length
         * @return the parameter
         */
        private LMOtsParameters getW2Parameter(final GordianLMSHash pHash,
                                               final GordianLength pLength) {
<span class="pc bpc" id="L626" title="1 of 3 branches missed.">            switch (pLength) {</span>
                case LEN_192:
<span class="fc bfc" id="L628" title="All 2 branches covered.">                    return pHash == GordianLMSHash.SHA256 ? LMOtsParameters.sha256_n24_w2 : LMOtsParameters.shake256_n24_w2;</span>
                case LEN_256:
<span class="fc bfc" id="L630" title="All 2 branches covered.">                    return pHash == GordianLMSHash.SHA256 ? LMOtsParameters.sha256_n32_w2 : LMOtsParameters.shake256_n32_w2;</span>
                default:
<span class="nc" id="L632">                    throw new IllegalArgumentException(INVALID_LENGTH + pLength);</span>
            }
        }

        /**
         * Obtain the W4 otsParameter.
         * @param pHash the hash
         * @param pLength the length
         * @return the parameter
         */
        private LMOtsParameters getW4Parameter(final GordianLMSHash pHash,
                                               final GordianLength pLength) {
<span class="pc bpc" id="L644" title="1 of 3 branches missed.">            switch (pLength) {</span>
                case LEN_192:
<span class="fc bfc" id="L646" title="All 2 branches covered.">                    return pHash == GordianLMSHash.SHA256 ? LMOtsParameters.sha256_n24_w4 : LMOtsParameters.shake256_n24_w4;</span>
                case LEN_256:
<span class="fc bfc" id="L648" title="All 2 branches covered.">                    return pHash == GordianLMSHash.SHA256 ? LMOtsParameters.sha256_n32_w4 : LMOtsParameters.shake256_n32_w4;</span>
                default:
<span class="nc" id="L650">                    throw new IllegalArgumentException(INVALID_LENGTH + pLength);</span>
            }
        }

        /**
         * Obtain the W8 otsParameter.
         * @param pHash the hash
         * @param pLength the length
         * @return the parameter
         */
        private LMOtsParameters getW8Parameter(final GordianLMSHash pHash,
                                               final GordianLength pLength) {
<span class="pc bpc" id="L662" title="1 of 3 branches missed.">            switch (pLength) {</span>
                case LEN_192:
<span class="fc bfc" id="L664" title="All 2 branches covered.">                    return pHash == GordianLMSHash.SHA256 ? LMOtsParameters.sha256_n24_w8 : LMOtsParameters.shake256_n24_w8;</span>
                case LEN_256:
<span class="fc bfc" id="L666" title="All 2 branches covered.">                    return pHash == GordianLMSHash.SHA256 ? LMOtsParameters.sha256_n32_w8 : LMOtsParameters.shake256_n32_w8;</span>
                default:
<span class="nc" id="L668">                    throw new IllegalArgumentException(INVALID_LENGTH + pLength);</span>
            }
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>