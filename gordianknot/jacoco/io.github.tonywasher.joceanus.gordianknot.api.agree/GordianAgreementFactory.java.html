<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GordianAgreementFactory.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">GordianKnot Security Framework</a> &gt; <a href="index.source.html" class="el_package">io.github.tonywasher.joceanus.gordianknot.api.agree</a> &gt; <span class="el_source">GordianAgreementFactory.java</span></div><h1>GordianAgreementFactory.java</h1><pre class="source lang-java linenums">/*
 * GordianKnot: Security Suite
 * Copyright 2012-2026. Tony Washer
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not
 * use this file except in compliance with the License.  You may obtain a copy
 * of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */
package io.github.tonywasher.joceanus.gordianknot.api.agree;

import io.github.tonywasher.joceanus.gordianknot.api.base.GordianException;
import io.github.tonywasher.joceanus.gordianknot.api.cert.GordianCertificate;
import io.github.tonywasher.joceanus.gordianknot.api.cert.GordianKeyPairUsage;
import io.github.tonywasher.joceanus.gordianknot.api.keypair.GordianKeyPair;
import io.github.tonywasher.joceanus.gordianknot.api.keypair.GordianKeyPairSpec;
import io.github.tonywasher.joceanus.gordianknot.api.sign.GordianSignatureSpec;
import org.bouncycastle.asn1.x500.X500Name;

import java.util.List;
import java.util.function.Predicate;

/**
 * GordianKnot AgreementFactory API.
 */
public interface GordianAgreementFactory {
    /**
     * Create new AgreementParams.
     *
     * @param pSpec       the agreementSpec
     * @param pResultType the result type
     *                    &lt;dl&gt;
     *                        &lt;dt&gt;GordianFactoryType&lt;/dt&gt;&lt;dd&gt;To agree a Factory&lt;/dd&gt;
     *                        &lt;dt&gt;GordianSymCipherSpec&lt;/dt&gt;&lt;dd&gt;To agree a symCipher pair&lt;/dd&gt;
     *                        &lt;dt&gt;GordianStreamCipherSpec&lt;/dt&gt;&lt;dd&gt;To agree a streamCipher pair&lt;/dd&gt;
     *                        &lt;dt&gt;GordianKeySetSpec&lt;/dt&gt;&lt;dd&gt;To agree a KeySet&lt;/dd&gt;
     *                        &lt;dt&gt;Integer&lt;/dt&gt;&lt;dd&gt;To agree a defined length byte array&lt;/dd&gt;
     *                    &lt;/dl&gt;
     * @return the Params
     * @throws GordianException on error
     */
    GordianAgreementParams newAgreementParams(GordianAgreementSpec pSpec,
                                              Object pResultType) throws GordianException;

    /**
     * CreateAgreement.
     *
     * @param pParams the agreementParams
     * @return the Agreement
     * @throws GordianException on error
     */
    GordianAgreement createAgreement(GordianAgreementParams pParams) throws GordianException;

    /**
     * Create/Locate Agreement for incoming message.
     *
     * @param pMessage the incoming message
     * @return the Agreement
     * @throws GordianException on error
     */
    GordianAgreement parseAgreementMessage(byte[] pMessage) throws GordianException;

    /**
     * Declare signer certificate.
     *
     * @param pSigner the certificate
     * @throws GordianException on error
     */
    void setSigner(GordianCertificate pSigner) throws GordianException;

    /**
     * Declare signer certificate and specification.
     *
     * @param pSigner   the certificate
     * @param pSignSpec the signSpec
     * @throws GordianException on error
     */
    void setSigner(GordianCertificate pSigner,
                   GordianSignatureSpec pSignSpec) throws GordianException;

    /**
     * Create new miniCertificate.
     *
     * @param pSubject the subject of the certificate
     * @param pKeyPair the keyPair.
     * @param pUsage   the usage
     * @return the certificate
     * @throws GordianException on error
     */
    GordianCertificate newMiniCertificate(X500Name pSubject,
                                          GordianKeyPair pKeyPair,
                                          GordianKeyPairUsage pUsage) throws GordianException;

    /**
     * Obtain predicate for keyAgreement.
     *
     * @return the predicate
     */
    Predicate&lt;GordianAgreementSpec&gt; supportedAgreements();

    /**
     * Check AgreementSpec and KeyPair combination.
     *
     * @param pKeyPair       the keyPair
     * @param pAgreementSpec the macSpec
     * @return true/false
     */
    default boolean validAgreementSpecForKeyPair(final GordianKeyPair pKeyPair,
                                                 final GordianAgreementSpec pAgreementSpec) {
<span class="nc" id="L117">        return validAgreementSpecForKeyPairSpec(pKeyPair.getKeyPairSpec(), pAgreementSpec);</span>
    }

    /**
     * Check AgreementSpec and KeyPairSpec combination.
     *
     * @param pKeyPairSpec   the keyPairSpec
     * @param pAgreementSpec the agreementSpec
     * @return true/false
     */
    boolean validAgreementSpecForKeyPairSpec(GordianKeyPairSpec pKeyPairSpec,
                                             GordianAgreementSpec pAgreementSpec);

    /**
     * Obtain a list of supported agreementSpecs.
     *
     * @param pKeyPair the keyPair
     * @return the list of supported agreementSpecs.
     */
    List&lt;GordianAgreementSpec&gt; listAllSupportedAgreements(GordianKeyPair pKeyPair);

    /**
     * Obtain a list of supported agreementSpecs.
     *
     * @param pKeyPairSpec the keySpec
     * @return the list of supported agreementSpecs.
     */
    List&lt;GordianAgreementSpec&gt; listAllSupportedAgreements(GordianKeyPairSpec pKeyPairSpec);

    /**
     * Create default agreementSpec for key.
     *
     * @param pKeySpec the keySpec
     * @return the AgreementSpec
     */
    GordianAgreementSpec defaultForKeyPair(GordianKeyPairSpec pKeySpec);
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>