<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GordianStreamKeySpec.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">GordianKnot Security Framework</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.joceanus.gordianknot.api.cipher</a> &gt; <span class="el_source">GordianStreamKeySpec.java</span></div><h1>GordianStreamKeySpec.java</h1><pre class="source lang-java linenums">/*******************************************************************************
 * GordianKnot: Security Suite
 * Copyright 2012,2025 Tony Washer
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not
 * use this file except in compliance with the License.  You may obtain a copy
 * of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations under
 * the License.
 ******************************************************************************/
package net.sourceforge.joceanus.gordianknot.api.cipher;

import net.sourceforge.joceanus.gordianknot.api.base.GordianKeySpec;
import net.sourceforge.joceanus.gordianknot.api.base.GordianLength;
import org.bouncycastle.crypto.engines.ElephantEngine.ElephantParameters;
import org.bouncycastle.crypto.engines.ISAPEngine.IsapType;
import org.bouncycastle.crypto.engines.RomulusEngine.RomulusParameters;
import org.bouncycastle.crypto.engines.SparkleEngine.SparkleParameters;

import java.util.Objects;

/**
 * GordianKnot StreamKeySpec.
 */
public class GordianStreamKeySpec
    implements GordianKeySpec {
    /**
     * The Separator.
     */
    private static final String SEP = &quot;-&quot;;

    /**
     * The StreamKey Type.
     */
    private final GordianStreamKeyType theStreamKeyType;

    /**
     * The Key Length.
     */
    private final GordianLength theKeyLength;

    /**
     * SubKeyType.
     */
    private final GordianStreamSubKeyType theSubKeyType;

    /**
     * The Validity.
     */
    private final boolean isValid;

    /**
     * The String name.
     */
    private String theName;

    /**
     * Constructor.
     * @param pStreamKeyType the streamKeyType
     * @param pKeyLength the keyLength
     */
    public GordianStreamKeySpec(final GordianStreamKeyType pStreamKeyType,
                                final GordianLength pKeyLength) {
<span class="fc" id="L70">        this(pStreamKeyType, pKeyLength, defaultSubKeyType(pStreamKeyType));</span>
<span class="fc" id="L71">    }</span>

    /**
     * Constructor.
     * @param pStreamKeyType the streamKeyType
     * @param pKeyLength the keyLength
     * @param pSubKeyType the subKeyType
     */
    public GordianStreamKeySpec(final GordianStreamKeyType pStreamKeyType,
                                final GordianLength pKeyLength,
<span class="fc" id="L81">                                final GordianStreamSubKeyType pSubKeyType) {</span>
        /* Store parameters */
<span class="fc" id="L83">        theStreamKeyType = pStreamKeyType;</span>
<span class="fc" id="L84">        theKeyLength = pKeyLength;</span>
<span class="fc" id="L85">        theSubKeyType = pSubKeyType;</span>
<span class="fc" id="L86">        isValid = checkValidity();</span>
<span class="fc" id="L87">    }</span>

    /**
     * Obtain streamKey Type.
     * @return the streamKeyType
     */
    public GordianStreamKeyType getStreamKeyType() {
<span class="fc" id="L94">        return theStreamKeyType;</span>
    }

    @Override
    public GordianLength getKeyLength() {
<span class="fc" id="L99">        return theKeyLength;</span>
    }

    /**
     * Obtain subKey Type.
     * @return the subKeyType
     */
    public GordianStreamSubKeyType getSubKeyType() {
<span class="fc" id="L107">        return theSubKeyType;</span>
    }

    /**
     * Is the keySpec valid?
     * @return true/false.
     */
    public boolean isValid() {
<span class="fc" id="L115">        return isValid;</span>
    }

    /**
     * Does this cipher need an IV?
     * @return true/false
     */
    public boolean needsIV() {
<span class="fc bfc" id="L123" title="All 2 branches covered.">        return getIVLength() &gt; 0;</span>
    }

    /**
     * Check spec validity.
     * @return valid true/false
     */
    private boolean checkValidity() {
        /* Stream KeyType and Key length must be non-null */
<span class="pc bpc" id="L132" title="2 of 4 branches missed.">        if (theStreamKeyType == null</span>
                || theKeyLength == null) {
<span class="nc" id="L134">            return false;</span>
        }

        /* Check subKeyTypes */
<span class="fc bfc" id="L138" title="All 10 branches covered.">        switch (theStreamKeyType) {</span>
            case SALSA20:
<span class="fc" id="L140">                return checkSalsaValidity();</span>
            case CHACHA20:
<span class="fc" id="L142">                return checkChaChaValidity();</span>
            case VMPC:
<span class="fc" id="L144">                return checkVMPCValidity();</span>
            case SKEINXOF:
<span class="fc" id="L146">                return checkSkeinValidity();</span>
            case BLAKE2XOF:
<span class="fc" id="L148">                return checkBlake2Validity();</span>
            case ELEPHANT:
<span class="pc bpc" id="L150" title="1 of 2 branches missed.">                return theSubKeyType instanceof GordianElephantKey</span>
<span class="pc bpc" id="L151" title="1 of 2 branches missed.">                        &amp;&amp; theStreamKeyType.validForKeyLength(theKeyLength);</span>
            case ISAP:
<span class="pc bpc" id="L153" title="1 of 2 branches missed.">                return theSubKeyType instanceof GordianISAPKey</span>
<span class="pc bpc" id="L154" title="1 of 2 branches missed.">                        &amp;&amp; theStreamKeyType.validForKeyLength(theKeyLength);</span>
            case ROMULUS:
<span class="pc bpc" id="L156" title="1 of 2 branches missed.">                return theSubKeyType instanceof GordianRomulusKey</span>
<span class="pc bpc" id="L157" title="1 of 2 branches missed.">                        &amp;&amp; theStreamKeyType.validForKeyLength(theKeyLength);</span>
            case SPARKLE:
<span class="fc" id="L159">                return checkSparkleValidity();</span>
            default:
<span class="pc bpc" id="L161" title="1 of 2 branches missed.">                return theSubKeyType == null</span>
<span class="pc bpc" id="L162" title="1 of 2 branches missed.">                        &amp;&amp; theStreamKeyType.validForKeyLength(theKeyLength);</span>
        }
    }

    /**
     * Check salsa spec validity.
     * @return valid true/false
     */
    private boolean checkSalsaValidity() {
        /* SubKeyType must be a SalsaKey */
<span class="pc bpc" id="L172" title="1 of 2 branches missed.">        if (!(theSubKeyType instanceof GordianSalsa20Key)) {</span>
<span class="nc" id="L173">            return false;</span>
        }

        /* Check keyLength validity */
<span class="fc bfc" id="L177" title="All 2 branches covered.">        return theSubKeyType != GordianSalsa20Key.STD</span>
<span class="fc bfc" id="L178" title="All 2 branches covered.">               ? theKeyLength == GordianLength.LEN_256</span>
<span class="fc" id="L179">               : theStreamKeyType.validForKeyLength(theKeyLength);</span>
    }

    /**
     * Check chacha spec validity.
     * @return valid true/false
     */
    private boolean checkChaChaValidity() {
        /* SubKeyType must be a ChaChaKey */
<span class="pc bpc" id="L188" title="1 of 2 branches missed.">        if (!(theSubKeyType instanceof GordianChaCha20Key)) {</span>
<span class="nc" id="L189">            return false;</span>
        }

        /* Check keyLength validity */
<span class="fc bfc" id="L193" title="All 2 branches covered.">        return theSubKeyType != GordianChaCha20Key.STD</span>
<span class="fc bfc" id="L194" title="All 2 branches covered.">               ? theKeyLength == GordianLength.LEN_256</span>
<span class="fc" id="L195">               : theStreamKeyType.validForKeyLength(theKeyLength);</span>
    }

    /**
     * Check vmpc spec validity.
     * @return valid true/false
     */
    private boolean checkVMPCValidity() {
        /* SubKeyType must be a GordianVMPCKey */
<span class="pc bpc" id="L204" title="1 of 2 branches missed.">        if (!(theSubKeyType instanceof GordianVMPCKey)) {</span>
<span class="nc" id="L205">            return false;</span>
        }

        /* Check keyLength validity */
<span class="fc" id="L209">        return theStreamKeyType.validForKeyLength(theKeyLength);</span>
    }

    /**
     * Check skein spec validity.
     * @return valid true/false
     */
    private boolean checkSkeinValidity() {
        /* SubKeyType must be a GordianSkeinXofKey */
<span class="pc bpc" id="L218" title="1 of 2 branches missed.">        if (!(theSubKeyType instanceof GordianSkeinXofKey)) {</span>
<span class="nc" id="L219">            return false;</span>
        }

        /* Check keyLength validity */
<span class="fc" id="L223">        return theStreamKeyType.validForKeyLength(theKeyLength);</span>
    }

    /**
     * Check blake2 spec validity.
     * @return valid true/false
     */
    private boolean checkBlake2Validity() {
        /* SubKeyType must be a GordianBlakeXofKey */
<span class="pc bpc" id="L232" title="1 of 2 branches missed.">        if (!(theSubKeyType instanceof GordianBlakeXofKey)) {</span>
<span class="nc" id="L233">            return false;</span>
        }

        /* Check keyLength validity */
<span class="fc" id="L237">        final GordianBlakeXofKey myType = (GordianBlakeXofKey) theSubKeyType;</span>
<span class="pc bpc" id="L238" title="1 of 6 branches missed.">        return  theStreamKeyType.validForKeyLength(theKeyLength)</span>
                &amp;&amp; (myType != GordianBlakeXofKey.BLAKE2XS
                    || theKeyLength != GordianLength.LEN_512);
    }

    /**
     * Check sparkle spec validity.
     * @return valid true/false
     */
    private boolean checkSparkleValidity() {
        /* SubKeyType must be a GordianSparkleKey */
<span class="pc bpc" id="L249" title="1 of 2 branches missed.">        if (!(theSubKeyType instanceof GordianSparkleKey)) {</span>
<span class="nc" id="L250">            return false;</span>
        }

        /* Check keyLength validity */
<span class="fc bfc" id="L254" title="All 2 branches covered.">        return theKeyLength == ((GordianSparkleKey) theSubKeyType).requiredKeyLength();</span>
    }

    @Override
    public String toString() {
        /* If we have not yet loaded the name */
<span class="fc bfc" id="L260" title="All 2 branches covered.">        if (theName == null) {</span>
            /* If the keySpec is valid */
<span class="pc bpc" id="L262" title="1 of 2 branches missed.">            if (isValid) {</span>
                /* Load the name */
<span class="fc" id="L264">                theName = getName();</span>
<span class="fc" id="L265">                theName += SEP + theKeyLength;</span>
            }  else {
                /* Report invalid spec */
<span class="nc" id="L268">                theName = &quot;InvalidStreamKeySpec: &quot; + theStreamKeyType + &quot;:&quot; + theKeyLength;</span>
            }
        }

        /* return the name */
<span class="fc" id="L273">        return theName;</span>
    }

    /**
     * Determine the name for the KeySpec.
     * @return the name
     */
    private String getName() {
        /* Handle VMPC-KSA */
<span class="fc bfc" id="L282" title="All 4 branches covered.">        if (theStreamKeyType == GordianStreamKeyType.VMPC</span>
            &amp;&amp; theSubKeyType == GordianVMPCKey.KSA) {
<span class="fc" id="L284">           return theStreamKeyType + &quot;KSA3&quot;;</span>
        }

        /* Handle XSalsa20 */
<span class="fc bfc" id="L288" title="All 4 branches covered.">        if (theStreamKeyType == GordianStreamKeyType.SALSA20</span>
                &amp;&amp; theSubKeyType == GordianSalsa20Key.XSALSA) {
<span class="fc" id="L290">            return &quot;X&quot; + theStreamKeyType;</span>
        }

        /* Handle XChaCha20 */
<span class="fc bfc" id="L294" title="All 4 branches covered.">        if (theStreamKeyType == GordianStreamKeyType.CHACHA20</span>
                &amp;&amp; theSubKeyType == GordianChaCha20Key.XCHACHA) {
<span class="fc" id="L296">            return &quot;X&quot; + theStreamKeyType;</span>
        }

        /* Handle ChaCha7539 */
<span class="fc bfc" id="L300" title="All 4 branches covered.">        if (theStreamKeyType == GordianStreamKeyType.CHACHA20</span>
                &amp;&amp; theSubKeyType == GordianChaCha20Key.ISO7539) {
<span class="fc" id="L302">            return &quot;ChaCha7539&quot;;</span>
        }

        /* Handle Skein */
<span class="fc bfc" id="L306" title="All 2 branches covered.">        if (theStreamKeyType == GordianStreamKeyType.SKEINXOF) {</span>
<span class="fc" id="L307">            return theStreamKeyType + SEP + theSubKeyType.toString();</span>
        }

        /* Handle Remaining types */
<span class="fc bfc" id="L311" title="All 2 branches covered.">        switch (theStreamKeyType) {</span>
            case BLAKE2XOF:
            case ELEPHANT:
            case ISAP:
            case ROMULUS:
            case SPARKLE:
<span class="fc" id="L317">                return theSubKeyType.toString();</span>
            default:
<span class="fc" id="L319">                return theStreamKeyType.toString();</span>
        }
    }

    /**
     * Obtain the IV Length.
     * @return the IV length.
     */
    public int getIVLength() {
<span class="fc bfc" id="L328" title="All 11 branches covered.">        switch (theStreamKeyType) {</span>
            case RABBIT:
<span class="fc" id="L330">                return GordianLength.LEN_64.getByteLength();</span>
            case GRAIN:
            case ELEPHANT:
<span class="fc" id="L333">                return GordianLength.LEN_96.getByteLength();</span>
            case SOSEMANUK:
            case SNOW3G:
            case BLAKE3XOF:
            case SKEINXOF:
            case ASCON:
            case ISAP:
            case PHOTONBEETLE:
            case ROMULUS:
            case XOODYAK:
<span class="fc" id="L343">                return GordianLength.LEN_128.getByteLength();</span>
            case HC:
<span class="fc bfc" id="L345" title="All 2 branches covered.">                return GordianLength.LEN_128 == theKeyLength</span>
<span class="fc" id="L346">                        ? GordianLength.LEN_128.getByteLength()</span>
<span class="fc" id="L347">                        : GordianLength.LEN_256.getByteLength();</span>
            case ZUC:
<span class="fc bfc" id="L349" title="All 2 branches covered.">                return GordianLength.LEN_128 == theKeyLength</span>
<span class="fc" id="L350">                        ? GordianLength.LEN_128.getByteLength()</span>
<span class="fc" id="L351">                        : GordianLength.LEN_200.getByteLength();</span>
            case VMPC:
<span class="fc" id="L353">                return theKeyLength.getByteLength();</span>
            case BLAKE2XOF:
<span class="fc" id="L355">                return ((GordianBlakeXofKey) theSubKeyType).requiredIVLength().getByteLength();</span>
            case CHACHA20:
<span class="fc" id="L357">                return ((GordianChaCha20Key) theSubKeyType).requiredIVLength().getByteLength();</span>
            case SALSA20:
<span class="fc" id="L359">                return ((GordianSalsa20Key) theSubKeyType).requiredIVLength().getByteLength();</span>
            case SPARKLE:
<span class="fc" id="L361">                return ((GordianSparkleKey) theSubKeyType).requiredIVLength().getByteLength();</span>
            case ISAAC:
            case RC4:
            default:
<span class="fc" id="L365">                return 0;</span>
        }
    }

    /**
     * Does this keySpec optionally support AEAD?
     * @return true/false
     */
    public boolean supportsAEAD() {
<span class="fc bfc" id="L374" title="All 4 branches covered.">        return theStreamKeyType == GordianStreamKeyType.CHACHA20</span>
                 &amp;&amp; theSubKeyType != GordianChaCha20Key.STD;
    }

    /**
     * Is this keySpec an AEAD keySpec?
     * @return true/false
     */
    public boolean isAEAD() {
<span class="fc bfc" id="L383" title="All 2 branches covered.">        switch (theStreamKeyType) {</span>
            case ASCON:
            case ELEPHANT:
            case ISAP:
            case PHOTONBEETLE:
            case ROMULUS:
            case SPARKLE:
            case XOODYAK:
<span class="fc" id="L391">                return true;</span>
            default:
<span class="fc" id="L393">                return false;</span>
        }
    }

    @Override
    public boolean equals(final Object pThat) {
        /* Handle the trivial cases */
<span class="fc bfc" id="L400" title="All 2 branches covered.">        if (this == pThat) {</span>
<span class="fc" id="L401">            return true;</span>
        }
<span class="pc bpc" id="L403" title="1 of 2 branches missed.">        if (pThat == null) {</span>
<span class="nc" id="L404">            return false;</span>
        }

        /* Check subFields */
<span class="fc" id="L408">        return pThat instanceof GordianStreamKeySpec myThat</span>
<span class="fc bfc" id="L409" title="All 2 branches covered.">                &amp;&amp; theStreamKeyType == myThat.getStreamKeyType()</span>
<span class="pc bpc" id="L410" title="1 of 2 branches missed.">                &amp;&amp; theKeyLength == myThat.getKeyLength()</span>
<span class="pc bpc" id="L411" title="1 of 4 branches missed.">                &amp;&amp; theSubKeyType == myThat.getSubKeyType();</span>
    }

    @Override
    public int hashCode() {
<span class="fc" id="L416">        return Objects.hash(theStreamKeyType, theKeyLength, theSubKeyType);</span>
    }

    /**
     * Default subKeyType.
     * @param pKeyType the keyType
     * @return the default
     */
    private static GordianStreamSubKeyType defaultSubKeyType(final GordianStreamKeyType pKeyType) {
        /* Switch on keyType */
<span class="pc bpc" id="L426" title="9 of 10 branches missed.">        switch (pKeyType) {</span>
            case SALSA20:
<span class="nc" id="L428">                return GordianSalsa20Key.STD;</span>
            case CHACHA20:
<span class="nc" id="L430">                return GordianChaCha20Key.STD;</span>
            case VMPC:
<span class="nc" id="L432">                return GordianVMPCKey.STD;</span>
            case SKEINXOF:
<span class="nc" id="L434">                return GordianSkeinXofKey.STATE1024;</span>
            case BLAKE2XOF:
<span class="nc" id="L436">                return GordianBlakeXofKey.BLAKE2XB;</span>
            case ELEPHANT:
<span class="nc" id="L438">                return GordianElephantKey.ELEPHANT160;</span>
            case ISAP:
<span class="nc" id="L440">                return GordianISAPKey.ISAPA128;</span>
            case ROMULUS:
<span class="nc" id="L442">                return GordianRomulusKey.ROMULUS_M;</span>
            case SPARKLE:
<span class="nc" id="L444">                return GordianSparkleKey.SPARKLE128_128;</span>
            default:
<span class="fc" id="L446">                return null;</span>
        }
    }

    /**
     * SubKeyType.
     */
    public interface GordianStreamSubKeyType {
    }

    /**
     * VMPC Key styles.
     */
<span class="fc" id="L459">    public enum GordianVMPCKey</span>
            implements GordianStreamSubKeyType {
        /**
         * VMPC.
         */
<span class="fc" id="L464">        STD,</span>

        /**
         * VMPC-KSA.
         */
<span class="fc" id="L469">        KSA;</span>
    }

    /**
     * Salsa20 Key styles.
     */
<span class="fc" id="L475">    public enum GordianSalsa20Key</span>
            implements GordianStreamSubKeyType {
        /**
         * Salsa20.
         */
<span class="fc" id="L480">        STD,</span>

        /**
         * XSalsa20.
         */
<span class="fc" id="L485">        XSALSA;</span>

        /**
         * Obtain required ivLength.
         * @return the ivLength
         */
        GordianLength requiredIVLength() {
<span class="fc bfc" id="L492" title="All 2 branches covered.">            switch (this) {</span>
                case STD:
<span class="fc" id="L494">                    return GordianLength.LEN_64;</span>
                case XSALSA:
                default:
<span class="fc" id="L497">                    return GordianLength.LEN_192;</span>
            }
        }
    }

    /**
     * ChaCha20 Key styles.
     */
<span class="fc" id="L505">    public enum GordianChaCha20Key</span>
            implements GordianStreamSubKeyType {
        /**
         * ChaCha20.
         */
<span class="fc" id="L510">        STD,</span>

        /**
         * ChaCha7539.
         */
<span class="fc" id="L515">        ISO7539,</span>

        /**
         * XChaCha20.
         */
<span class="fc" id="L520">        XCHACHA;</span>

        /**
         * Obtain required ivLength.
         * @return the ivLength
         */
        GordianLength requiredIVLength() {
<span class="fc bfc" id="L527" title="All 3 branches covered.">            switch (this) {</span>
                case STD:
<span class="fc" id="L529">                    return GordianLength.LEN_64;</span>
                case ISO7539:
<span class="fc" id="L531">                    return GordianLength.LEN_96;</span>
                case XCHACHA:
                default:
<span class="fc" id="L534">                    return GordianLength.LEN_192;</span>
            }
        }
    }

    /**
     * SkeinXof Key styles.
     */
<span class="fc" id="L542">    public enum GordianSkeinXofKey</span>
            implements GordianStreamSubKeyType {
        /**
         * 256State.
         */
<span class="fc" id="L547">        STATE256(GordianLength.LEN_256),</span>

        /**
         * 512State.
         */
<span class="fc" id="L552">        STATE512(GordianLength.LEN_512),</span>

        /**
         * 1024State.
         */
<span class="fc" id="L557">        STATE1024(GordianLength.LEN_1024);</span>

        /**
         * The length.
         */
        private final GordianLength theLength;

        /**
         * Constructor.
         * @param pLength the stateLength
         */
<span class="fc" id="L568">        GordianSkeinXofKey(final GordianLength pLength) {</span>
<span class="fc" id="L569">            theLength = pLength;</span>
<span class="fc" id="L570">        }</span>

        /**
         * Obtain length.
         * @return the length.
         */
        public GordianLength getLength() {
<span class="fc" id="L577">            return theLength;</span>
        }

        @Override
        public String toString() {
<span class="fc" id="L582">            return theLength.toString();</span>
        }

        /**
         * Obtain subKeyType for stateLength.
         * @param pLength the length
         * @return the subKeyType
         */
        public static GordianSkeinXofKey getKeyTypeForLength(final GordianLength pLength) {
<span class="nc bnc" id="L591" title="All 2 branches missed.">            for (GordianSkeinXofKey myType : values()) {</span>
<span class="nc bnc" id="L592" title="All 2 branches missed.">                if (pLength == myType.theLength) {</span>
<span class="nc" id="L593">                    return myType;</span>
                }
            }
<span class="nc" id="L596">            throw new IllegalArgumentException(&quot;Unsupported state length&quot;);</span>
        }
    }

    /**
     * BlakeXof Key styles.
     */
<span class="fc" id="L603">    public enum GordianBlakeXofKey</span>
            implements GordianStreamSubKeyType {
        /**
         * Blake2S.
         */
<span class="fc" id="L608">        BLAKE2XS,</span>

        /**
         * Blake2B.
         */
<span class="fc" id="L613">        BLAKE2XB;</span>

        @Override
        public String toString() {
<span class="fc bfc" id="L617" title="All 2 branches covered.">            return this == BLAKE2XB ? &quot;Blake2Xb&quot; : &quot;Blake2Xs&quot;;</span>
        }

        /**
         * Obtain required ivLength.
         * @return the ivLength
         */
        GordianLength requiredIVLength() {
<span class="fc bfc" id="L625" title="All 2 branches covered.">            switch (this) {</span>
                case BLAKE2XS:
<span class="fc" id="L627">                    return GordianLength.LEN_64;</span>
                case BLAKE2XB:
                default:
<span class="fc" id="L630">                    return GordianLength.LEN_128;</span>
            }
        }
    }

    /**
     * Elephant Key styles.
     */
<span class="fc" id="L638">    public enum GordianElephantKey</span>
            implements GordianStreamSubKeyType {
        /**
         * Elephant160.
         */
<span class="fc" id="L643">        ELEPHANT160,</span>

        /**
         * Elephant176.
         */
<span class="fc" id="L648">        ELEPHANT176,</span>

        /**
         * Elephant200.
         */
<span class="fc" id="L653">        ELEPHANT200;</span>

        @Override
        public String toString() {
<span class="fc" id="L657">            final String myBase = GordianStreamKeyType.ELEPHANT.toString();</span>
<span class="fc bfc" id="L658" title="All 3 branches covered.">            switch (this) {</span>
                case ELEPHANT160:
<span class="fc" id="L660">                    return myBase + &quot;160&quot;;</span>
                case ELEPHANT176:
<span class="fc" id="L662">                    return myBase + &quot;176&quot;;</span>
                case ELEPHANT200:
                default:
<span class="fc" id="L665">                    return myBase + &quot;200&quot;;</span>
            }
        }

        /**
         * Obtain the elephant parameters.
         * @return the parameters
         */
        public ElephantParameters getParameters() {
<span class="fc bfc" id="L674" title="All 3 branches covered.">            switch (this) {</span>
                case ELEPHANT160:
<span class="fc" id="L676">                    return ElephantParameters.elephant160;</span>
                case ELEPHANT176:
<span class="fc" id="L678">                    return ElephantParameters.elephant176;</span>
                case ELEPHANT200:
                default:
<span class="fc" id="L681">                    return ElephantParameters.elephant200;</span>
            }
        }
    }

    /**
     * ISAP Key styles.
     */
<span class="fc" id="L689">    public enum GordianISAPKey</span>
            implements GordianStreamSubKeyType {
        /**
         * ISAPA128.
         */
<span class="fc" id="L694">        ISAPA128,</span>

        /**
         * ISAPA128A.
         */
<span class="fc" id="L699">        ISAPA128A,</span>

        /**
         * ISAPK128.
         */
<span class="fc" id="L704">        ISAPK128,</span>

        /**
         * ISAPK128A.
         */
<span class="fc" id="L709">        ISAPK128A;</span>

        @Override
        public String toString() {
<span class="fc" id="L713">            final String myBase = GordianStreamKeyType.ISAP.toString();</span>
<span class="fc bfc" id="L714" title="All 4 branches covered.">            switch (this) {</span>
                case ISAPA128:
<span class="fc" id="L716">                    return myBase + &quot;A128&quot;;</span>
                case ISAPA128A:
<span class="fc" id="L718">                    return myBase + &quot;A128A&quot;;</span>
                case ISAPK128:
<span class="fc" id="L720">                    return myBase + &quot;K128&quot;;</span>
                case ISAPK128A:
                default:
<span class="fc" id="L723">                    return myBase + &quot;K128A&quot;;</span>
            }
        }

        /**
         * Obtain the ISAP type.
         * @return the type
         */
        public IsapType getType() {
<span class="fc bfc" id="L732" title="All 4 branches covered.">            switch (this) {</span>
                case ISAPA128:
<span class="fc" id="L734">                    return IsapType.ISAP_A_128;</span>
                case ISAPA128A:
<span class="fc" id="L736">                    return IsapType.ISAP_A_128A;</span>
                case ISAPK128:
<span class="fc" id="L738">                    return IsapType.ISAP_K_128;</span>
                case ISAPK128A:
                default:
<span class="fc" id="L741">                    return IsapType.ISAP_K_128A;</span>
            }
        }
    }

    /**
     * Romulus Key styles.
     */
<span class="fc" id="L749">    public enum GordianRomulusKey</span>
            implements GordianStreamSubKeyType {
        /**
         * Romulus-M.
         */
<span class="fc" id="L754">        ROMULUS_M,</span>

        /**
         * Romulus-N.
         */
<span class="fc" id="L759">        ROMULUS_N,</span>

        /**
         * Romulus-T.
         */
<span class="fc" id="L764">        ROMULUS_T;</span>

        @Override
        public String toString() {
<span class="fc" id="L768">            final String myBase = GordianStreamKeyType.ROMULUS.toString();</span>
<span class="fc bfc" id="L769" title="All 3 branches covered.">            switch (this) {</span>
                case ROMULUS_M:
<span class="fc" id="L771">                    return myBase + &quot;-M&quot;;</span>
                case ROMULUS_N:
<span class="fc" id="L773">                    return myBase + &quot;-N&quot;;</span>
                case ROMULUS_T:
                default:
<span class="fc" id="L776">                    return myBase + &quot;-T&quot;;</span>
            }
        }

        /**
         * Obtain the RomulusParameters.
         * @return the parameters
         */
        public RomulusParameters getParameters() {
<span class="fc bfc" id="L785" title="All 3 branches covered.">            switch (this) {</span>
                case ROMULUS_M:
<span class="fc" id="L787">                    return RomulusParameters.RomulusM;</span>
                case ROMULUS_N:
<span class="fc" id="L789">                    return RomulusParameters.RomulusN;</span>
                case ROMULUS_T:
                default:
<span class="fc" id="L792">                    return RomulusParameters.RomulusT;</span>
            }
        }
    }

    /**
     * Sparkle Key styles.
     */
<span class="fc" id="L800">    public enum GordianSparkleKey</span>
            implements GordianStreamSubKeyType {
        /**
         * Sparkle128_128.
         */
<span class="fc" id="L805">        SPARKLE128_128,</span>

        /**
         * Sparkle256_128.
         */
<span class="fc" id="L810">        SPARKLE256_128,</span>

        /**
         * Sparkle192_192.
         */
<span class="fc" id="L815">        SPARKLE192_192,</span>

        /**
         * Sparkle256_256.
         */
<span class="fc" id="L820">        SPARKLE256_256;</span>

        @Override
        public String toString() {
<span class="fc" id="L824">            final String myBase = GordianStreamKeyType.SPARKLE.toString();</span>
<span class="fc bfc" id="L825" title="All 4 branches covered.">            switch (this) {</span>
                case SPARKLE128_128:
<span class="fc" id="L827">                    return myBase + &quot;128_128&quot;;</span>
                case SPARKLE256_128:
<span class="fc" id="L829">                    return myBase + &quot;256_128&quot;;</span>
                case SPARKLE192_192:
<span class="fc" id="L831">                    return myBase + &quot;192_192&quot;;</span>
                case SPARKLE256_256:
                default:
<span class="fc" id="L834">                    return myBase + &quot;256_256&quot;;</span>
            }
        }

        /**
         * Obtain required keyLength.
         * @return the keyLength
         */
        GordianLength requiredKeyLength() {
<span class="fc bfc" id="L843" title="All 3 branches covered.">            switch (this) {</span>
                case SPARKLE128_128:
                case SPARKLE256_128:
<span class="fc" id="L846">                    return GordianLength.LEN_128;</span>
                case SPARKLE192_192:
<span class="fc" id="L848">                    return GordianLength.LEN_192;</span>
                case SPARKLE256_256:
                default:
<span class="fc" id="L851">                    return GordianLength.LEN_256;</span>
            }
        }

        /**
         * Obtain required ivLength.
         * @return the ivLength
         */
        GordianLength requiredIVLength() {
<span class="fc bfc" id="L860" title="All 3 branches covered.">            switch (this) {</span>
                case SPARKLE128_128:
<span class="fc" id="L862">                    return GordianLength.LEN_128;</span>
                case SPARKLE192_192:
<span class="fc" id="L864">                    return GordianLength.LEN_192;</span>
                case SPARKLE256_128:
                case SPARKLE256_256:
                default:
<span class="fc" id="L868">                    return GordianLength.LEN_256;</span>
            }
        }

        /**
         * Obtain the Sparkle parameters.
         * @return the parameters
         */
        public SparkleParameters getParameters() {
<span class="fc bfc" id="L877" title="All 4 branches covered.">            switch (this) {</span>
                case SPARKLE128_128:
<span class="fc" id="L879">                    return SparkleParameters.SCHWAEMM128_128;</span>
                case SPARKLE256_128:
<span class="fc" id="L881">                    return SparkleParameters.SCHWAEMM256_128;</span>
                case SPARKLE192_192:
<span class="fc" id="L883">                    return SparkleParameters.SCHWAEMM192_192;</span>
                case SPARKLE256_256:
                default:
<span class="fc" id="L886">                    return SparkleParameters.SCHWAEMM256_256;</span>
            }
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>