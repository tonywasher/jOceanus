<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0 from src/site/xdoc/ext/zip.xml at 2026-01-22
 | Rendered using Apache Maven Fluido Skin 2.0.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 2.0.0" />
    <meta name="author" content="Tony Washer" />
    <title>GordianKnot ZipFile Support – GordianKnot Security Framework</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-2.0.1.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
    <script src="../js/apache-maven-fluido-2.0.1.min.js"></script>
  </head>
  <body class="topBarEnabled">
    <header id="topbar" class="navbar navbar-fixed-top ">
      <div class="navbar-inner">
        <div class="container-fluid">
        <a data-target=".nav-collapse" data-toggle="collapse" class="btn btn-navbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
            <ul class="nav">
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown">GordianKnot <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li><a href="../index.html">Introduction</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown">Parent Project <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li><a href="../../index.html">Java Oceanus package</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown">Project Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li class="dropdown-submenu">
<a href="../project-info.html">Project Information</a>
              <ul class="dropdown-menu">
                  <li><a href="../dependencies.html">Dependencies</a></li>
                  <li><a href="../dependency-info.html">Maven Coordinates</a></li>
                  <li><a href="../distribution-management.html">Distribution Management</a></li>
                  <li><a href="../index.html">About</a></li>
                  <li><a href="../issue-management.html">Issue Management</a></li>
                  <li><a href="../licenses.html">Licenses</a></li>
                  <li><a href="../plugin-management.html">Plugin Management</a></li>
                  <li><a href="../plugins.html">Plugins</a></li>
                  <li><a href="../scm.html">Source Code Management</a></li>
                  <li><a href="../summary.html">Summary</a></li>
                  <li><a href="../team.html">Team</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
<a href="../project-reports.html">Project Reports</a>
              <ul class="dropdown-menu">
                  <li><a href="../checkstyle.html">Checkstyle</a></li>
                  <li><a href="../cpd.html">CPD</a></li>
                  <li><a href="../pmd.html">PMD</a></li>
                  <li><a href="../jacoco/index.html">JaCoCo</a></li>
                  <li><a href="../surefire.html">Surefire</a></li>
              </ul>
            </li>
        </ul>
      </li>
            </ul>
        </div>
      </div>
    </header>
    <div class="container-fluid container-fluid-top">
      <header>
        <div id="banner">
          <div class="pull-left"></div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2026-01-22<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.6.3-b6</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">GordianKnot</li>
    <li><a href="../index.html">Introduction</a></li>
   <li class="nav-header">Parent Project</li>
    <li><a href="../../index.html">Java Oceanus package</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="../project-info.html"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="../project-reports.html"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
<a href="https://maven.apache.org/" class="builtBy" target="_blank"><img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn" class="span10">

    
        <section><a id="GordianKnot_ZipFile_Support"></a>
<h1>GordianKnot ZipFile Support</h1>
            <section><a id="Overview"></a>
<h2>Overview</h2>
                
<p>ZipFiles are supported via the <strong>GordianZipFactory</strong> interface.</p>
                
<p>GordianKnot provides support for to creating and reading encrypted ZipFiles.
                    This is built on top of the Java ZipFile support and utilises the encryption facilities of GordianKnot to encrypt and
                    decrypt each file entry. LZMA compression is also provided (based on the 7-Zip LZMA SDK), which provides significantly
                    improved compression over the Deflation standard Java method.</p>
                
<p>Encryption is performed in a similar fashion to KeySet encryption, as follows (N = number of configured encryption steps),
                    although all keys and initialisationVectors are randomly generated per zipEntry. The selection of encryption algorithms is
                    also randomly done rather than from a seed value</p>
                
<ol style="list-style-type: decimal;">
                    
<li>Digest is calculated on the plain text</li>
                    
<li>LZMA compression is performed</li>
                    
<li>StreamKey encryption is performed</li>
                    
<li>(N-1)*SymKey ECB encryption (first with ISO7816-4 padding, remainder with NONE)</li>
                    
<li>SymKey SIC encryption</li>
                    
<li>Mac calculated on encrypted data</li>
                </ol>
                
<p>All filenames in the public zipFile directory are written as File1, File2 etc to further hide information</p>.
                
<p>The names of the files, and the (wrapped) encryption details are written as an encrypted final zipEntry</p>
                
<p>The keySetHash used to encrypt the final file entry is recorded as additionalData for the directory entry</p>
                
<p>Note that updating of ZipFiles is not supported, only creation and extraction.</p>
            </section>
            <section><a id="ZipLocks"></a>
<h2>ZipLocks</h2>
                
<p>Each zip file is secured using a zipLock structure, which at its core is a lock. Any of the three supported lock types can be used</p>
            </section>
            <section><a id="Sample_Creation_of_Encrypted_ZipFile"></a>
<h2>Sample Creation of Encrypted ZipFile</h2>
                
<p>The following sample reads a designated file directory and creates an encrypted zipFile of the contents</p>
                
<pre class="prettyprint"><code>
/* Access factory */
final GordianFactory myBaseFactory = GordianGenerator.createFactory();
final GordianLockFactory myLockFactory = myBaseFactory.getLockFactory();
final GordianZipFactory myZipFactory = myBaseFactory.getZipFactory();

/* Create new Lock */
final char[] myPassword = .....
final GordianPasswordLockSpec mySpec = new GordianKeySetHashSpec(new GordianKeySetSpec(pKeyLen));
final GordianLock myLock = myLockFactory.createFactoryLock(mySpec, myPassword);
final GordianZipLock myZipLock = myZipFactory.createZipLock(myLock);

/* Initialise the Zip file */
final ByteArrayOutputStream myZipStream = new ByteArrayOutputStream();
final GordianZipWriteFile myZipFile = myZipFactory.createZipFile(myZipLock, myZipStream);

/* Obtain list of files */
file File myDirectory = ....
final File[] myFiles = pDirectory.listFiles();

/* Loop through the files in the directory */
for (File myFile : myFiles) {
    /* Skip directories */
    if (myFile.isDirectory()) {
        continue;
    }

    /* Open the file for reading */
    InputStream myInFile = new FileInputStream(myFile);
    InputStream myInBuffer = new BufferedInputStream(myInFile);

    /* Open the zipEntry stream */
    OutputStream myOutput = myZipFile.createOutputStream(new File(myFile.getName()), true);

    /* Copy file content to zip file */
    myInBuffer.transferTo(myOutput);

    /* Close files */
    myInBuffer.close();
    myOutput.close();
}

/* Close Zip file */
myZipFile.close();

/* ZipFile as byte array */
final byte[] myBytes = myZipStream.toByteArray();
                </code></pre>
            </section>
            <section><a id="Sample_Parsing_of_Encrypted_ZipFile"></a>
<h2>Sample Parsing of Encrypted ZipFile</h2>
                
<p>The following sample reads the contents of an encrypted zipFile</p>
                
<pre class="prettyprint"><code>
/* Access factory */
final GordianFactory myBaseFactory = GordianGenerator.createFactory();
final GordianZipFactory myZipFactory = myBaseFactory.getZipFactory();

/* Access the file (bytes from previous sample) */
final ByteArrayInputStream myInputStream = new ByteArrayInputStream(myBytes);
final GordianZipReadFile myZipFile = myZipMgr.openZipFile(myInputStream);

/* Unlock the file */
final GordianLock myLock = myZipFile.getLock();
final char[] myPassword = ....
myLock.unlock(myPassword);

/* Access the contents */
final GordianZipFileContents myContents = myZipFile.getContents();

/* Loop through the entries */
final Iterator&lt;GordianZipFileEntry&gt; myIterator = myContents.iterator();
while (myIterator.hasNext()) {
    /* Access next entry */
    final GordianZipFileEntry myEntry = myIterator.next();
    final InputStream myZipInput = myZipFile.createInputStream(myEntry);

    /* Read the data */
    final byte[] myZipData = myZipInput.readAllBytes();
}

/* Close Zip file */
myZipFile.close();
                </code></pre>
            </section>
        </section>
    
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>©      2012–2026
</p>
        </div>
      </div>
    </footer>
  </body>
</html>
