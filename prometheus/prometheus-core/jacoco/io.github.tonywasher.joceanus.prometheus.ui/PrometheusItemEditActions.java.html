<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PrometheusItemEditActions.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Prometheus Core Application Framework</a> &gt; <a href="index.source.html" class="el_package">io.github.tonywasher.joceanus.prometheus.ui</a> &gt; <span class="el_source">PrometheusItemEditActions.java</span></div><h1>PrometheusItemEditActions.java</h1><pre class="source lang-java linenums">/*
 * Prometheus: Application Framework
 * Copyright 2012-2026. Tony Washer
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not
 * use this file except in compliance with the License.  You may obtain a copy
 * of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */
package io.github.tonywasher.joceanus.prometheus.ui;

import io.github.tonywasher.joceanus.oceanus.event.OceanusEventManager;
import io.github.tonywasher.joceanus.oceanus.event.OceanusEventRegistrar;
import io.github.tonywasher.joceanus.oceanus.event.OceanusEventRegistrar.OceanusEventProvider;
import io.github.tonywasher.joceanus.metis.ui.MetisIcon;
import io.github.tonywasher.joceanus.prometheus.views.PrometheusUIEvent;
import io.github.tonywasher.joceanus.tethys.api.base.TethysUIComponent;
import io.github.tonywasher.joceanus.tethys.api.button.TethysUIButton;
import io.github.tonywasher.joceanus.tethys.api.button.TethysUIButtonFactory;
import io.github.tonywasher.joceanus.tethys.api.factory.TethysUIFactory;
import io.github.tonywasher.joceanus.tethys.api.pane.TethysUIBoxPaneManager;

/**
 * Item Edit Action buttons.
 */
public class PrometheusItemEditActions
        implements OceanusEventProvider&lt;PrometheusUIEvent&gt;, TethysUIComponent {
    /**
     * ItemEditParent interface.
     */
    public interface PrometheusItemEditParent {
        /**
         * Is the item editable?
         *
         * @return true/false
         */
        boolean isEditable();

        /**
         * Is the item deletable?
         *
         * @return true/false
         */
        boolean isDeletable();

        /**
         * Does the parent have updates.
         *
         * @return true/false
         */
        boolean hasUpdates();

        /**
         * Does the parent have errors.
         *
         * @return true/false
         */
        boolean hasErrors();

        /**
         * Is the parent new.
         *
         * @return true/false
         */
        boolean isNew();
    }

    /**
     * The panel.
     */
    private final TethysUIBoxPaneManager thePanel;

    /**
     * The Event Manager.
     */
    private final OceanusEventManager&lt;PrometheusUIEvent&gt; theEventManager;

    /**
     * The parent.
     */
    private final PrometheusItemEditParent theParent;

    /**
     * The Commit button.
     */
    private final TethysUIButton theCommitButton;

    /**
     * The Undo button.
     */
    private final TethysUIButton theUndoButton;

    /**
     * The Reset button.
     */
    private final TethysUIButton theResetButton;

    /**
     * The Cancel button.
     */
    private final TethysUIButton theCancelButton;

    /**
     * Constructor.
     *
     * @param pFactory the GUI factory
     * @param pParent  the parent
     */
    public PrometheusItemEditActions(final TethysUIFactory&lt;?&gt; pFactory,
<span class="nc" id="L117">                                     final PrometheusItemEditParent pParent) {</span>
        /* Record the parent */
<span class="nc" id="L119">        theParent = pParent;</span>

        /* Create the event manager */
<span class="nc" id="L122">        theEventManager = new OceanusEventManager&lt;&gt;();</span>

        /* Create the buttons */
<span class="nc" id="L125">        final TethysUIButtonFactory&lt;?&gt; myButtons = pFactory.buttonFactory();</span>
<span class="nc" id="L126">        theCommitButton = myButtons.newButton();</span>
<span class="nc" id="L127">        theUndoButton = myButtons.newButton();</span>
<span class="nc" id="L128">        theResetButton = myButtons.newButton();</span>
<span class="nc" id="L129">        theCancelButton = myButtons.newButton();</span>

        /* Configure the buttons */
<span class="nc" id="L132">        MetisIcon.configureCommitIconButton(theCommitButton);</span>
<span class="nc" id="L133">        MetisIcon.configureUndoIconButton(theUndoButton);</span>
<span class="nc" id="L134">        MetisIcon.configureResetIconButton(theResetButton);</span>
<span class="nc" id="L135">        MetisIcon.configureCancelIconButton(theCancelButton);</span>

        /* Create the panel */
<span class="nc" id="L138">        thePanel = pFactory.paneFactory().newVBoxPane();</span>
<span class="nc" id="L139">        thePanel.setBorderPadding(PrometheusItemActions.BORDER_PADDING);</span>

        /* Create the layout */
<span class="nc" id="L142">        thePanel.addNode(theCommitButton);</span>
<span class="nc" id="L143">        thePanel.addNode(theUndoButton);</span>
<span class="nc" id="L144">        thePanel.addNode(theResetButton);</span>
<span class="nc" id="L145">        thePanel.addNode(theCancelButton);</span>

        /* Add the listener for item changes */
<span class="nc" id="L148">        theCommitButton.getEventRegistrar().addEventListener(e -&gt; theEventManager.fireEvent(PrometheusUIEvent.OK));</span>
<span class="nc" id="L149">        theUndoButton.getEventRegistrar().addEventListener(e -&gt; theEventManager.fireEvent(PrometheusUIEvent.UNDO));</span>
<span class="nc" id="L150">        theResetButton.getEventRegistrar().addEventListener(e -&gt; theEventManager.fireEvent(PrometheusUIEvent.RESET));</span>
<span class="nc" id="L151">        theCancelButton.getEventRegistrar().addEventListener(e -&gt; theEventManager.fireEvent(PrometheusUIEvent.CANCEL));</span>

        /* Buttons are initially disabled */
<span class="nc" id="L154">        setEnabled(false);</span>
<span class="nc" id="L155">    }</span>

    @Override
    public OceanusEventRegistrar&lt;PrometheusUIEvent&gt; getEventRegistrar() {
<span class="nc" id="L159">        return theEventManager.getEventRegistrar();</span>
    }

    @Override
    public TethysUIComponent getUnderlying() {
<span class="nc" id="L164">        return thePanel;</span>
    }

    @Override
    public void setEnabled(final boolean bEnabled) {
        /* If the table is locked clear the buttons */
<span class="nc bnc" id="L170" title="All 2 branches missed.">        if (!bEnabled) {</span>
<span class="nc" id="L171">            theCommitButton.setEnabled(false);</span>
<span class="nc" id="L172">            theUndoButton.setEnabled(false);</span>
<span class="nc" id="L173">            theResetButton.setEnabled(false);</span>
<span class="nc" id="L174">            theCancelButton.setEnabled(false);</span>

            /* Else look at the edit state */
        } else {
            /* Determine whether we have changes */
<span class="nc" id="L179">            boolean hasUpdates = theParent.hasUpdates();</span>
<span class="nc" id="L180">            theUndoButton.setEnabled(hasUpdates);</span>
<span class="nc" id="L181">            theResetButton.setEnabled(hasUpdates);</span>

            /* Check for no errors */
<span class="nc" id="L184">            final boolean hasErrors = theParent.hasErrors();</span>
<span class="nc" id="L185">            hasUpdates |= theParent.isNew();</span>
<span class="nc bnc" id="L186" title="All 4 branches missed.">            theCommitButton.setEnabled(hasUpdates &amp;&amp; !hasErrors);</span>

            /* Enable the cancel button */
<span class="nc" id="L189">            theCancelButton.setEnabled(true);</span>
        }
<span class="nc" id="L191">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>