<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>MoneyWiseCategoryPanel.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">MoneyWise Personal Finance - Core</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.joceanus.moneywise.ui.panel</a> &gt; <span class="el_source">MoneyWiseCategoryPanel.java</span></div><h1>MoneyWiseCategoryPanel.java</h1><pre class="source lang-java linenums">/*******************************************************************************
 * MoneyWise: Finance Application
 * Copyright 2012,2025 Tony Washer
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not
 * use this file except in compliance with the License.  You may obtain a copy
 * of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations under
 * the License.
 ******************************************************************************/
package net.sourceforge.joceanus.moneywise.ui.panel;

import net.sourceforge.joceanus.metis.ui.MetisErrorPanel;
import net.sourceforge.joceanus.metis.viewer.MetisViewerEntry;
import net.sourceforge.joceanus.metis.viewer.MetisViewerManager;
import net.sourceforge.joceanus.moneywise.data.basic.MoneyWiseBasicDataType;
import net.sourceforge.joceanus.moneywise.data.basic.MoneyWiseCashCategory;
import net.sourceforge.joceanus.moneywise.data.basic.MoneyWiseDepositCategory;
import net.sourceforge.joceanus.moneywise.data.basic.MoneyWiseLoanCategory;
import net.sourceforge.joceanus.moneywise.data.basic.MoneyWiseRegion;
import net.sourceforge.joceanus.moneywise.data.basic.MoneyWiseTransCategory;
import net.sourceforge.joceanus.moneywise.data.basic.MoneyWiseTransTag;
import net.sourceforge.joceanus.moneywise.ui.MoneyWiseGoToId;
import net.sourceforge.joceanus.moneywise.ui.MoneyWiseUIResource;
import net.sourceforge.joceanus.moneywise.views.MoneyWiseView;
import net.sourceforge.joceanus.oceanus.event.OceanusEventRegistrar.OceanusEventProvider;
import net.sourceforge.joceanus.prometheus.ui.PrometheusActionButtons;
import net.sourceforge.joceanus.prometheus.ui.PrometheusGoToEvent;
import net.sourceforge.joceanus.prometheus.views.PrometheusDataEvent;
import net.sourceforge.joceanus.prometheus.views.PrometheusEditSet;
import net.sourceforge.joceanus.prometheus.views.PrometheusUIEvent;
import net.sourceforge.joceanus.prometheus.views.PrometheusViewerEntryId;
import net.sourceforge.joceanus.oceanus.base.OceanusException;
import net.sourceforge.joceanus.oceanus.event.OceanusEvent;
import net.sourceforge.joceanus.oceanus.event.OceanusEventManager;
import net.sourceforge.joceanus.oceanus.event.OceanusEventRegistrar;
import net.sourceforge.joceanus.oceanus.profile.OceanusProfile;
import net.sourceforge.joceanus.tethys.api.base.TethysUIComponent;
import net.sourceforge.joceanus.tethys.api.base.TethysUIEvent;
import net.sourceforge.joceanus.tethys.api.button.TethysUIScrollButtonManager;
import net.sourceforge.joceanus.tethys.api.control.TethysUILabel;
import net.sourceforge.joceanus.tethys.api.factory.TethysUIFactory;
import net.sourceforge.joceanus.tethys.api.menu.TethysUIScrollMenu;
import net.sourceforge.joceanus.tethys.api.pane.TethysUIBorderPaneManager;
import net.sourceforge.joceanus.tethys.api.pane.TethysUIBoxPaneManager;
import net.sourceforge.joceanus.tethys.api.pane.TethysUICardPaneManager;
import net.sourceforge.joceanus.tethys.api.pane.TethysUIPaneFactory;

/**
 * Category panel.
 */
public class MoneyWiseCategoryPanel
        implements OceanusEventProvider&lt;PrometheusDataEvent&gt;, TethysUIComponent {
    /**
     * Text for DataEntry Title.
     */
<span class="nc" id="L63">    private static final String NLS_DATAENTRY = MoneyWiseUIResource.CATEGORY_DATAENTRY.getValue();</span>

    /**
     * Text for Selection Title.
     */
<span class="nc" id="L68">    private static final String NLS_SELECT = MoneyWiseUIResource.CATEGORY_TITLE_SELECT.getValue();</span>

    /**
     * Text for Selection Prompt.
     */
<span class="nc" id="L73">    private static final String NLS_DATA = MoneyWiseUIResource.CATEGORY_PROMPT_SELECT.getValue();</span>

    /**
     * The Event Manager.
     */
    private final OceanusEventManager&lt;PrometheusDataEvent&gt; theEventManager;

    /**
     * The Data View.
     */
    private final MoneyWiseView theView;

    /**
     * The Panel.
     */
    private final TethysUIBorderPaneManager thePanel;

    /**
     * The select button.
     */
    private final TethysUIScrollButtonManager&lt;PanelName&gt; theSelectButton;

    /**
     * The card panel.
     */
    private final TethysUICardPaneManager&lt;TethysUIComponent&gt; theCardPanel;

    /**
     * The select panel.
     */
    private final TethysUIBorderPaneManager theSelectPanel;

    /**
     * The filter card panel.
     */
    private final TethysUICardPaneManager&lt;TethysUIComponent&gt; theFilterCardPanel;

    /**
     * Deposit Categories Table.
     */
    private final MoneyWiseDepositCategoryTable theDepositTable;

    /**
     * Cash Categories Table.
     */
    private final MoneyWiseCashCategoryTable theCashTable;

    /**
     * Loan Categories Table.
     */
    private final MoneyWiseLoanCategoryTable theLoanTable;

    /**
     * Transaction Categories Table.
     */
    private final MoneyWiseTransCategoryTable theEventTable;

    /**
     * Event Tags Table.
     */
    private final MoneyWiseTransTagTable theTagTable;

    /**
     * Regions Table.
     */
    private final MoneyWiseRegionTable theRegionTable;

    /**
     * The UpdateSet.
     */
    private final PrometheusEditSet theEditSet;

    /**
     * The viewer entry.
     */
    private final MetisViewerEntry theViewerEntry;

    /**
     * The action buttons panel.
     */
    private final PrometheusActionButtons theActionButtons;

    /**
     * The error panel.
     */
    private final MetisErrorPanel theError;

    /**
     * Are we refreshing?
     */
    private boolean isRefreshing;

    /**
     * The active panel.
     */
    private PanelName theActive;

    /**
     * Constructor.
     * @param pView the data view
     */
<span class="nc" id="L174">    MoneyWiseCategoryPanel(final MoneyWiseView pView) {</span>
        /* Store details */
<span class="nc" id="L176">        theView = pView;</span>

        /* Access GUI Factory */
<span class="nc" id="L179">        final TethysUIFactory&lt;?&gt; myFactory = pView.getGuiFactory();</span>
<span class="nc" id="L180">        final MetisViewerManager myViewer = pView.getViewerManager();</span>

        /* Create the event manager */
<span class="nc" id="L183">        theEventManager = new OceanusEventManager&lt;&gt;();</span>

        /* Build the Update set */
<span class="nc" id="L186">        theEditSet = new PrometheusEditSet(pView);</span>

        /* Create the Panel */
<span class="nc" id="L189">        final TethysUIPaneFactory myPanes = myFactory.paneFactory();</span>
<span class="nc" id="L190">        thePanel = myPanes.newBorderPane();</span>

        /* Create the top level viewer entry for this view */
<span class="nc" id="L193">        final MetisViewerEntry mySection = pView.getViewerEntry(PrometheusViewerEntryId.MAINTENANCE);</span>
<span class="nc" id="L194">        theViewerEntry = myViewer.newEntry(mySection, NLS_DATAENTRY);</span>
<span class="nc" id="L195">        theViewerEntry.setTreeObject(theEditSet);</span>

        /* Create the error panel */
<span class="nc" id="L198">        theError = pView.getToolkit().getToolkit().newErrorPanel(theViewerEntry);</span>

        /* Create the action buttons panel */
<span class="nc" id="L201">        theActionButtons = new PrometheusActionButtons(myFactory, theEditSet);</span>

        /* Create the table panels */
<span class="nc" id="L204">        theDepositTable = new MoneyWiseDepositCategoryTable(pView, theEditSet, theError);</span>
<span class="nc" id="L205">        theCashTable = new MoneyWiseCashCategoryTable(pView, theEditSet, theError);</span>
<span class="nc" id="L206">        theLoanTable = new MoneyWiseLoanCategoryTable(pView, theEditSet, theError);</span>
<span class="nc" id="L207">        theEventTable = new MoneyWiseTransCategoryTable(pView, theEditSet, theError);</span>
<span class="nc" id="L208">        theTagTable = new MoneyWiseTransTagTable(pView, theEditSet, theError);</span>
<span class="nc" id="L209">        theRegionTable = new MoneyWiseRegionTable(pView, theEditSet, theError);</span>

        /* Create selection button and label */
<span class="nc" id="L212">        final TethysUILabel myLabel = myFactory.controlFactory().newLabel(NLS_DATA);</span>
<span class="nc" id="L213">        theSelectButton = myFactory.buttonFactory().newScrollButton(PanelName.class);</span>
<span class="nc" id="L214">        buildSelectMenu();</span>

        /* Create the card panel */
<span class="nc" id="L217">        theCardPanel = myPanes.newCardPane();</span>

        /* Add to the card panels */
<span class="nc" id="L220">        theCardPanel.addCard(PanelName.DEPOSITS.toString(), theDepositTable);</span>
<span class="nc" id="L221">        theCardPanel.addCard(PanelName.CASH.toString(), theCashTable);</span>
<span class="nc" id="L222">        theCardPanel.addCard(PanelName.LOANS.toString(), theLoanTable);</span>
<span class="nc" id="L223">        theCardPanel.addCard(PanelName.EVENTS.toString(), theEventTable);</span>
<span class="nc" id="L224">        theCardPanel.addCard(PanelName.EVENTTAGS.toString(), theTagTable);</span>
<span class="nc" id="L225">        theCardPanel.addCard(PanelName.REGIONS.toString(), theRegionTable);</span>
<span class="nc" id="L226">        theActive = PanelName.DEPOSITS;</span>
<span class="nc" id="L227">        theSelectButton.setValue(theActive);</span>

        /* Create the card panel */
<span class="nc" id="L230">        theFilterCardPanel = myPanes.newCardPane();</span>

        /* Add to the card panels */
<span class="nc" id="L233">        theFilterCardPanel.addCard(PanelName.DEPOSITS.toString(), theDepositTable.getFilterPanel());</span>
<span class="nc" id="L234">        theFilterCardPanel.addCard(PanelName.CASH.toString(), theCashTable.getFilterPanel());</span>
<span class="nc" id="L235">        theFilterCardPanel.addCard(PanelName.LOANS.toString(), theLoanTable.getFilterPanel());</span>
<span class="nc" id="L236">        theFilterCardPanel.addCard(PanelName.EVENTS.toString(), theEventTable.getFilterPanel());</span>
<span class="nc" id="L237">        theFilterCardPanel.addCard(PanelName.EVENTTAGS.toString(), theTagTable.getFilterPanel());</span>
<span class="nc" id="L238">        theFilterCardPanel.addCard(PanelName.REGIONS.toString(), theRegionTable.getFilterPanel());</span>

        /* Create the select prompt */
<span class="nc" id="L241">        final TethysUIBoxPaneManager mySelect = myPanes.newHBoxPane();</span>
<span class="nc" id="L242">        mySelect.addNode(myLabel);</span>
<span class="nc" id="L243">        mySelect.addNode(theSelectButton);</span>

        /* Create the selection panel */
<span class="nc" id="L246">        theSelectPanel = myPanes.newBorderPane();</span>
<span class="nc" id="L247">        theSelectPanel.setBorderTitle(NLS_SELECT);</span>
<span class="nc" id="L248">        theSelectPanel.setWest(mySelect);</span>
<span class="nc" id="L249">        theSelectPanel.setCentre(theFilterCardPanel);</span>

        /* Create the header panel */
<span class="nc" id="L252">        final TethysUIBorderPaneManager myHeader = myPanes.newBorderPane();</span>
<span class="nc" id="L253">        myHeader.setCentre(theSelectPanel);</span>
<span class="nc" id="L254">        myHeader.setNorth(theError);</span>
<span class="nc" id="L255">        myHeader.setEast(theActionButtons);</span>

        /* Now define the panel */
<span class="nc" id="L258">        thePanel.setNorth(myHeader);</span>
<span class="nc" id="L259">        thePanel.setCentre(theCardPanel);</span>

        /* Hide the action buttons initially */
<span class="nc" id="L262">        theActionButtons.setVisible(false);</span>

        /* Create the listeners */
<span class="nc" id="L265">        theSelectButton.getEventRegistrar().addEventListener(TethysUIEvent.NEWVALUE, e -&gt; handleSelection());</span>
<span class="nc" id="L266">        theError.getEventRegistrar().addEventListener(e -&gt; handleErrorPane());</span>
<span class="nc" id="L267">        theActionButtons.getEventRegistrar().addEventListener(this::handleActionButtons);</span>
<span class="nc" id="L268">        setChildListeners(theDepositTable.getEventRegistrar());</span>
<span class="nc" id="L269">        setChildListeners(theCashTable.getEventRegistrar());</span>
<span class="nc" id="L270">        setChildListeners(theLoanTable.getEventRegistrar());</span>
<span class="nc" id="L271">        setChildListeners(theEventTable.getEventRegistrar());</span>
<span class="nc" id="L272">        setChildListeners(theTagTable.getEventRegistrar());</span>
<span class="nc" id="L273">        setChildListeners(theRegionTable.getEventRegistrar());</span>
<span class="nc" id="L274">    }</span>

    @Override
    public TethysUIComponent getUnderlying() {
<span class="nc" id="L278">        return thePanel;</span>
    }

    @Override
    public OceanusEventRegistrar&lt;PrometheusDataEvent&gt; getEventRegistrar() {
<span class="nc" id="L283">        return theEventManager.getEventRegistrar();</span>
    }

    /**
     * setChildListeners.
     * @param pRegistrar the registrar
     */
    private void setChildListeners(final OceanusEventRegistrar&lt;PrometheusDataEvent&gt; pRegistrar) {
<span class="nc" id="L291">        pRegistrar.addEventListener(PrometheusDataEvent.ADJUSTVISIBILITY, e -&gt; {</span>
<span class="nc bnc" id="L292" title="All 2 branches missed.">            if (!isRefreshing) {</span>
<span class="nc" id="L293">                setVisibility();</span>
            }
<span class="nc" id="L295">        });</span>
<span class="nc" id="L296">        pRegistrar.addEventListener(PrometheusDataEvent.GOTOWINDOW, this::handleGoToEvent);</span>
<span class="nc" id="L297">    }</span>

    @Override
    public void setEnabled(final boolean pEnabled) {
<span class="nc" id="L301">        theSelectButton.setEnabled(pEnabled);</span>
<span class="nc" id="L302">        theCardPanel.setEnabled(pEnabled);</span>
<span class="nc" id="L303">        theFilterCardPanel.setEnabled(pEnabled);</span>
<span class="nc" id="L304">    }</span>

    @Override
    public void setVisible(final boolean pVisible) {
<span class="nc" id="L308">        thePanel.setVisible(pVisible);</span>
<span class="nc" id="L309">    }</span>

    /**
     * Build select menu.
     */
    private void buildSelectMenu() {
        /* Create builder */
<span class="nc" id="L316">        final TethysUIScrollMenu&lt;PanelName&gt; myMenu = theSelectButton.getMenu();</span>

        /* Loop through the panels */
<span class="nc bnc" id="L319" title="All 2 branches missed.">        for (PanelName myPanel : PanelName.values()) {</span>
            /* Create a new MenuItem for the panel */
<span class="nc" id="L321">            myMenu.addItem(myPanel);</span>
        }
<span class="nc" id="L323">    }</span>

    /**
     * Refresh data.
     * @throws OceanusException on error
     */
    public void refreshData() throws OceanusException {
        /* Obtain the active profile */
<span class="nc" id="L331">        OceanusProfile myTask = theView.getActiveTask();</span>
<span class="nc" id="L332">        myTask = myTask.startTask(&quot;Categories&quot;);</span>

        /* Note that we are refreshing */
<span class="nc" id="L335">        isRefreshing = true;</span>
<span class="nc" id="L336">        theEditSet.setDataSet(theView.getData());</span>

        /* Refresh the tables */
<span class="nc" id="L339">        theDepositTable.refreshData();</span>
<span class="nc" id="L340">        theCashTable.refreshData();</span>
<span class="nc" id="L341">        theLoanTable.refreshData();</span>
<span class="nc" id="L342">        theEventTable.refreshData();</span>
<span class="nc" id="L343">        theTagTable.refreshData();</span>
<span class="nc" id="L344">        theRegionTable.refreshData();</span>

        /* Clear refreshing flag */
<span class="nc" id="L347">        isRefreshing = false;</span>
<span class="nc" id="L348">        setVisibility();</span>

        /* Touch the updateSet */
<span class="nc" id="L351">        theViewerEntry.setTreeObject(theEditSet);</span>

        /* Complete the task */
<span class="nc" id="L354">        myTask.end();</span>
<span class="nc" id="L355">    }</span>

    /**
     * Determine Focus.
     */
    public void determineFocus() {
        /* Switch on active component */
<span class="nc bnc" id="L362" title="All 7 branches missed.">        switch (theActive) {</span>
            case DEPOSITS:
<span class="nc" id="L364">                theDepositTable.determineFocus(theViewerEntry);</span>
<span class="nc" id="L365">                break;</span>
            case CASH:
<span class="nc" id="L367">                theCashTable.determineFocus(theViewerEntry);</span>
<span class="nc" id="L368">                break;</span>
            case LOANS:
<span class="nc" id="L370">                theLoanTable.determineFocus(theViewerEntry);</span>
<span class="nc" id="L371">                break;</span>
            case EVENTS:
<span class="nc" id="L373">                theEventTable.determineFocus(theViewerEntry);</span>
<span class="nc" id="L374">                break;</span>
            case EVENTTAGS:
<span class="nc" id="L376">                theTagTable.determineFocus(theViewerEntry);</span>
<span class="nc" id="L377">                break;</span>
            case REGIONS:
<span class="nc" id="L379">                theRegionTable.determineFocus(theViewerEntry);</span>
<span class="nc" id="L380">                break;</span>
            default:
                break;
        }
<span class="nc" id="L384">    }</span>

    /**
     * Does this panel have updates?
     * @return true/false
     */
    public boolean hasUpdates() {
        /* Determine whether we have updates */
<span class="nc" id="L392">        boolean hasUpdates = theDepositTable.hasUpdates();</span>
<span class="nc bnc" id="L393" title="All 2 branches missed.">        if (!hasUpdates) {</span>
<span class="nc" id="L394">            hasUpdates = theCashTable.hasUpdates();</span>
        }
<span class="nc bnc" id="L396" title="All 2 branches missed.">        if (!hasUpdates) {</span>
<span class="nc" id="L397">            hasUpdates = theLoanTable.hasUpdates();</span>
        }
<span class="nc bnc" id="L399" title="All 2 branches missed.">        if (!hasUpdates) {</span>
<span class="nc" id="L400">            hasUpdates = theEventTable.hasUpdates();</span>
        }
<span class="nc bnc" id="L402" title="All 2 branches missed.">        if (!hasUpdates) {</span>
<span class="nc" id="L403">            hasUpdates = theTagTable.hasUpdates();</span>
        }
<span class="nc bnc" id="L405" title="All 2 branches missed.">        if (!hasUpdates) {</span>
<span class="nc" id="L406">            hasUpdates = theRegionTable.hasUpdates();</span>
        }

        /* Return to caller */
<span class="nc" id="L410">        return hasUpdates;</span>
    }

    /**
     * Has this set of panels got the session focus?
     * @return true/false
     */
    public boolean hasSession() {
        /* Determine whether we have session focus */
<span class="nc" id="L419">        boolean hasSession = theDepositTable.hasSession();</span>
<span class="nc bnc" id="L420" title="All 2 branches missed.">        if (!hasSession) {</span>
<span class="nc" id="L421">            hasSession = theCashTable.hasSession();</span>
        }
<span class="nc bnc" id="L423" title="All 2 branches missed.">        if (!hasSession) {</span>
<span class="nc" id="L424">            hasSession = theLoanTable.hasSession();</span>
        }
<span class="nc bnc" id="L426" title="All 2 branches missed.">        if (!hasSession) {</span>
<span class="nc" id="L427">            hasSession = theEventTable.hasSession();</span>
        }
<span class="nc bnc" id="L429" title="All 2 branches missed.">        if (!hasSession) {</span>
<span class="nc" id="L430">            hasSession = theTagTable.hasSession();</span>
        }
<span class="nc bnc" id="L432" title="All 2 branches missed.">        if (!hasSession) {</span>
<span class="nc" id="L433">            hasSession = theRegionTable.hasSession();</span>
        }

        /* Return to caller */
<span class="nc" id="L437">        return hasSession;</span>
    }

    /**
     * Does this panel have errors?
     * @return true/false
     */
    public boolean hasErrors() {
        /* Determine whether we have errors */
<span class="nc" id="L446">        boolean hasErrors = theDepositTable.hasErrors();</span>
<span class="nc bnc" id="L447" title="All 2 branches missed.">        if (!hasErrors) {</span>
<span class="nc" id="L448">            hasErrors = theCashTable.hasErrors();</span>
        }
<span class="nc bnc" id="L450" title="All 2 branches missed.">        if (!hasErrors) {</span>
<span class="nc" id="L451">            hasErrors = theLoanTable.hasErrors();</span>
        }
<span class="nc bnc" id="L453" title="All 2 branches missed.">        if (!hasErrors) {</span>
<span class="nc" id="L454">            hasErrors = theEventTable.hasErrors();</span>
        }
<span class="nc bnc" id="L456" title="All 2 branches missed.">        if (!hasErrors) {</span>
<span class="nc" id="L457">            hasErrors = theTagTable.hasErrors();</span>
        }
<span class="nc bnc" id="L459" title="All 2 branches missed.">        if (!hasErrors) {</span>
<span class="nc" id="L460">            hasErrors = theRegionTable.hasErrors();</span>
        }

        /* Return to caller */
<span class="nc" id="L464">        return hasErrors;</span>
    }

    /**
     * Does this panel have item editing occurring?
     * @return true/false
     */
    public boolean isItemEditing() {
        /* Determine whether we have item editing */
<span class="nc" id="L473">        boolean isEditing = theDepositTable.isItemEditing();</span>
<span class="nc bnc" id="L474" title="All 2 branches missed.">        if (!isEditing) {</span>
<span class="nc" id="L475">            isEditing = theCashTable.isItemEditing();</span>
        }
<span class="nc bnc" id="L477" title="All 2 branches missed.">        if (!isEditing) {</span>
<span class="nc" id="L478">            isEditing = theLoanTable.isItemEditing();</span>
        }
<span class="nc bnc" id="L480" title="All 2 branches missed.">        if (!isEditing) {</span>
<span class="nc" id="L481">            isEditing = theEventTable.isItemEditing();</span>
        }
<span class="nc bnc" id="L483" title="All 2 branches missed.">        if (!isEditing) {</span>
<span class="nc" id="L484">            isEditing = theTagTable.isItemEditing();</span>
        }
<span class="nc bnc" id="L486" title="All 2 branches missed.">        if (!isEditing) {</span>
<span class="nc" id="L487">            isEditing = theRegionTable.isItemEditing();</span>
        }

        /* Return to caller */
<span class="nc" id="L491">        return isEditing;</span>
    }

    /**
     * Select category.
     * @param pCategory the category to select
     */
    public void selectCategory(final Object pCategory) {
        /* Determine which panel to show */
<span class="nc bnc" id="L500" title="All 2 branches missed.">        if (pCategory instanceof MoneyWiseDepositCategory myCategory) {</span>
<span class="nc" id="L501">            theDepositTable.selectCategory(myCategory);</span>
<span class="nc" id="L502">            showPanel(PanelName.DEPOSITS);</span>
<span class="nc bnc" id="L503" title="All 2 branches missed.">        } else if (pCategory instanceof MoneyWiseCashCategory myCategory) {</span>
<span class="nc" id="L504">            theCashTable.selectCategory(myCategory);</span>
<span class="nc" id="L505">            showPanel(PanelName.CASH);</span>
<span class="nc bnc" id="L506" title="All 2 branches missed.">        } else if (pCategory instanceof MoneyWiseLoanCategory myCategory) {</span>
<span class="nc" id="L507">            theLoanTable.selectCategory(myCategory);</span>
<span class="nc" id="L508">            showPanel(PanelName.LOANS);</span>
<span class="nc bnc" id="L509" title="All 2 branches missed.">        } else if (pCategory instanceof MoneyWiseTransCategory myCategory) {</span>
<span class="nc" id="L510">            theEventTable.selectCategory(myCategory);</span>
<span class="nc" id="L511">            showPanel(PanelName.EVENTS);</span>
        }
<span class="nc" id="L513">    }</span>

    /**
     * Select tag.
     * @param pTag the category to select
     */
    public void selectTag(final Object pTag) {
        /* Determine which panel to show */
<span class="nc bnc" id="L521" title="All 2 branches missed.">        if (pTag instanceof MoneyWiseTransTag myTag) {</span>
<span class="nc" id="L522">            theTagTable.selectTag(myTag);</span>
<span class="nc" id="L523">            showPanel(PanelName.EVENTTAGS);</span>
        }
<span class="nc" id="L525">    }</span>

    /**
     * Select region.
     * @param pRegion the region to select
     */
    public void selectRegion(final Object pRegion) {
        /* Determine which panel to show */
<span class="nc bnc" id="L533" title="All 2 branches missed.">        if (pRegion instanceof MoneyWiseRegion myRegion) {</span>
<span class="nc" id="L534">            theRegionTable.selectRegion(myRegion);</span>
<span class="nc" id="L535">            showPanel(PanelName.REGIONS);</span>
        }
<span class="nc" id="L537">    }</span>

    /**
     * Show panel.
     * @param pName the panel name
     */
    private void showPanel(final PanelName pName) {
        /* Obtain name of panel */
<span class="nc" id="L545">        final String myName = pName.toString();</span>

        /* Move correct card to front */
<span class="nc" id="L548">        theCardPanel.selectCard(myName);</span>
<span class="nc" id="L549">        theFilterCardPanel.selectCard(myName);</span>

        /* Note the active panel */
<span class="nc" id="L552">        theActive = pName;</span>
<span class="nc" id="L553">        theSelectButton.setFixedText(myName);</span>

        /* Determine the focus */
<span class="nc" id="L556">        determineFocus();</span>
<span class="nc" id="L557">    }</span>

    /**
     * Set Visibility.
     */
    protected void setVisibility() {
        /* Determine whether we have updates */
<span class="nc" id="L564">        final boolean hasUpdates = hasUpdates();</span>
<span class="nc" id="L565">        final boolean isItemEditing = isItemEditing();</span>

        /* Update the action buttons */
<span class="nc" id="L568">        theActionButtons.setEnabled(true);</span>
<span class="nc bnc" id="L569" title="All 4 branches missed.">        theActionButtons.setVisible(hasUpdates &amp;&amp; !isItemEditing);</span>

        /* Update the selection */
<span class="nc bnc" id="L572" title="All 2 branches missed.">        theSelectButton.setEnabled(!isItemEditing);</span>
<span class="nc bnc" id="L573" title="All 2 branches missed.">        theFilterCardPanel.setEnabled(!isItemEditing);</span>

        /* Alert listeners that there has been a change */
<span class="nc" id="L576">        theEventManager.fireEvent(PrometheusDataEvent.ADJUSTVISIBILITY);</span>
<span class="nc" id="L577">    }</span>

    /**
     * Cancel Editing of underlying tables.
     */
    private void cancelEditing() {
        /* Cancel editing on subPanels */
<span class="nc" id="L584">        theDepositTable.cancelEditing();</span>
<span class="nc" id="L585">        theCashTable.cancelEditing();</span>
<span class="nc" id="L586">        theLoanTable.cancelEditing();</span>
<span class="nc" id="L587">        theEventTable.cancelEditing();</span>
<span class="nc" id="L588">        theTagTable.cancelEditing();</span>
<span class="nc" id="L589">        theRegionTable.cancelEditing();</span>
<span class="nc" id="L590">    }</span>

    /**
     * handleErrorPane.
     */
    private void handleErrorPane() {
        /* Determine whether we have an error */
<span class="nc" id="L597">        final boolean isError = theError.hasError();</span>

        /* Hide selection panel on error */
<span class="nc bnc" id="L600" title="All 2 branches missed.">        theSelectPanel.setVisible(!isError);</span>

        /* Lock card panel */
<span class="nc bnc" id="L603" title="All 2 branches missed.">        theCardPanel.setEnabled(!isError);</span>

        /* Lock Action Buttons */
<span class="nc bnc" id="L606" title="All 2 branches missed.">        theActionButtons.setEnabled(!isError);</span>
<span class="nc" id="L607">    }</span>

    /**
     * handleSelection.
     */
    private void handleSelection() {
        /* Cancel any editing */
<span class="nc" id="L614">        cancelEditing();</span>

        /* Show selected panel */
<span class="nc" id="L617">        showPanel(theSelectButton.getValue());</span>
<span class="nc" id="L618">    }</span>

    /**
     * handle Action Buttons.
     * @param pEvent the event
     */
    private void handleActionButtons(final OceanusEvent&lt;PrometheusUIEvent&gt; pEvent) {
        /* Cancel editing */
<span class="nc" id="L626">        cancelEditing();</span>

        /* Perform the command */
<span class="nc" id="L629">        theEditSet.processCommand(pEvent.getEventId(), theError);</span>
<span class="nc" id="L630">    }</span>

    /**
     * handle GoTo Event.
     * @param pEvent the event
     */
    private void handleGoToEvent(final OceanusEvent&lt;PrometheusDataEvent&gt; pEvent) {
        /* Access details */
        @SuppressWarnings(&quot;unchecked&quot;)
<span class="nc" id="L639">        final PrometheusGoToEvent&lt;MoneyWiseGoToId&gt; myEvent = pEvent.getDetails(PrometheusGoToEvent.class);</span>

        /* Access event and obtain details */
<span class="nc bnc" id="L642" title="All 5 branches missed.">        switch (myEvent.getId()) {</span>
            /* Pass through the event */
            case STATEMENT:
            case ACCOUNT:
            case STATIC:
<span class="nc" id="L647">                theEventManager.cascadeEvent(pEvent);</span>
<span class="nc" id="L648">                break;</span>

            /* Access subPanels */
            case CATEGORY:
<span class="nc" id="L652">                selectCategory(myEvent.getDetails());</span>
<span class="nc" id="L653">                break;</span>
            case TAG:
<span class="nc" id="L655">                selectTag(pEvent.getDetails());</span>
<span class="nc" id="L656">                break;</span>
            case REGION:
<span class="nc" id="L658">                selectRegion(pEvent.getDetails());</span>
<span class="nc" id="L659">                break;</span>
            default:
                break;
        }
<span class="nc" id="L663">    }</span>

    /**
     * Panel names.
     */
<span class="nc" id="L668">    private enum PanelName {</span>
        /**
         * Deposits.
         */
<span class="nc" id="L672">        DEPOSITS(MoneyWiseBasicDataType.DEPOSITCATEGORY),</span>

        /**
         * Cash.
         */
<span class="nc" id="L677">        CASH(MoneyWiseBasicDataType.CASHCATEGORY),</span>

        /**
         * Loans.
         */
<span class="nc" id="L682">        LOANS(MoneyWiseBasicDataType.LOANCATEGORY),</span>

        /**
         * Events.
         */
<span class="nc" id="L687">        EVENTS(MoneyWiseBasicDataType.TRANSCATEGORY),</span>

        /**
         * Tags.
         */
<span class="nc" id="L692">        EVENTTAGS(MoneyWiseBasicDataType.TRANSTAG),</span>

        /**
         * Regions.
         */
<span class="nc" id="L697">        REGIONS(MoneyWiseBasicDataType.REGION);</span>

        /**
         * The String name.
         */
        private final String theName;

        /**
         * Constructor.
         * @param pDataType the dataType
         */
<span class="nc" id="L708">        PanelName(final MoneyWiseBasicDataType pDataType) {</span>
<span class="nc" id="L709">            theName = pDataType.getListName();</span>
<span class="nc" id="L710">        }</span>

        @Override
        public String toString() {
            /* return the name */
<span class="nc" id="L715">            return theName;</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>