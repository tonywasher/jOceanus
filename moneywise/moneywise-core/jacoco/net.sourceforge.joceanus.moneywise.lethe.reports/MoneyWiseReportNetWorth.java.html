<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>MoneyWiseReportNetWorth.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">MoneyWise Personal Finance - Core</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.joceanus.moneywise.lethe.reports</a> &gt; <span class="el_source">MoneyWiseReportNetWorth.java</span></div><h1>MoneyWiseReportNetWorth.java</h1><pre class="source lang-java linenums">/*******************************************************************************
 * MoneyWise: Finance Application
 * Copyright 2012,2025 Tony Washer
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not
 * use this file except in compliance with the License.  You may obtain a copy
 * of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations under
 * the License.
 ******************************************************************************/
package net.sourceforge.joceanus.moneywise.lethe.reports;

import net.sourceforge.joceanus.metis.data.MetisDataDifference;
import net.sourceforge.joceanus.metis.report.MetisReportBase;
import net.sourceforge.joceanus.metis.report.MetisReportHTMLBuilder;
import net.sourceforge.joceanus.metis.report.MetisReportHTMLBuilder.MetisHTMLTable;
import net.sourceforge.joceanus.metis.report.MetisReportManager;
import net.sourceforge.joceanus.metis.report.MetisReportReferenceManager.DelayedTable;
import net.sourceforge.joceanus.moneywise.data.basic.MoneyWiseBasicDataType;
import net.sourceforge.joceanus.moneywise.data.basic.MoneyWiseBasicResource;
import net.sourceforge.joceanus.moneywise.data.basic.MoneyWiseCashCategory;
import net.sourceforge.joceanus.moneywise.data.basic.MoneyWiseDepositCategory;
import net.sourceforge.joceanus.moneywise.data.basic.MoneyWiseLoanCategory;
import net.sourceforge.joceanus.moneywise.data.statics.MoneyWiseCashCategoryClass;
import net.sourceforge.joceanus.moneywise.data.statics.MoneyWiseDepositCategoryClass;
import net.sourceforge.joceanus.moneywise.data.statics.MoneyWiseLoanCategoryClass;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysis;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisCashBucket;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisCashBucket.MoneyWiseAnalysisCashBucketList;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisCashCategoryBucket;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisCashCategoryBucket.MoneyWiseAnalysisCashCategoryBucketList;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisDataResource;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisDepositBucket;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisDepositBucket.MoneyWiseAnalysisDepositBucketList;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisDepositCategoryBucket;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisDepositCategoryBucket.MoneyWiseAnalysisDepositCategoryBucketList;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisLoanBucket;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisLoanBucket.MoneyWiseAnalysisLoanBucketList;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisLoanCategoryBucket;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisLoanCategoryBucket.MoneyWiseAnalysisLoanCategoryBucketList;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisPortfolioBucket;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisPortfolioBucket.MoneyWiseAnalysisPortfolioBucketList;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisPortfolioCashBucket;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisSecurityBucket;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisSecurityBucket.MoneyWiseAnalysisSecurityBucketList;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.values.MoneyWiseAnalysisAccountAttr;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.values.MoneyWiseAnalysisAccountValues;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.values.MoneyWiseAnalysisSecurityAttr;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.values.MoneyWiseAnalysisSecurityValues;
import net.sourceforge.joceanus.moneywise.lethe.data.analysis.values.MoneyWiseAnalysisValuesResource;
import net.sourceforge.joceanus.moneywise.lethe.views.MoneyWiseAnalysisFilter;
import net.sourceforge.joceanus.moneywise.lethe.views.MoneyWiseAnalysisFilter.MoneyWiseAnalysisCashFilter;
import net.sourceforge.joceanus.moneywise.lethe.views.MoneyWiseAnalysisFilter.MoneyWiseAnalysisDepositFilter;
import net.sourceforge.joceanus.moneywise.lethe.views.MoneyWiseAnalysisFilter.MoneyWiseAnalysisLoanFilter;
import net.sourceforge.joceanus.moneywise.lethe.views.MoneyWiseAnalysisFilter.MoneyWiseAnalysisPortfolioCashFilter;
import net.sourceforge.joceanus.moneywise.lethe.views.MoneyWiseAnalysisFilter.MoneyWiseAnalysisSecurityFilter;
import net.sourceforge.joceanus.oceanus.date.OceanusDate;
import net.sourceforge.joceanus.oceanus.decimal.OceanusMoney;
import net.sourceforge.joceanus.oceanus.format.OceanusDataFormatter;
import org.w3c.dom.Document;
import org.w3c.dom.Element;

import java.util.Iterator;

/**
 * NetWorth report builder.
 */
public class MoneyWiseReportNetWorth
        extends MetisReportBase&lt;MoneyWiseAnalysis, MoneyWiseAnalysisFilter&lt;?, ?&gt;&gt; {
    /**
     * The Title text.
     */
<span class="nc" id="L79">    private static final String TEXT_TITLE = MoneyWiseReportResource.NETWORTH_TITLE.getValue();</span>

    /**
     * The Asset text.
     */
<span class="nc" id="L84">    private static final String TEXT_ASSET = MoneyWiseReportResource.NETWORTH_ASSET.getValue();</span>

    /**
     * The Units text.
     */
<span class="nc" id="L89">    private static final String TEXT_UNITS = MoneyWiseBasicResource.MONEYWISEDATA_FIELD_UNITS.getValue();</span>

    /**
     * The Price text.
     */
<span class="nc" id="L94">    private static final String TEXT_PRICE = MoneyWiseBasicResource.MONEYWISEDATA_FIELD_PRICE.getValue();</span>

    /**
     * The ForeignValue text.
     */
<span class="nc" id="L99">    private static final String TEXT_FOREIGNVALUE = MoneyWiseAnalysisValuesResource.ACCOUNTATTR_FOREIGNVALUE.getValue();</span>

    /**
     * The Value text.
     */
<span class="nc" id="L104">    private static final String TEXT_VALUE = MoneyWiseAnalysisValuesResource.ACCOUNTATTR_VALUATION.getValue();</span>

    /**
     * The Account text.
     */
<span class="nc" id="L109">    private static final String TEXT_ACCOUNT = MoneyWiseAnalysisDataResource.BUCKET_ACCOUNT.getValue();</span>

    /**
     * The Rate text.
     */
<span class="nc" id="L114">    private static final String TEXT_RATE = MoneyWiseBasicResource.MONEYWISEDATA_FIELD_RATE.getValue();</span>

    /**
     * The Maturity text.
     */
<span class="nc" id="L119">    private static final String TEXT_MATURITY = MoneyWiseAnalysisValuesResource.ACCOUNTATTR_MATURITY.getValue();</span>

    /**
     * HTML builder.
     */
    private final MetisReportHTMLBuilder theBuilder;

    /**
     * The Formatter.
     */
    private final OceanusDataFormatter theFormatter;

    /**
     * Data Analysis.
     */
    private MoneyWiseAnalysis theAnalysis;

    /**
     * Constructor.
     * @param pManager the Report Manager
     */
<span class="nc" id="L140">    protected MoneyWiseReportNetWorth(final MetisReportManager&lt;MoneyWiseAnalysisFilter&lt;?, ?&gt;&gt; pManager) {</span>
        /* Access underlying utilities */
<span class="nc" id="L142">        theBuilder = pManager.getBuilder();</span>
<span class="nc" id="L143">        theFormatter = theBuilder.getDataFormatter();</span>
<span class="nc" id="L144">    }</span>

    @Override
    public Document createReport(final MoneyWiseAnalysis pAnalysis) {
        /* Access the bucket lists */
<span class="nc" id="L149">        theAnalysis = pAnalysis;</span>
<span class="nc" id="L150">        final MoneyWiseAnalysisDepositCategoryBucketList myDeposits = theAnalysis.getDepositCategories();</span>
<span class="nc" id="L151">        final MoneyWiseAnalysisCashCategoryBucketList myCash = theAnalysis.getCashCategories();</span>
<span class="nc" id="L152">        final MoneyWiseAnalysisLoanCategoryBucketList myLoans = theAnalysis.getLoanCategories();</span>
<span class="nc" id="L153">        final MoneyWiseAnalysisPortfolioBucketList myPortfolios = theAnalysis.getPortfolios();</span>
<span class="nc" id="L154">        final OceanusDate myDate = theAnalysis.getDateRange().getEnd();</span>

        /* Create the totals */
<span class="nc" id="L157">        final OceanusMoney myTotal = new OceanusMoney();</span>

        /* Start the report */
<span class="nc" id="L160">        final Element myBody = theBuilder.startReport();</span>
<span class="nc" id="L161">        theBuilder.makeTitle(myBody, TEXT_TITLE, theFormatter.formatObject(myDate));</span>

        /* Initialise the table */
<span class="nc" id="L164">        final MetisHTMLTable myTable = theBuilder.startTable(myBody);</span>

        /* If we have deposits */
<span class="nc bnc" id="L167" title="All 2 branches missed.">        if (!myDeposits.isEmpty()) {</span>
            /* Loop through the SubTotal Buckets */
<span class="nc" id="L169">            final Iterator&lt;MoneyWiseAnalysisDepositCategoryBucket&gt; myIterator = myDeposits.iterator();</span>
<span class="nc bnc" id="L170" title="All 2 branches missed.">            while (myIterator.hasNext()) {</span>
<span class="nc" id="L171">                final MoneyWiseAnalysisDepositCategoryBucket myBucket = myIterator.next();</span>

                /* Only process active subTotal items */
<span class="nc bnc" id="L174" title="All 2 branches missed.">                if (!myBucket.isActive()</span>
<span class="nc bnc" id="L175" title="All 2 branches missed.">                        || !myBucket.getAccountCategory().isCategoryClass(MoneyWiseDepositCategoryClass.PARENT)) {</span>
<span class="nc" id="L176">                    continue;</span>
                }

                /* Access values */
<span class="nc" id="L180">                final MoneyWiseAnalysisAccountValues myValues = myBucket.getValues();</span>

                /* Format the Category Total */
<span class="nc" id="L183">                theBuilder.startRow(myTable);</span>
<span class="nc" id="L184">                theBuilder.makeTableLinkCell(myTable, myBucket.getName());</span>
<span class="nc" id="L185">                theBuilder.makeTotalCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>

                /* Add the category report */
<span class="nc" id="L188">                makeCategoryReport(myTable, myBucket);</span>
<span class="nc" id="L189">            }</span>

            /* Access totals */
<span class="nc" id="L192">            final MoneyWiseAnalysisDepositCategoryBucket myTotals = myDeposits.getTotals();</span>
<span class="nc" id="L193">            final MoneyWiseAnalysisAccountValues myValues = myTotals.getValues();</span>

            /* Add to running totals */
<span class="nc" id="L196">            myTotal.addAmount(myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>
        }

        /* If we have cash */
<span class="nc bnc" id="L200" title="All 2 branches missed.">        if (!myCash.isEmpty()) {</span>
            /* Loop through the SubTotal Buckets */
<span class="nc" id="L202">            final Iterator&lt;MoneyWiseAnalysisCashCategoryBucket&gt; myIterator = myCash.iterator();</span>
<span class="nc bnc" id="L203" title="All 2 branches missed.">            while (myIterator.hasNext()) {</span>
<span class="nc" id="L204">                final MoneyWiseAnalysisCashCategoryBucket myBucket = myIterator.next();</span>

                /* Only process active subTotal items */
<span class="nc bnc" id="L207" title="All 2 branches missed.">                if (!myBucket.isActive()</span>
<span class="nc bnc" id="L208" title="All 2 branches missed.">                        || !myBucket.getAccountCategory().isCategoryClass(MoneyWiseCashCategoryClass.PARENT)) {</span>
<span class="nc" id="L209">                    continue;</span>
                }

                /* Access values */
<span class="nc" id="L213">                final MoneyWiseAnalysisAccountValues myValues = myBucket.getValues();</span>

                /* Format the Category Total */
<span class="nc" id="L216">                theBuilder.startRow(myTable);</span>
<span class="nc" id="L217">                theBuilder.makeTableLinkCell(myTable, myBucket.getName());</span>
<span class="nc" id="L218">                theBuilder.makeTotalCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>

                /* Add the category report */
<span class="nc" id="L221">                makeCategoryReport(myTable, myBucket);</span>
<span class="nc" id="L222">            }</span>

            /* Access totals */
<span class="nc" id="L225">            final MoneyWiseAnalysisCashCategoryBucket myTotals = myCash.getTotals();</span>
<span class="nc" id="L226">            final MoneyWiseAnalysisAccountValues myValues = myTotals.getValues();</span>

            /* Add to running totals */
<span class="nc" id="L229">            myTotal.addAmount(myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>
        }

        /* If we have portfolios */
<span class="nc bnc" id="L233" title="All 2 branches missed.">        if (!myPortfolios.isEmpty()) {</span>
            /* Access totals */
<span class="nc" id="L235">            final MoneyWiseAnalysisPortfolioBucket myTotals = myPortfolios.getTotals();</span>
<span class="nc" id="L236">            final MoneyWiseAnalysisSecurityValues myValues = myTotals.getValues();</span>
<span class="nc" id="L237">            final OceanusMoney myValuation = myValues.getMoneyValue(MoneyWiseAnalysisSecurityAttr.VALUATION);</span>

            /* Format the Portfolios Total */
<span class="nc" id="L240">            theBuilder.startRow(myTable);</span>
<span class="nc" id="L241">            theBuilder.makeTableLinkCell(myTable, MoneyWiseBasicDataType.PORTFOLIO.getListName());</span>
<span class="nc" id="L242">            theBuilder.makeTotalCell(myTable, myValuation);</span>

            /* Make the portfolio report */
<span class="nc" id="L245">            makePortfolioReport(myTable);</span>

            /* Add to running totals */
<span class="nc" id="L248">            myTotal.addAmount(myValuation);</span>
        }

        /* If we have loans */
<span class="nc bnc" id="L252" title="All 2 branches missed.">        if (!myLoans.isEmpty()) {</span>
            /* Loop through the SubTotal Buckets */
<span class="nc" id="L254">            final Iterator&lt;MoneyWiseAnalysisLoanCategoryBucket&gt; myIterator = myLoans.iterator();</span>
<span class="nc bnc" id="L255" title="All 2 branches missed.">            while (myIterator.hasNext()) {</span>
<span class="nc" id="L256">                final MoneyWiseAnalysisLoanCategoryBucket myBucket = myIterator.next();</span>

                /* Only process active subTotal items */
<span class="nc bnc" id="L259" title="All 2 branches missed.">                if (!myBucket.isActive()</span>
<span class="nc bnc" id="L260" title="All 2 branches missed.">                        || !myBucket.getAccountCategory().isCategoryClass(MoneyWiseLoanCategoryClass.PARENT)) {</span>
<span class="nc" id="L261">                    continue;</span>
                }

                /* Access values */
<span class="nc" id="L265">                final MoneyWiseAnalysisAccountValues myValues = myBucket.getValues();</span>

                /* Format the Category Total */
<span class="nc" id="L268">                theBuilder.startRow(myTable);</span>
<span class="nc" id="L269">                theBuilder.makeTableLinkCell(myTable, myBucket.getName());</span>
<span class="nc" id="L270">                theBuilder.makeTotalCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>

                /* Add the category report */
<span class="nc" id="L273">                makeCategoryReport(myTable, myBucket);</span>
<span class="nc" id="L274">            }</span>

            /* Access totals */
<span class="nc" id="L277">            final MoneyWiseAnalysisLoanCategoryBucket myTotals = myLoans.getTotals();</span>
<span class="nc" id="L278">            final MoneyWiseAnalysisAccountValues myValues = myTotals.getValues();</span>

            /* Add to running totals */
<span class="nc" id="L281">            myTotal.addAmount(myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>
        }

        /* Build the total row */
<span class="nc" id="L285">        theBuilder.startTotalRow(myTable);</span>
<span class="nc" id="L286">        theBuilder.makeTitleCell(myTable, MoneyWiseReportBuilder.TEXT_TOTAL);</span>
<span class="nc" id="L287">        theBuilder.makeTotalCell(myTable, myTotal);</span>

        /* Return the document */
<span class="nc" id="L290">        return theBuilder.getDocument();</span>
    }

    /**
     * Build a category report.
     * @param pParent the table parent
     * @param pCategory the category bucket
     */
    private void makeCategoryReport(final MetisHTMLTable pParent,
                                    final MoneyWiseAnalysisDepositCategoryBucket pCategory) {
        /* Access the category */
<span class="nc" id="L301">        final MoneyWiseAnalysisDepositCategoryBucketList myCategories = theAnalysis.getDepositCategories();</span>
<span class="nc" id="L302">        final MoneyWiseDepositCategory myCategory = pCategory.getAccountCategory();</span>

        /* Create an embedded table */
<span class="nc" id="L305">        final MetisHTMLTable myTable = theBuilder.createEmbeddedTable(pParent);</span>

        /* Loop through the Category Buckets */
<span class="nc" id="L308">        final Iterator&lt;MoneyWiseAnalysisDepositCategoryBucket&gt; myIterator = myCategories.iterator();</span>
<span class="nc bnc" id="L309" title="All 2 branches missed.">        while (myIterator.hasNext()) {</span>
<span class="nc" id="L310">            final MoneyWiseAnalysisDepositCategoryBucket myBucket = myIterator.next();</span>

            /* Skip record if inactive or incorrect category */
<span class="nc" id="L313">            final MoneyWiseDepositCategory myCurr = myBucket.getAccountCategory();</span>
<span class="nc bnc" id="L314" title="All 2 branches missed.">            if (!myBucket.isActive()</span>
<span class="nc bnc" id="L315" title="All 2 branches missed.">                    || !MetisDataDifference.isEqual(myCurr.getParentCategory(), myCategory)) {</span>
<span class="nc" id="L316">                continue;</span>
            }

            /* Access bucket name */
<span class="nc" id="L320">            final String myName = myBucket.getName();</span>

            /* Access values */
<span class="nc" id="L323">            final MoneyWiseAnalysisAccountValues myValues = myBucket.getValues();</span>

            /* Create the SubCategory row */
<span class="nc" id="L326">            theBuilder.startRow(myTable);</span>
<span class="nc" id="L327">            theBuilder.makeDelayLinkCell(myTable, myName, myCurr.getSubCategory());</span>
<span class="nc" id="L328">            theBuilder.makeTotalCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>

            /* Note the delayed subTable */
<span class="nc" id="L331">            setDelayedTable(myName, myTable, myBucket);</span>
<span class="nc" id="L332">        }</span>

        /* Embed the table correctly */
<span class="nc" id="L335">        theBuilder.embedTable(myTable, pCategory.getName());</span>
<span class="nc" id="L336">    }</span>

    /**
     * Build a category report.
     * @param pParent the table parent
     * @param pCategory the category bucket
     */
    private void makeCategoryReport(final MetisHTMLTable pParent,
                                    final MoneyWiseAnalysisCashCategoryBucket pCategory) {
        /* Access the category */
<span class="nc" id="L346">        final MoneyWiseAnalysisCashCategoryBucketList myCategories = theAnalysis.getCashCategories();</span>
<span class="nc" id="L347">        final MoneyWiseCashCategory myCategory = pCategory.getAccountCategory();</span>

        /* Create an embedded table */
<span class="nc" id="L350">        final MetisHTMLTable myTable = theBuilder.createEmbeddedTable(pParent);</span>

        /* Loop through the Category Buckets */
<span class="nc" id="L353">        final Iterator&lt;MoneyWiseAnalysisCashCategoryBucket&gt; myIterator = myCategories.iterator();</span>
<span class="nc bnc" id="L354" title="All 2 branches missed.">        while (myIterator.hasNext()) {</span>
<span class="nc" id="L355">            final MoneyWiseAnalysisCashCategoryBucket myBucket = myIterator.next();</span>

            /* Skip record if inactive or incorrect category */
<span class="nc" id="L358">            final MoneyWiseCashCategory myCurr = myBucket.getAccountCategory();</span>
<span class="nc bnc" id="L359" title="All 2 branches missed.">            if (!myBucket.isActive()</span>
<span class="nc bnc" id="L360" title="All 2 branches missed.">                    || !MetisDataDifference.isEqual(myCurr.getParentCategory(), myCategory)) {</span>
<span class="nc" id="L361">                continue;</span>
            }

            /* Access bucket name */
<span class="nc" id="L365">            final String myName = myBucket.getName();</span>

            /* Access values */
<span class="nc" id="L368">            final MoneyWiseAnalysisAccountValues myValues = myBucket.getValues();</span>

            /* Create the SubCategory row */
<span class="nc" id="L371">            theBuilder.startRow(myTable);</span>
<span class="nc" id="L372">            theBuilder.makeDelayLinkCell(myTable, myName, myCurr.getSubCategory());</span>
<span class="nc" id="L373">            theBuilder.makeTotalCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>

            /* Note the delayed subTable */
<span class="nc" id="L376">            setDelayedTable(myName, myTable, myBucket);</span>
<span class="nc" id="L377">        }</span>

        /* Embed the table correctly */
<span class="nc" id="L380">        theBuilder.embedTable(myTable, pCategory.getName());</span>
<span class="nc" id="L381">    }</span>

    /**
     * Build a category report.
     * @param pParent the table parent
     * @param pCategory the category bucket
     */
    private void makeCategoryReport(final MetisHTMLTable pParent,
                                    final MoneyWiseAnalysisLoanCategoryBucket pCategory) {
        /* Access the category */
<span class="nc" id="L391">        final MoneyWiseAnalysisLoanCategoryBucketList myCategories = theAnalysis.getLoanCategories();</span>
<span class="nc" id="L392">        final MoneyWiseLoanCategory myCategory = pCategory.getAccountCategory();</span>

        /* Create an embedded table */
<span class="nc" id="L395">        final MetisHTMLTable myTable = theBuilder.createEmbeddedTable(pParent);</span>

        /* Loop through the Category Buckets */
<span class="nc" id="L398">        final Iterator&lt;MoneyWiseAnalysisLoanCategoryBucket&gt; myIterator = myCategories.iterator();</span>
<span class="nc bnc" id="L399" title="All 2 branches missed.">        while (myIterator.hasNext()) {</span>
<span class="nc" id="L400">            final MoneyWiseAnalysisLoanCategoryBucket myBucket = myIterator.next();</span>

            /* Skip record if inactive or incorrect category */
<span class="nc" id="L403">            final MoneyWiseLoanCategory myCurr = myBucket.getAccountCategory();</span>
<span class="nc bnc" id="L404" title="All 2 branches missed.">            if (!myBucket.isActive()</span>
<span class="nc bnc" id="L405" title="All 2 branches missed.">                    || !MetisDataDifference.isEqual(myCurr.getParentCategory(), myCategory)) {</span>
<span class="nc" id="L406">                continue;</span>
            }

            /* Access bucket name */
<span class="nc" id="L410">            final String myName = myBucket.getName();</span>

            /* Access values */
<span class="nc" id="L413">            final MoneyWiseAnalysisAccountValues myValues = myBucket.getValues();</span>

            /* Create the SubCategory row */
<span class="nc" id="L416">            theBuilder.startRow(myTable);</span>
<span class="nc" id="L417">            theBuilder.makeDelayLinkCell(myTable, myName, myCurr.getSubCategory());</span>
<span class="nc" id="L418">            theBuilder.makeTotalCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>

            /* Note the delayed subTable */
<span class="nc" id="L421">            setDelayedTable(myName, myTable, myBucket);</span>
<span class="nc" id="L422">        }</span>

        /* Embed the table correctly */
<span class="nc" id="L425">        theBuilder.embedTable(myTable, pCategory.getName());</span>
<span class="nc" id="L426">    }</span>

    /**
     * Build a portfolio report.
     * @param pParent the table parent
     */
    private void makePortfolioReport(final MetisHTMLTable pParent) {
        /* Access the portfolios */
<span class="nc" id="L434">        final MoneyWiseAnalysisPortfolioBucketList myPortfolios = theAnalysis.getPortfolios();</span>

        /* Create an embedded table */
<span class="nc" id="L437">        final MetisHTMLTable myTable = theBuilder.createEmbeddedTable(pParent);</span>

        /* Loop through the Portfolio Buckets */
<span class="nc" id="L440">        final Iterator&lt;MoneyWiseAnalysisPortfolioBucket&gt; myIterator = myPortfolios.iterator();</span>
<span class="nc bnc" id="L441" title="All 2 branches missed.">        while (myIterator.hasNext()) {</span>
<span class="nc" id="L442">            final MoneyWiseAnalysisPortfolioBucket myBucket = myIterator.next();</span>

            /* Skip inactive portfolios */
<span class="nc bnc" id="L445" title="All 2 branches missed.">            if (!myBucket.isActive()) {</span>
<span class="nc" id="L446">                continue;</span>
            }

            /* Access bucket name */
<span class="nc" id="L450">            final String myName = myBucket.getName();</span>

            /* Access values */
<span class="nc" id="L453">            final MoneyWiseAnalysisSecurityValues myValues = myBucket.getValues();</span>

            /* Create the SubCategory row */
<span class="nc" id="L456">            theBuilder.startRow(myTable);</span>
<span class="nc" id="L457">            theBuilder.makeDelayLinkCell(myTable, myName);</span>
<span class="nc" id="L458">            theBuilder.makeTotalCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisSecurityAttr.VALUATION));</span>

            /* Note the delayed subTable */
<span class="nc" id="L461">            setDelayedTable(myName, myTable, myBucket);</span>
<span class="nc" id="L462">        }</span>

        /* Embed the table correctly */
<span class="nc" id="L465">        theBuilder.embedTable(myTable, MoneyWiseBasicDataType.PORTFOLIO.getListName());</span>
<span class="nc" id="L466">    }</span>

    @Override
    public MetisHTMLTable createDelayedTable(final DelayedTable pTable) {
        /* Access the source */
<span class="nc" id="L471">        final Object mySource = pTable.getSource();</span>
<span class="nc bnc" id="L472" title="All 2 branches missed.">        if (mySource instanceof MoneyWiseAnalysisDepositCategoryBucket mySourceBucket) {</span>
<span class="nc" id="L473">            return createDelayedDeposit(pTable.getParent(), mySourceBucket);</span>
<span class="nc bnc" id="L474" title="All 2 branches missed.">        } else if (mySource instanceof MoneyWiseAnalysisCashCategoryBucket mySourceBucket) {</span>
<span class="nc" id="L475">            return createDelayedCash(pTable.getParent(), mySourceBucket);</span>
<span class="nc bnc" id="L476" title="All 2 branches missed.">        } else if (mySource instanceof MoneyWiseAnalysisLoanCategoryBucket mySourceBucket) {</span>
<span class="nc" id="L477">            return createDelayedLoan(pTable.getParent(), mySourceBucket);</span>
<span class="nc bnc" id="L478" title="All 2 branches missed.">        } else if (mySource instanceof MoneyWiseAnalysisPortfolioBucket mySourceBucket) {</span>
<span class="nc" id="L479">            return createDelayedPortfolio(pTable.getParent(), mySourceBucket);</span>
        }

        /* Return the null table */
<span class="nc" id="L483">        return null;</span>
    }

    /**
     * Create a delayed category table.
     * @param pParent the parent table
     * @param pSource the source bucket
     * @return the new document fragment
     */
    private MetisHTMLTable createDelayedDeposit(final MetisHTMLTable pParent,
                                                final MoneyWiseAnalysisDepositCategoryBucket pSource) {
        /* Access the category */
<span class="nc" id="L495">        final MoneyWiseAnalysisDepositBucketList myAccounts = theAnalysis.getDeposits();</span>
<span class="nc" id="L496">        final MoneyWiseDepositCategory myCategory = pSource.getAccountCategory();</span>
<span class="nc" id="L497">        final boolean isForeign = pSource.hasForeignCurrency();</span>

        /* Create a new table */
<span class="nc" id="L500">        final MetisHTMLTable myTable = theBuilder.createEmbeddedTable(pParent);</span>

        /* Build the headers */
<span class="nc" id="L503">        theBuilder.startRow(myTable);</span>
<span class="nc" id="L504">        theBuilder.makeTitleCell(myTable, TEXT_ACCOUNT);</span>
<span class="nc" id="L505">        theBuilder.makeTitleCell(myTable, TEXT_RATE);</span>
<span class="nc" id="L506">        theBuilder.makeTitleCell(myTable, TEXT_MATURITY);</span>
<span class="nc bnc" id="L507" title="All 2 branches missed.">        if (isForeign) {</span>
<span class="nc" id="L508">            theBuilder.makeTitleCell(myTable, TEXT_FOREIGNVALUE);</span>
        }
<span class="nc" id="L510">        theBuilder.makeTitleCell(myTable, TEXT_VALUE);</span>

        /* Loop through the Deposit Buckets */
<span class="nc" id="L513">        final Iterator&lt;MoneyWiseAnalysisDepositBucket&gt; myIterator = myAccounts.iterator();</span>
<span class="nc bnc" id="L514" title="All 2 branches missed.">        while (myIterator.hasNext()) {</span>
<span class="nc" id="L515">            final MoneyWiseAnalysisDepositBucket myBucket = myIterator.next();</span>

            /* Skip record if inactive or incorrect category */
<span class="nc bnc" id="L518" title="All 2 branches missed.">            if (!myBucket.isActive()</span>
<span class="nc bnc" id="L519" title="All 2 branches missed.">                    || !MetisDataDifference.isEqual(myBucket.getCategory(), myCategory)) {</span>
<span class="nc" id="L520">                continue;</span>
            }

            /* Access bucket name */
<span class="nc" id="L524">            final String myName = myBucket.getName();</span>

            /* Access values */
<span class="nc" id="L527">            final MoneyWiseAnalysisAccountValues myValues = myBucket.getValues();</span>

            /* Create the detail row */
<span class="nc" id="L530">            theBuilder.startRow(myTable);</span>
<span class="nc" id="L531">            theBuilder.makeFilterLinkCell(myTable, myName);</span>
<span class="nc" id="L532">            theBuilder.makeValueCell(myTable, myValues.getRateValue(MoneyWiseAnalysisAccountAttr.DEPOSITRATE));</span>
<span class="nc" id="L533">            theBuilder.makeValueCell(myTable, myValues.getDateValue(MoneyWiseAnalysisAccountAttr.MATURITY));</span>

            /* Handle foreign accounts */
<span class="nc bnc" id="L536" title="All 2 branches missed.">            if (isForeign) {</span>
<span class="nc bnc" id="L537" title="All 2 branches missed.">                if (myBucket.isForeignCurrency()) {</span>
<span class="nc" id="L538">                    theBuilder.makeValueCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.FOREIGNVALUE));</span>
<span class="nc" id="L539">                    theBuilder.makeValueCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>
                } else {
<span class="nc" id="L541">                    theBuilder.makeStretchedValueCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>
                }
            } else {
<span class="nc" id="L544">                theBuilder.makeValueCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>
            }

            /* Record the filter */
<span class="nc" id="L548">            setFilterForId(myName, myBucket);</span>
<span class="nc" id="L549">        }</span>

        /* Return the table */
<span class="nc" id="L552">        return myTable;</span>
    }

    /**
     * Create a delayed category table.
     * @param pParent the parent table
     * @param pSource the source bucket
     * @return the new document fragment
     */
    private MetisHTMLTable createDelayedCash(final MetisHTMLTable pParent,
                                             final MoneyWiseAnalysisCashCategoryBucket pSource) {
        /* Access the category and class */
<span class="nc" id="L564">        final MoneyWiseAnalysisCashBucketList myCash = theAnalysis.getCash();</span>
<span class="nc" id="L565">        final MoneyWiseCashCategory myCategory = pSource.getAccountCategory();</span>
<span class="nc" id="L566">        final boolean isForeign = pSource.hasForeignCurrency();</span>

        /* Create a new table */
<span class="nc" id="L569">        final MetisHTMLTable myTable = theBuilder.createEmbeddedTable(pParent);</span>

        /* Build the headers */
<span class="nc" id="L572">        theBuilder.startRow(myTable);</span>
<span class="nc" id="L573">        theBuilder.makeTitleCell(myTable, TEXT_ACCOUNT);</span>
<span class="nc bnc" id="L574" title="All 2 branches missed.">        if (isForeign) {</span>
<span class="nc" id="L575">            theBuilder.makeTitleCell(myTable, TEXT_FOREIGNVALUE);</span>
        }
<span class="nc" id="L577">        theBuilder.makeTitleCell(myTable, TEXT_VALUE);</span>

        /* Loop through the Cash Buckets */
<span class="nc" id="L580">        final Iterator&lt;MoneyWiseAnalysisCashBucket&gt; myIterator = myCash.iterator();</span>
<span class="nc bnc" id="L581" title="All 2 branches missed.">        while (myIterator.hasNext()) {</span>
<span class="nc" id="L582">            final MoneyWiseAnalysisCashBucket myBucket = myIterator.next();</span>

            /* Skip record if inactive or incorrect category */
<span class="nc bnc" id="L585" title="All 2 branches missed.">            if (!myBucket.isActive()</span>
<span class="nc bnc" id="L586" title="All 2 branches missed.">                    || !MetisDataDifference.isEqual(myBucket.getCategory(), myCategory)) {</span>
<span class="nc" id="L587">                continue;</span>
            }

            /* Access bucket name */
<span class="nc" id="L591">            final String myName = myBucket.getName();</span>

            /* Access values */
<span class="nc" id="L594">            final MoneyWiseAnalysisAccountValues myValues = myBucket.getValues();</span>

            /* Create the detail row */
<span class="nc" id="L597">            theBuilder.startRow(myTable);</span>
<span class="nc" id="L598">            theBuilder.makeFilterLinkCell(myTable, myName);</span>

            /* Handle foreign accounts */
<span class="nc bnc" id="L601" title="All 2 branches missed.">            if (isForeign) {</span>
<span class="nc bnc" id="L602" title="All 2 branches missed.">                if (myBucket.isForeignCurrency()) {</span>
<span class="nc" id="L603">                    theBuilder.makeValueCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.FOREIGNVALUE));</span>
<span class="nc" id="L604">                    theBuilder.makeValueCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>
                } else {
<span class="nc" id="L606">                    theBuilder.makeStretchedValueCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>
                }
            } else {
<span class="nc" id="L609">                theBuilder.makeValueCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>
            }

            /* Record the filter */
<span class="nc" id="L613">            setFilterForId(myName, myBucket);</span>
<span class="nc" id="L614">        }</span>

        /* Return the table */
<span class="nc" id="L617">        return myTable;</span>
    }

    /**
     * Create a delayed category table.
     * @param pParent the parent table
     * @param pSource the source bucket
     * @return the new document fragment
     */
    private MetisHTMLTable createDelayedLoan(final MetisHTMLTable pParent,
                                             final MoneyWiseAnalysisLoanCategoryBucket pSource) {
        /* Access the category */
<span class="nc" id="L629">        final MoneyWiseAnalysisLoanBucketList myLoans = theAnalysis.getLoans();</span>
<span class="nc" id="L630">        final MoneyWiseLoanCategory myCategory = pSource.getAccountCategory();</span>
<span class="nc" id="L631">        final boolean isForeign = pSource.hasForeignCurrency();</span>

        /* Create a new table */
<span class="nc" id="L634">        final MetisHTMLTable myTable = theBuilder.createEmbeddedTable(pParent);</span>

        /* Build the headers */
<span class="nc" id="L637">        theBuilder.startRow(myTable);</span>
<span class="nc" id="L638">        theBuilder.makeTitleCell(myTable, TEXT_ACCOUNT);</span>
<span class="nc bnc" id="L639" title="All 2 branches missed.">        if (isForeign) {</span>
<span class="nc" id="L640">            theBuilder.makeTitleCell(myTable, TEXT_FOREIGNVALUE);</span>
        }
<span class="nc" id="L642">        theBuilder.makeTitleCell(myTable, TEXT_VALUE);</span>

        /* Loop through the Loan Buckets */
<span class="nc" id="L645">        final Iterator&lt;MoneyWiseAnalysisLoanBucket&gt; myIterator = myLoans.iterator();</span>
<span class="nc bnc" id="L646" title="All 2 branches missed.">        while (myIterator.hasNext()) {</span>
<span class="nc" id="L647">            final MoneyWiseAnalysisLoanBucket myBucket = myIterator.next();</span>

            /* Skip record if inactive or incorrect category */
<span class="nc bnc" id="L650" title="All 2 branches missed.">            if (!myBucket.isActive()</span>
<span class="nc bnc" id="L651" title="All 2 branches missed.">                    || !MetisDataDifference.isEqual(myBucket.getCategory(), myCategory)) {</span>
<span class="nc" id="L652">                continue;</span>
            }

            /* Access bucket name */
<span class="nc" id="L656">            final String myName = myBucket.getName();</span>

            /* Access values */
<span class="nc" id="L659">            final MoneyWiseAnalysisAccountValues myValues = myBucket.getValues();</span>

            /* Create the detail row */
<span class="nc" id="L662">            theBuilder.startRow(myTable);</span>
<span class="nc" id="L663">            theBuilder.makeFilterLinkCell(myTable, myName);</span>

            /* Handle foreign accounts */
<span class="nc bnc" id="L666" title="All 2 branches missed.">            if (isForeign) {</span>
<span class="nc bnc" id="L667" title="All 2 branches missed.">                if (myBucket.isForeignCurrency()) {</span>
<span class="nc" id="L668">                    theBuilder.makeValueCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.FOREIGNVALUE));</span>
<span class="nc" id="L669">                    theBuilder.makeValueCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>
                } else {
<span class="nc" id="L671">                    theBuilder.makeStretchedValueCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>
                }
            } else {
<span class="nc" id="L674">                theBuilder.makeValueCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>
            }

            /* Record the filter */
<span class="nc" id="L678">            setFilterForId(myName, myBucket);</span>
<span class="nc" id="L679">        }</span>

        /* Return the table */
<span class="nc" id="L682">        return myTable;</span>
    }

    /**
     * Create a delayed portfolio table.
     * @param pParent the parent table
     * @param pSource the source bucket
     * @return the new document fragment
     */
    private MetisHTMLTable createDelayedPortfolio(final MetisHTMLTable pParent,
                                                  final MoneyWiseAnalysisPortfolioBucket pSource) {
        /* Access the securities */
<span class="nc" id="L694">        final MoneyWiseAnalysisPortfolioCashBucket myCash = pSource.getPortfolioCash();</span>
<span class="nc" id="L695">        final MoneyWiseAnalysisSecurityBucketList mySecurities = pSource.getSecurities();</span>
<span class="nc" id="L696">        final boolean isForeign = pSource.hasForeignCurrency();</span>

        /* Create a new table */
<span class="nc" id="L699">        final MetisHTMLTable myTable = theBuilder.createEmbeddedTable(pParent);</span>

        /* Build the headers */
<span class="nc" id="L702">        theBuilder.startRow(myTable);</span>
<span class="nc" id="L703">        theBuilder.makeTitleCell(myTable, TEXT_ASSET);</span>
<span class="nc" id="L704">        theBuilder.makeTitleCell(myTable, TEXT_UNITS);</span>
<span class="nc" id="L705">        theBuilder.makeTitleCell(myTable, TEXT_PRICE);</span>
<span class="nc bnc" id="L706" title="All 2 branches missed.">        if (isForeign) {</span>
<span class="nc" id="L707">            theBuilder.makeTitleCell(myTable, TEXT_FOREIGNVALUE);</span>
        }
<span class="nc" id="L709">        theBuilder.makeTitleCell(myTable, TEXT_VALUE);</span>

        /* If the portfolio cash is active */
<span class="nc bnc" id="L712" title="All 2 branches missed.">        if (myCash.isActive()) {</span>
            /* Access values */
<span class="nc" id="L714">            final MoneyWiseAnalysisAccountValues myValues = myCash.getValues();</span>

            /* Access bucket name */
<span class="nc" id="L717">            final String myName = pSource.getName();</span>

            /* Create the detail row */
<span class="nc" id="L720">            theBuilder.startRow(myTable);</span>
<span class="nc" id="L721">            theBuilder.makeFilterLinkCell(myTable, myName, MoneyWiseReportBalanceSheet.TEXT_CASH);</span>
<span class="nc" id="L722">            theBuilder.makeValueCell(myTable);</span>
<span class="nc" id="L723">            theBuilder.makeValueCell(myTable);</span>

            /* Handle foreign accounts */
<span class="nc bnc" id="L726" title="All 2 branches missed.">            if (isForeign) {</span>
<span class="nc bnc" id="L727" title="All 2 branches missed.">                if (myCash.isForeignCurrency()) {</span>
<span class="nc" id="L728">                    theBuilder.makeValueCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.FOREIGNVALUE));</span>
<span class="nc" id="L729">                    theBuilder.makeValueCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>
                } else {
<span class="nc" id="L731">                    theBuilder.makeStretchedValueCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>
                }
            } else {
<span class="nc" id="L734">                theBuilder.makeValueCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisAccountAttr.VALUATION));</span>
            }

            /* Record the filter */
<span class="nc" id="L738">            setFilterForId(myName, pSource);</span>
        }

        /* Loop through the Security Buckets */
<span class="nc" id="L742">        final Iterator&lt;MoneyWiseAnalysisSecurityBucket&gt; myIterator = mySecurities.iterator();</span>
<span class="nc bnc" id="L743" title="All 2 branches missed.">        while (myIterator.hasNext()) {</span>
<span class="nc" id="L744">            final MoneyWiseAnalysisSecurityBucket myBucket = myIterator.next();</span>

            /* Skip inactive securities */
<span class="nc bnc" id="L747" title="All 2 branches missed.">            if (!myBucket.isActive()) {</span>
<span class="nc" id="L748">                continue;</span>
            }

            /* Access bucket name */
<span class="nc" id="L752">            final String myName = myBucket.getSecurityName();</span>
<span class="nc" id="L753">            String myFullName = myBucket.getDecoratedName();</span>
<span class="nc" id="L754">            myFullName = myFullName.replace(':', '-');</span>

            /* Access values */
<span class="nc" id="L757">            final MoneyWiseAnalysisSecurityValues myValues = myBucket.getValues();</span>

            /* Create the detail row */
<span class="nc" id="L760">            theBuilder.startRow(myTable);</span>
<span class="nc" id="L761">            theBuilder.makeFilterLinkCell(myTable, myFullName, myName);</span>
<span class="nc" id="L762">            theBuilder.makeValueCell(myTable, myValues.getUnitsValue(MoneyWiseAnalysisSecurityAttr.UNITS));</span>
<span class="nc" id="L763">            theBuilder.makeValueCell(myTable, myValues.getPriceValue(MoneyWiseAnalysisSecurityAttr.PRICE));</span>

            /* Handle foreign securities */
<span class="nc bnc" id="L766" title="All 2 branches missed.">            if (isForeign) {</span>
<span class="nc bnc" id="L767" title="All 2 branches missed.">                if (myBucket.isForeignCurrency()) {</span>
<span class="nc" id="L768">                    theBuilder.makeValueCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisSecurityAttr.FOREIGNVALUE));</span>
<span class="nc" id="L769">                    theBuilder.makeValueCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisSecurityAttr.VALUATION));</span>
                } else {
<span class="nc" id="L771">                    theBuilder.makeStretchedValueCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisSecurityAttr.VALUATION));</span>
                }
            } else {
<span class="nc" id="L774">                theBuilder.makeValueCell(myTable, myValues.getMoneyValue(MoneyWiseAnalysisSecurityAttr.VALUATION));</span>
            }

            /* Record the filter */
<span class="nc" id="L778">            setFilterForId(myFullName, myBucket);</span>
<span class="nc" id="L779">        }</span>

        /* Return the table */
<span class="nc" id="L782">        return myTable;</span>
    }

    @Override
    public MoneyWiseAnalysisFilter&lt;?, ?&gt; processFilter(final Object pSource) {
        /* If this is a DepositBucket */
<span class="nc bnc" id="L788" title="All 2 branches missed.">        if (pSource instanceof MoneyWiseAnalysisDepositBucket mySource) {</span>
            /* Create the new filter */
<span class="nc" id="L790">            return new MoneyWiseAnalysisDepositFilter(mySource);</span>
        }
        /* If this is a CashBucket */
<span class="nc bnc" id="L793" title="All 2 branches missed.">        if (pSource instanceof MoneyWiseAnalysisCashBucket mySource) {</span>
            /* Create the new filter */
<span class="nc" id="L795">            return new MoneyWiseAnalysisCashFilter(mySource);</span>
        }
        /* If this is a LoanBucket */
<span class="nc bnc" id="L798" title="All 2 branches missed.">        if (pSource instanceof MoneyWiseAnalysisLoanBucket mySource) {</span>
            /* Create the new filter */
<span class="nc" id="L800">            return new MoneyWiseAnalysisLoanFilter(mySource);</span>
        }
        /* If this is a SecurityBucket */
<span class="nc bnc" id="L803" title="All 2 branches missed.">        if (pSource instanceof MoneyWiseAnalysisSecurityBucket mySource) {</span>
            /* Create the new filter */
<span class="nc" id="L805">            return new MoneyWiseAnalysisSecurityFilter(mySource);</span>
        }
        /* If this is a PortfolioBucket */
<span class="nc bnc" id="L808" title="All 2 branches missed.">        if (pSource instanceof MoneyWiseAnalysisPortfolioBucket mySource) {</span>
            /* Create the new filter */
<span class="nc" id="L810">            return new MoneyWiseAnalysisPortfolioCashFilter(mySource);</span>
        }
<span class="nc" id="L812">        return null;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>