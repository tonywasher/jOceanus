<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>MoneyWiseQIFLine.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">MoneyWise Personal Finance - Core</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.joceanus.moneywise.quicken.file</a> &gt; <span class="el_source">MoneyWiseQIFLine.java</span></div><h1>MoneyWiseQIFLine.java</h1><pre class="source lang-java linenums">/*******************************************************************************
 * MoneyWise: Finance Application
 * Copyright 2012,2025 Tony Washer
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not
 * use this file except in compliance with the License.  You may obtain a copy
 * of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations under
 * the License.
 ******************************************************************************/
package net.sourceforge.joceanus.moneywise.quicken.file;

import net.sourceforge.joceanus.moneywise.quicken.definitions.MoneyWiseQLineType;
import net.sourceforge.joceanus.oceanus.date.OceanusDate;
import net.sourceforge.joceanus.oceanus.decimal.OceanusDecimal;
import net.sourceforge.joceanus.oceanus.decimal.OceanusMoney;
import net.sourceforge.joceanus.oceanus.decimal.OceanusPrice;
import net.sourceforge.joceanus.oceanus.decimal.OceanusRate;
import net.sourceforge.joceanus.oceanus.decimal.OceanusRatio;
import net.sourceforge.joceanus.oceanus.decimal.OceanusUnits;
import net.sourceforge.joceanus.oceanus.format.OceanusDataFormatter;

import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

/**
 * A standard event line in the QIF file.
 * @param &lt;T&gt; the line type
 */
<span class="nc" id="L37">public abstract class MoneyWiseQIFLine&lt;T extends MoneyWiseQLineType&gt; {</span>
    /**
     * Reconciled flag.
     */
    protected static final String QIF_RECONCILED = &quot;X&quot;;

    /**
     * Transfer begin char.
     */
    private static final String QIF_XFERSTART = &quot;[&quot;;

    /**
     * Transfer end char.
     */
    private static final String QIF_XFEREND = &quot;]&quot;;

    /**
     * Class indicator.
     */
    private static final String QIF_CLASS = &quot;/&quot;;

    /**
     * Class separator.
     */
    private static final String QIF_CLASSSEP = &quot;-&quot;;

    /**
     * Category separator.
     */
    private static final String QIF_CATSEP = &quot;!&quot;;

    /**
     * Obtain line type.
     * @return the line type
     */
    public abstract T getLineType();

    /**
     * Format the data.
     * @param pFormatter the data formatter
     * @param pBuilder the string builder
     */
    protected abstract void formatData(OceanusDataFormatter pFormatter,
                                       StringBuilder pBuilder);

    /**
     * Format lines.
     * @param pFormatter the data formatter
     * @param pBuilder the string builder
     */
    protected void formatLine(final OceanusDataFormatter pFormatter,
                              final StringBuilder pBuilder) {
        /* Add the lineType */
<span class="nc" id="L90">        final T myType = getLineType();</span>
<span class="nc" id="L91">        pBuilder.append(myType.getSymbol());</span>

        /* Format the Data */
<span class="nc" id="L94">        formatData(pFormatter, pBuilder);</span>
<span class="nc" id="L95">    }</span>

    @Override
    public boolean equals(final Object pThat) {
        /* Handle trivial cases */
<span class="nc bnc" id="L100" title="All 2 branches missed.">        if (this == pThat) {</span>
<span class="nc" id="L101">            return true;</span>
        }
<span class="nc bnc" id="L103" title="All 2 branches missed.">        if (pThat == null) {</span>
<span class="nc" id="L104">            return false;</span>
        }

        /* Check class */
<span class="nc bnc" id="L108" title="All 2 branches missed.">        if (!getClass().equals(pThat.getClass())) {</span>
<span class="nc" id="L109">            return false;</span>
        }

        /* Cast correctly */
<span class="nc" id="L113">        final MoneyWiseQIFLine&lt;?&gt; myLine = (MoneyWiseQIFLine&lt;?&gt;) pThat;</span>

        /* Check value */
<span class="nc" id="L116">        return getLineType().equals(myLine.getLineType());</span>
    }

    @Override
    public int hashCode() {
<span class="nc" id="L121">        return getLineType().hashCode();</span>
    }

    /**
     * The String line.
     * @param &lt;X&gt; the line type
     */
    protected abstract static class MoneyWiseQIFStringLine&lt;X extends MoneyWiseQLineType&gt;
            extends MoneyWiseQIFLine&lt;X&gt; {
        /**
         * The value.
         */
        private final String theValue;

        /**
         * Constructor.
         * @param pValue the Value
         */
<span class="nc" id="L139">        protected MoneyWiseQIFStringLine(final String pValue) {</span>
            /* Store the value */
<span class="nc" id="L141">            theValue = pValue;</span>
<span class="nc" id="L142">        }</span>

        @Override
        public String toString() {
<span class="nc" id="L146">            return getValue();</span>
        }

        /**
         * Obtain Value.
         * @return the value
         */
        protected String getValue() {
<span class="nc" id="L154">            return theValue;</span>
        }

        @Override
        protected void formatData(final OceanusDataFormatter pFormatter,
                                  final StringBuilder pBuilder) {
            /* Append the string data */
<span class="nc" id="L161">            pBuilder.append(theValue);</span>
<span class="nc" id="L162">        }</span>

        @Override
        public boolean equals(final Object pThat) {
            /* Handle trivial cases */
<span class="nc bnc" id="L167" title="All 2 branches missed.">            if (this == pThat) {</span>
<span class="nc" id="L168">                return true;</span>
            }
<span class="nc bnc" id="L170" title="All 2 branches missed.">            if (pThat == null) {</span>
<span class="nc" id="L171">                return false;</span>
            }

            /* Check class */
<span class="nc bnc" id="L175" title="All 2 branches missed.">            if (!getClass().equals(pThat.getClass())) {</span>
<span class="nc" id="L176">                return false;</span>
            }

            /* Cast correctly */
<span class="nc" id="L180">            final MoneyWiseQIFStringLine&lt;?&gt; myLine = (MoneyWiseQIFStringLine&lt;?&gt;) pThat;</span>

            /* Check line type */
<span class="nc bnc" id="L183" title="All 2 branches missed.">            if (!getLineType().equals(myLine.getLineType())) {</span>
<span class="nc" id="L184">                return false;</span>
            }

            /* Check value */
<span class="nc" id="L188">            return theValue.equals(myLine.getValue());</span>
        }

        @Override
        public int hashCode() {
<span class="nc" id="L193">            final int myResult = MoneyWiseQIFFile.HASH_BASE * getLineType().hashCode();</span>
<span class="nc" id="L194">            return myResult + theValue.hashCode();</span>
        }
    }

    /**
     * The Money line.
     * @param &lt;X&gt; the line type
     */
    protected abstract static class MoneyWiseQIFMoneyLine&lt;X extends MoneyWiseQLineType&gt;
            extends MoneyWiseQIFLine&lt;X&gt; {
        /**
         * The money.
         */
        private final OceanusMoney theMoney;

        /**
         * Constructor.
         * @param pMoney the Money
         */
<span class="nc" id="L213">        protected MoneyWiseQIFMoneyLine(final OceanusMoney pMoney) {</span>
            /* Store data */
<span class="nc" id="L215">            theMoney = pMoney;</span>
<span class="nc" id="L216">        }</span>

        @Override
        public String toString() {
<span class="nc" id="L220">            return getMoney().toString();</span>
        }

        /**
         * Obtain Money.
         * @return the money
         */
        protected OceanusMoney getMoney() {
<span class="nc" id="L228">            return theMoney;</span>
        }

        @Override
        protected void formatData(final OceanusDataFormatter pFormatter,
                                  final StringBuilder pBuilder) {
            /* Convert to Decimal */
<span class="nc" id="L235">            final OceanusDecimal myDecimal = new OceanusDecimal(theMoney);</span>

            /* Append the string data */
<span class="nc" id="L238">            pBuilder.append(pFormatter.formatObject(myDecimal));</span>
<span class="nc" id="L239">        }</span>

        @Override
        public boolean equals(final Object pThat) {
            /* Handle trivial cases */
<span class="nc bnc" id="L244" title="All 2 branches missed.">            if (this == pThat) {</span>
<span class="nc" id="L245">                return true;</span>
            }
<span class="nc bnc" id="L247" title="All 2 branches missed.">            if (pThat == null) {</span>
<span class="nc" id="L248">                return false;</span>
            }

            /* Check class */
<span class="nc bnc" id="L252" title="All 2 branches missed.">            if (!getClass().equals(pThat.getClass())) {</span>
<span class="nc" id="L253">                return false;</span>
            }

            /* Cast correctly */
<span class="nc" id="L257">            final MoneyWiseQIFMoneyLine&lt;?&gt; myLine = (MoneyWiseQIFMoneyLine&lt;?&gt;) pThat;</span>

            /* Check line type */
<span class="nc bnc" id="L260" title="All 2 branches missed.">            if (!getLineType().equals(myLine.getLineType())) {</span>
<span class="nc" id="L261">                return false;</span>
            }

            /* Check value */
<span class="nc" id="L265">            return theMoney.equals(myLine.getMoney());</span>
        }

        @Override
        public int hashCode() {
<span class="nc" id="L270">            final int myResult = MoneyWiseQIFFile.HASH_BASE * getLineType().hashCode();</span>
<span class="nc" id="L271">            return myResult + theMoney.hashCode();</span>
        }
    }

    /**
     * The Date line.
     * @param &lt;X&gt; the line type
     */
    protected abstract static class MoneyWiseQIFDateLine&lt;X extends MoneyWiseQLineType&gt;
            extends MoneyWiseQIFLine&lt;X&gt; {
        /**
         * The date.
         */
        private final OceanusDate theDate;

        /**
         * Constructor.
         * @param pDate the Date
         */
<span class="nc" id="L290">        protected MoneyWiseQIFDateLine(final OceanusDate pDate) {</span>
            /* Store the date */
<span class="nc" id="L292">            theDate = pDate;</span>
<span class="nc" id="L293">        }</span>

        @Override
        public String toString() {
<span class="nc" id="L297">            return getDate().toString();</span>
        }

        /**
         * Obtain Date.
         * @return the date
         */
        public OceanusDate getDate() {
<span class="nc" id="L305">            return theDate;</span>
        }

        @Override
        protected void formatData(final OceanusDataFormatter pFormatter,
                                  final StringBuilder pBuilder) {
            /* Append the string data */
<span class="nc" id="L312">            pBuilder.append(pFormatter.formatObject(theDate));</span>
<span class="nc" id="L313">        }</span>

        @Override
        public boolean equals(final Object pThat) {
            /* Handle trivial cases */
<span class="nc bnc" id="L318" title="All 2 branches missed.">            if (this == pThat) {</span>
<span class="nc" id="L319">                return true;</span>
            }
<span class="nc bnc" id="L321" title="All 2 branches missed.">            if (pThat == null) {</span>
<span class="nc" id="L322">                return false;</span>
            }

            /* Check class */
<span class="nc bnc" id="L326" title="All 2 branches missed.">            if (!getClass().equals(pThat.getClass())) {</span>
<span class="nc" id="L327">                return false;</span>
            }

            /* Cast correctly */
<span class="nc" id="L331">            final MoneyWiseQIFDateLine&lt;?&gt; myLine = (MoneyWiseQIFDateLine&lt;?&gt;) pThat;</span>

            /* Check line type */
<span class="nc bnc" id="L334" title="All 2 branches missed.">            if (!getLineType().equals(myLine.getLineType())) {</span>
<span class="nc" id="L335">                return false;</span>
            }

            /* Check value */
<span class="nc" id="L339">            return theDate.equals(myLine.getDate());</span>
        }

        @Override
        public int hashCode() {
<span class="nc" id="L344">            final int myResult = MoneyWiseQIFFile.HASH_BASE * getLineType().hashCode();</span>
<span class="nc" id="L345">            return myResult + theDate.hashCode();</span>
        }
    }

    /**
     * The Flag line.
     * @param &lt;X&gt; the line type
     */
    protected abstract static class MoneyWiseQIFFlagLine&lt;X extends MoneyWiseQLineType&gt;
            extends MoneyWiseQIFLine&lt;X&gt; {
        /**
         * The flag status.
         */
        private final Boolean isSet;

        /**
         * Constructor.
         * @param pSet is the flag set?
         */
<span class="nc" id="L364">        protected MoneyWiseQIFFlagLine(final Boolean pSet) {</span>
            /* Store data */
<span class="nc" id="L366">            isSet = pSet;</span>
<span class="nc" id="L367">        }</span>

        @Override
        public String toString() {
<span class="nc" id="L371">            return isSet().toString();</span>
        }

        /**
         * Obtain Cleared status.
         * @return true/false
         */
        protected Boolean isSet() {
<span class="nc" id="L379">            return isSet;</span>
        }

        @Override
        public boolean equals(final Object pThat) {
            /* Handle trivial cases */
<span class="nc bnc" id="L385" title="All 2 branches missed.">            if (this == pThat) {</span>
<span class="nc" id="L386">                return true;</span>
            }
<span class="nc bnc" id="L388" title="All 2 branches missed.">            if (pThat == null) {</span>
<span class="nc" id="L389">                return false;</span>
            }

            /* Check class */
<span class="nc bnc" id="L393" title="All 2 branches missed.">            if (!getClass().equals(pThat.getClass())) {</span>
<span class="nc" id="L394">                return false;</span>
            }

            /* Cast correctly */
<span class="nc" id="L398">            final MoneyWiseQIFFlagLine&lt;?&gt; myLine = (MoneyWiseQIFFlagLine&lt;?&gt;) pThat;</span>

            /* Check line type */
<span class="nc bnc" id="L401" title="All 2 branches missed.">            if (!getLineType().equals(myLine.getLineType())) {</span>
<span class="nc" id="L402">                return false;</span>
            }

            /* Check value */
<span class="nc" id="L406">            return isSet.equals(myLine.isSet());</span>
        }

        @Override
        public int hashCode() {
<span class="nc" id="L411">            final int myResult = MoneyWiseQIFFile.HASH_BASE * getLineType().hashCode();</span>
<span class="nc" id="L412">            return myResult + isSet.hashCode();</span>
        }
    }

    /**
     * The Cleared line.
     * @param &lt;X&gt; the line type
     */
    protected abstract static class MoneyWiseQIFClearedLine&lt;X extends MoneyWiseQLineType&gt;
            extends MoneyWiseQIFFlagLine&lt;X&gt; {
        /**
         * Constructor.
         * @param pSet is the flag set?
         */
        protected MoneyWiseQIFClearedLine(final Boolean pSet) {
            /* Call super-constructor */
<span class="nc" id="L428">            super(pSet);</span>
<span class="nc" id="L429">        }</span>

        /**
         * Obtain Cleared status.
         * @return true/false
         */
        public Boolean isCleared() {
<span class="nc" id="L436">            return isSet();</span>
        }

        @Override
        protected void formatData(final OceanusDataFormatter pFormatter,
                                  final StringBuilder pBuilder) {
            /* If we should set the flag */
<span class="nc bnc" id="L443" title="All 2 branches missed.">            if (isSet()) {</span>
                /* Add the flag */
<span class="nc" id="L445">                pBuilder.append(QIF_RECONCILED);</span>
            }
<span class="nc" id="L447">        }</span>
    }

    /**
     * The Price line.
     * @param &lt;X&gt; the line type
     */
    protected abstract static class MoneyWiseQIFPriceLine&lt;X extends MoneyWiseQLineType&gt;
            extends MoneyWiseQIFLine&lt;X&gt; {
        /**
         * The price.
         */
        private final OceanusPrice thePrice;

        /**
         * Constructor.
         * @param pPrice the Price
         */
<span class="nc" id="L465">        protected MoneyWiseQIFPriceLine(final OceanusPrice pPrice) {</span>
            /* Store data */
<span class="nc" id="L467">            thePrice = pPrice;</span>
<span class="nc" id="L468">        }</span>

        @Override
        public String toString() {
<span class="nc" id="L472">            return getPrice().toString();</span>
        }

        /**
         * Obtain price.
         * @return the price
         */
        protected OceanusPrice getPrice() {
<span class="nc" id="L480">            return thePrice;</span>
        }

        @Override
        protected void formatData(final OceanusDataFormatter pFormatter,
                                  final StringBuilder pBuilder) {
            /* Convert to Decimal */
<span class="nc" id="L487">            final OceanusDecimal myDecimal = new OceanusDecimal(thePrice);</span>

            /* Append the string data */
<span class="nc" id="L490">            pBuilder.append(pFormatter.formatObject(myDecimal));</span>
<span class="nc" id="L491">        }</span>

        @Override
        public boolean equals(final Object pThat) {
            /* Handle trivial cases */
<span class="nc bnc" id="L496" title="All 2 branches missed.">            if (this == pThat) {</span>
<span class="nc" id="L497">                return true;</span>
            }
<span class="nc bnc" id="L499" title="All 2 branches missed.">            if (pThat == null) {</span>
<span class="nc" id="L500">                return false;</span>
            }

            /* Check class */
<span class="nc bnc" id="L504" title="All 2 branches missed.">            if (!getClass().equals(pThat.getClass())) {</span>
<span class="nc" id="L505">                return false;</span>
            }

            /* Cast correctly */
<span class="nc" id="L509">            final MoneyWiseQIFPriceLine&lt;?&gt; myLine = (MoneyWiseQIFPriceLine&lt;?&gt;) pThat;</span>

            /* Check line type */
<span class="nc bnc" id="L512" title="All 2 branches missed.">            if (!getLineType().equals(myLine.getLineType())) {</span>
<span class="nc" id="L513">                return false;</span>
            }

            /* Check value */
<span class="nc" id="L517">            return thePrice.equals(myLine.getPrice());</span>
        }

        @Override
        public int hashCode() {
<span class="nc" id="L522">            final int myResult = MoneyWiseQIFFile.HASH_BASE * getLineType().hashCode();</span>
<span class="nc" id="L523">            return myResult + thePrice.hashCode();</span>
        }
    }

    /**
     * The Units line.
     * @param &lt;X&gt; the line type
     */
    protected abstract static class MoneyWiseQIFUnitsLine&lt;X extends MoneyWiseQLineType&gt;
            extends MoneyWiseQIFLine&lt;X&gt; {
        /**
         * The units.
         */
        private final OceanusUnits theUnits;

        /**
         * Constructor.
         * @param pUnits the Units
         */
<span class="nc" id="L542">        protected MoneyWiseQIFUnitsLine(final OceanusUnits pUnits) {</span>
            /* Store data */
<span class="nc" id="L544">            theUnits = pUnits;</span>
<span class="nc" id="L545">        }</span>

        @Override
        public String toString() {
<span class="nc" id="L549">            return getUnits().toString();</span>
        }

        /**
         * Obtain units.
         * @return the units
         */
        protected OceanusUnits getUnits() {
<span class="nc" id="L557">            return theUnits;</span>
        }

        @Override
        protected void formatData(final OceanusDataFormatter pFormatter,
                                  final StringBuilder pBuilder) {
            /* Append the string data */
<span class="nc" id="L564">            pBuilder.append(pFormatter.formatObject(theUnits));</span>
<span class="nc" id="L565">        }</span>

        @Override
        public boolean equals(final Object pThat) {
            /* Handle trivial cases */
<span class="nc bnc" id="L570" title="All 2 branches missed.">            if (this == pThat) {</span>
<span class="nc" id="L571">                return true;</span>
            }
<span class="nc bnc" id="L573" title="All 2 branches missed.">            if (pThat == null) {</span>
<span class="nc" id="L574">                return false;</span>
            }

            /* Check class */
<span class="nc bnc" id="L578" title="All 2 branches missed.">            if (!getClass().equals(pThat.getClass())) {</span>
<span class="nc" id="L579">                return false;</span>
            }

            /* Cast correctly */
<span class="nc" id="L583">            final MoneyWiseQIFUnitsLine&lt;?&gt; myLine = (MoneyWiseQIFUnitsLine&lt;?&gt;) pThat;</span>

            /* Check line type */
<span class="nc bnc" id="L586" title="All 2 branches missed.">            if (!getLineType().equals(myLine.getLineType())) {</span>
<span class="nc" id="L587">                return false;</span>
            }

            /* Check value */
<span class="nc" id="L591">            return theUnits.equals(myLine.getUnits());</span>
        }

        @Override
        public int hashCode() {
<span class="nc" id="L596">            final int myResult = MoneyWiseQIFFile.HASH_BASE * getLineType().hashCode();</span>
<span class="nc" id="L597">            return myResult + theUnits.hashCode();</span>
        }
    }

    /**
     * The Rate line.
     * @param &lt;X&gt; the line type
     */
    protected abstract static class MoneyWiseQIFRateLine&lt;X extends MoneyWiseQLineType&gt;
            extends MoneyWiseQIFLine&lt;X&gt; {
        /**
         * The Rate.
         */
        private final OceanusRate theRate;

        /**
         * Constructor.
         * @param pPercent the percentage
         */
<span class="nc" id="L616">        protected MoneyWiseQIFRateLine(final OceanusRate pPercent) {</span>
            /* Store data */
<span class="nc" id="L618">            theRate = pPercent;</span>
<span class="nc" id="L619">        }</span>

        @Override
        public String toString() {
<span class="nc" id="L623">            return getRate().toString();</span>
        }

        /**
         * Obtain rate.
         * @return the rate
         */
        protected OceanusRate getRate() {
<span class="nc" id="L631">            return theRate;</span>
        }

        @Override
        protected void formatData(final OceanusDataFormatter pFormatter,
                                  final StringBuilder pBuilder) {
            /* Append the string data */
<span class="nc" id="L638">            pBuilder.append(pFormatter.formatObject(theRate));</span>
<span class="nc" id="L639">        }</span>

        @Override
        public boolean equals(final Object pThat) {
            /* Handle trivial cases */
<span class="nc bnc" id="L644" title="All 2 branches missed.">            if (this == pThat) {</span>
<span class="nc" id="L645">                return true;</span>
            }
<span class="nc bnc" id="L647" title="All 2 branches missed.">            if (pThat == null) {</span>
<span class="nc" id="L648">                return false;</span>
            }

            /* Check class */
<span class="nc bnc" id="L652" title="All 2 branches missed.">            if (!getClass().equals(pThat.getClass())) {</span>
<span class="nc" id="L653">                return false;</span>
            }

            /* Cast correctly */
<span class="nc" id="L657">            final MoneyWiseQIFRateLine&lt;?&gt; myLine = (MoneyWiseQIFRateLine&lt;?&gt;) pThat;</span>

            /* Check line type */
<span class="nc bnc" id="L660" title="All 2 branches missed.">            if (!getLineType().equals(myLine.getLineType())) {</span>
<span class="nc" id="L661">                return false;</span>
            }

            /* Check value */
<span class="nc" id="L665">            return theRate.equals(myLine.getRate());</span>
        }

        @Override
        public int hashCode() {
<span class="nc" id="L670">            final int myResult = MoneyWiseQIFFile.HASH_BASE * getLineType().hashCode();</span>
<span class="nc" id="L671">            return myResult + theRate.hashCode();</span>
        }
    }

    /**
     * The Ratio line.
     * @param &lt;X&gt; the line type
     */
    protected abstract static class MoneyWiseQIFRatioLine&lt;X extends MoneyWiseQLineType&gt;
            extends MoneyWiseQIFLine&lt;X&gt; {
        /**
         * The ratio.
         */
        private final OceanusRatio theRatio;

        /**
         * Constructor.
         * @param pRatio the Ratio
         */
<span class="nc" id="L690">        protected MoneyWiseQIFRatioLine(final OceanusRatio pRatio) {</span>
            /* Store data */
<span class="nc" id="L692">            theRatio = pRatio;</span>
<span class="nc" id="L693">        }</span>

        @Override
        public String toString() {
<span class="nc" id="L697">            return getRatio().toString();</span>
        }

        /**
         * Obtain ratio.
         * @return the ratio
         */
        protected OceanusRatio getRatio() {
<span class="nc" id="L705">            return theRatio;</span>
        }

        @Override
        protected void formatData(final OceanusDataFormatter pFormatter,
                                  final StringBuilder pBuilder) {
            /* Append the string data */
<span class="nc" id="L712">            pBuilder.append(pFormatter.formatObject(theRatio));</span>
<span class="nc" id="L713">        }</span>

        @Override
        public boolean equals(final Object pThat) {
            /* Handle trivial cases */
<span class="nc bnc" id="L718" title="All 2 branches missed.">            if (this == pThat) {</span>
<span class="nc" id="L719">                return true;</span>
            }
<span class="nc bnc" id="L721" title="All 2 branches missed.">            if (pThat == null) {</span>
<span class="nc" id="L722">                return false;</span>
            }

            /* Check class */
<span class="nc bnc" id="L726" title="All 2 branches missed.">            if (!getClass().equals(pThat.getClass())) {</span>
<span class="nc" id="L727">                return false;</span>
            }

            /* Cast correctly */
<span class="nc" id="L731">            final MoneyWiseQIFRatioLine&lt;?&gt; myLine = (MoneyWiseQIFRatioLine&lt;?&gt;) pThat;</span>

            /* Check line type */
<span class="nc bnc" id="L734" title="All 2 branches missed.">            if (!getLineType().equals(myLine.getLineType())) {</span>
<span class="nc" id="L735">                return false;</span>
            }

            /* Check value */
<span class="nc" id="L739">            return theRatio.equals(myLine.getRatio());</span>
        }

        @Override
        public int hashCode() {
<span class="nc" id="L744">            final int myResult = MoneyWiseQIFFile.HASH_BASE * getLineType().hashCode();</span>
<span class="nc" id="L745">            return myResult + theRatio.hashCode();</span>
        }
    }

    /**
     * The Security line.
     * @param &lt;X&gt; the line type
     */
    public abstract static class MoneyWiseQIFSecurityLine&lt;X extends MoneyWiseQLineType&gt;
            extends MoneyWiseQIFLine&lt;X&gt; {
        /**
         * The security.
         */
        private final MoneyWiseQIFSecurity theSecurity;

        /**
         * Constructor.
         * @param pSecurity the Security
         */
<span class="nc" id="L764">        protected MoneyWiseQIFSecurityLine(final MoneyWiseQIFSecurity pSecurity) {</span>
            /* Store data */
<span class="nc" id="L766">            theSecurity = pSecurity;</span>
<span class="nc" id="L767">        }</span>

        @Override
        public String toString() {
<span class="nc" id="L771">            return theSecurity.toString();</span>
        }

        /**
         * Obtain account.
         * @return the account
         */
        public MoneyWiseQIFSecurity getSecurity() {
<span class="nc" id="L779">            return theSecurity;</span>
        }

        @Override
        protected void formatData(final OceanusDataFormatter pFormatter,
                                  final StringBuilder pBuilder) {
            /* Append the security name */
<span class="nc" id="L786">            pBuilder.append(theSecurity.getName());</span>
<span class="nc" id="L787">        }</span>

        @Override
        public boolean equals(final Object pThat) {
            /* Handle trivial cases */
<span class="nc bnc" id="L792" title="All 2 branches missed.">            if (this == pThat) {</span>
<span class="nc" id="L793">                return true;</span>
            }
<span class="nc bnc" id="L795" title="All 2 branches missed.">            if (pThat == null) {</span>
<span class="nc" id="L796">                return false;</span>
            }

            /* Check class */
<span class="nc bnc" id="L800" title="All 2 branches missed.">            if (!getClass().equals(pThat.getClass())) {</span>
<span class="nc" id="L801">                return false;</span>
            }

            /* Cast correctly */
<span class="nc" id="L805">            final MoneyWiseQIFSecurityLine&lt;?&gt; myLine = (MoneyWiseQIFSecurityLine&lt;?&gt;) pThat;</span>

            /* Check line type */
<span class="nc bnc" id="L808" title="All 2 branches missed.">            if (!getLineType().equals(myLine.getLineType())) {</span>
<span class="nc" id="L809">                return false;</span>
            }

            /* Check value */
<span class="nc" id="L813">            return theSecurity.equals(myLine.getSecurity());</span>
        }

        @Override
        public int hashCode() {
<span class="nc" id="L818">            final int myResult = MoneyWiseQIFFile.HASH_BASE * getLineType().hashCode();</span>
<span class="nc" id="L819">            return myResult + theSecurity.hashCode();</span>
        }
    }

    /**
     * The Account line.
     * @param &lt;X&gt; the line type
     */
    public abstract static class MoneyWiseQIFXferAccountLine&lt;X extends MoneyWiseQLineType&gt;
            extends MoneyWiseQIFLine&lt;X&gt; {
        /**
         * The account.
         */
        private final MoneyWiseQIFAccount theAccount;

        /**
         * The class list.
         */
        private final List&lt;MoneyWiseQIFClass&gt; theClasses;

        /**
         * Constructor.
         * @param pAccount the Account
         */
        protected MoneyWiseQIFXferAccountLine(final MoneyWiseQIFAccount pAccount) {
<span class="nc" id="L844">            this(pAccount, null);</span>
<span class="nc" id="L845">        }</span>

        /**
         * Constructor.
         * @param pAccount the Account
         * @param pClasses the classes
         */
        protected MoneyWiseQIFXferAccountLine(final MoneyWiseQIFAccount pAccount,
<span class="nc" id="L853">                                              final List&lt;MoneyWiseQIFClass&gt; pClasses) {</span>
            /* Store data */
<span class="nc" id="L855">            theAccount = pAccount;</span>
<span class="nc" id="L856">            theClasses = pClasses;</span>
<span class="nc" id="L857">        }</span>

        @Override
        public String toString() {
<span class="nc" id="L861">            return theAccount.toString();</span>
        }

        /**
         * Obtain account.
         * @return the account
         */
        public MoneyWiseQIFAccount getAccount() {
<span class="nc" id="L869">            return theAccount;</span>
        }

        /**
         * Obtain class list.
         * @return the class list
         */
        public List&lt;MoneyWiseQIFClass&gt; getClassList() {
<span class="nc" id="L877">            return theClasses;</span>
        }

        @Override
        protected void formatData(final OceanusDataFormatter pFormatter,
                                  final StringBuilder pBuilder) {
            /* Append the string data */
<span class="nc" id="L884">            pBuilder.append(QIF_XFERSTART);</span>
<span class="nc" id="L885">            pBuilder.append(theAccount.getName());</span>
<span class="nc" id="L886">            pBuilder.append(QIF_XFEREND);</span>

            /* If we have classes */
<span class="nc bnc" id="L889" title="All 2 branches missed.">            if (theClasses != null) {</span>
                /* Add class indicator */
<span class="nc" id="L891">                pBuilder.append(QIF_CLASS);</span>

                /* Iterate through the list */
<span class="nc" id="L894">                final Iterator&lt;MoneyWiseQIFClass&gt; myIterator = theClasses.iterator();</span>
<span class="nc bnc" id="L895" title="All 2 branches missed.">                while (myIterator.hasNext()) {</span>
<span class="nc" id="L896">                    final MoneyWiseQIFClass myClass = myIterator.next();</span>

                    /* Add to the list */
<span class="nc" id="L899">                    pBuilder.append(myClass.getName());</span>
<span class="nc bnc" id="L900" title="All 2 branches missed.">                    if (myIterator.hasNext()) {</span>
<span class="nc" id="L901">                        pBuilder.append(QIF_CLASSSEP);</span>
                    }
<span class="nc" id="L903">                }</span>
            }
<span class="nc" id="L905">        }</span>

        /**
         * Parse account line.
         * @param pFile the QIF File definitions
         * @param pLine the line.
         * @return the account name (or null)
         */
        protected static MoneyWiseQIFAccount parseAccount(final MoneyWiseQIFFile pFile,
                                                          final String pLine) {
            /* Determine line to use */
<span class="nc" id="L916">            String myLine = pLine;</span>

            /* If the line contains a category separator */
<span class="nc bnc" id="L919" title="All 2 branches missed.">            if (pLine.contains(QIF_CATSEP)) {</span>
                /* Move to data following separator */
<span class="nc" id="L921">                final int i = pLine.indexOf(QIF_CATSEP);</span>
<span class="nc" id="L922">                myLine = pLine.substring(i + 1);</span>
            }

            /* If the line contains classes */
<span class="nc bnc" id="L926" title="All 2 branches missed.">            if (myLine.contains(QIF_CLASS)) {</span>
                /* drop class data */
<span class="nc" id="L928">                final int i = myLine.indexOf(QIF_CLASS);</span>
<span class="nc" id="L929">                myLine = myLine.substring(0, i);</span>
            }

            /* If we have the account delimiters */
<span class="nc bnc" id="L933" title="All 2 branches missed.">            if ((myLine.startsWith(QIF_XFERSTART))</span>
<span class="nc bnc" id="L934" title="All 2 branches missed.">                    &amp;&amp; (myLine.endsWith(QIF_XFEREND))) {</span>
                /* Remove account delimiters */
<span class="nc" id="L936">                final int i = QIF_XFERSTART.length();</span>
<span class="nc" id="L937">                final int j = QIF_XFEREND.length();</span>
<span class="nc" id="L938">                final String myAccount = myLine.substring(i, myLine.length()</span>
                        - j);
<span class="nc" id="L940">                return pFile.getAccount(myAccount);</span>
            }

            /* Return no account */
<span class="nc" id="L944">            return null;</span>
        }

        /**
         * Parse account classes.
         * @param pFile the QIF File
         * @param pLine the line.
         * @return the account name (or null)
         */
        protected static List&lt;MoneyWiseQIFClass&gt; parseAccountClasses(final MoneyWiseQIFFile pFile,
                                                                     final String pLine) {
            /* Determine line to use */
<span class="nc" id="L956">            String myLine = pLine;</span>

            /* If the line contains a category separator */
<span class="nc bnc" id="L959" title="All 2 branches missed.">            if (pLine.contains(QIF_CATSEP)) {</span>
                /* Move to data following separator */
<span class="nc" id="L961">                final int i = pLine.indexOf(QIF_CATSEP);</span>
<span class="nc" id="L962">                myLine = pLine.substring(i + 1);</span>
            }

            /* If the line contains classes */
<span class="nc bnc" id="L966" title="All 2 branches missed.">            if (myLine.contains(QIF_CLASS)) {</span>
                /* drop preceding data */
<span class="nc" id="L968">                final int i = myLine.indexOf(QIF_CLASS);</span>
<span class="nc" id="L969">                myLine = myLine.substring(i + 1);</span>

                /* Build list of classes */
<span class="nc" id="L972">                final String[] myClasses = myLine.split(QIF_CLASSSEP);</span>
<span class="nc" id="L973">                final List&lt;MoneyWiseQIFClass&gt; myList = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L974" title="All 2 branches missed.">                for (String myClass : myClasses) {</span>
<span class="nc" id="L975">                    myList.add(pFile.getClass(myClass));</span>
                }

                /* Return the classes */
<span class="nc" id="L979">                return myList;</span>
            }

            /* Return no classes */
<span class="nc" id="L983">            return null;</span>
        }

        @Override
        public boolean equals(final Object pThat) {
            /* Handle trivial cases */
<span class="nc bnc" id="L989" title="All 2 branches missed.">            if (this == pThat) {</span>
<span class="nc" id="L990">                return true;</span>
            }
<span class="nc bnc" id="L992" title="All 2 branches missed.">            if (pThat == null) {</span>
<span class="nc" id="L993">                return false;</span>
            }

            /* Check class */
<span class="nc bnc" id="L997" title="All 2 branches missed.">            if (!getClass().equals(pThat.getClass())) {</span>
<span class="nc" id="L998">                return false;</span>
            }

            /* Cast correctly */
<span class="nc" id="L1002">            final MoneyWiseQIFXferAccountLine&lt;?&gt; myLine = (MoneyWiseQIFXferAccountLine&lt;?&gt;) pThat;</span>

            /* Check line type */
<span class="nc bnc" id="L1005" title="All 2 branches missed.">            if (!getLineType().equals(myLine.getLineType())) {</span>
<span class="nc" id="L1006">                return false;</span>
            }

            /* Check account */
<span class="nc bnc" id="L1010" title="All 2 branches missed.">            if (!theAccount.equals(myLine.getAccount())) {</span>
<span class="nc" id="L1011">                return false;</span>
            }

            /* Check classes */
<span class="nc" id="L1015">            final List&lt;MoneyWiseQIFClass&gt; myClasses = myLine.getClassList();</span>
<span class="nc bnc" id="L1016" title="All 2 branches missed.">            if (theClasses == null) {</span>
<span class="nc bnc" id="L1017" title="All 2 branches missed.">                return myClasses == null;</span>
<span class="nc bnc" id="L1018" title="All 2 branches missed.">            } else if (myClasses == null) {</span>
<span class="nc" id="L1019">                return true;</span>
            }
<span class="nc" id="L1021">            return theClasses.equals(myClasses);</span>
        }

        @Override
        public int hashCode() {
<span class="nc" id="L1026">            int myResult = MoneyWiseQIFFile.HASH_BASE * getLineType().hashCode();</span>
<span class="nc bnc" id="L1027" title="All 2 branches missed.">            if (theClasses != null) {</span>
<span class="nc" id="L1028">                myResult += theClasses.hashCode();</span>
<span class="nc" id="L1029">                myResult *= MoneyWiseQIFFile.HASH_BASE;</span>
            }
<span class="nc" id="L1031">            return myResult + theAccount.hashCode();</span>
        }
    }

    /**
     * The Payee line.
     * @param &lt;X&gt; the line type
     */
    public abstract static class MoneyWiseQIFPayeeLine&lt;X extends MoneyWiseQLineType&gt;
            extends MoneyWiseQIFLine&lt;X&gt; {
        /**
         * The payee.
         */
        private final MoneyWiseQIFPayee thePayee;

        /**
         * Constructor.
         * @param pPayee the Payee
         */
<span class="nc" id="L1050">        protected MoneyWiseQIFPayeeLine(final MoneyWiseQIFPayee pPayee) {</span>
            /* Store data */
<span class="nc" id="L1052">            thePayee = pPayee;</span>
<span class="nc" id="L1053">        }</span>

        @Override
        public String toString() {
<span class="nc" id="L1057">            return thePayee.toString();</span>
        }

        /**
         * Obtain payee.
         * @return the payee
         */
        public MoneyWiseQIFPayee getPayee() {
<span class="nc" id="L1065">            return thePayee;</span>
        }

        @Override
        protected void formatData(final OceanusDataFormatter pFormatter,
                                  final StringBuilder pBuilder) {
            /* Append the string data */
<span class="nc" id="L1072">            pBuilder.append(thePayee.getName());</span>
<span class="nc" id="L1073">        }</span>

        @Override
        public boolean equals(final Object pThat) {
            /* Handle trivial cases */
<span class="nc bnc" id="L1078" title="All 2 branches missed.">            if (this == pThat) {</span>
<span class="nc" id="L1079">                return true;</span>
            }
<span class="nc bnc" id="L1081" title="All 2 branches missed.">            if (pThat == null) {</span>
<span class="nc" id="L1082">                return false;</span>
            }

            /* Check class */
<span class="nc bnc" id="L1086" title="All 2 branches missed.">            if (!getClass().equals(pThat.getClass())) {</span>
<span class="nc" id="L1087">                return false;</span>
            }

            /* Cast correctly */
<span class="nc" id="L1091">            final MoneyWiseQIFPayeeLine&lt;?&gt; myLine = (MoneyWiseQIFPayeeLine&lt;?&gt;) pThat;</span>

            /* Check line type */
<span class="nc bnc" id="L1094" title="All 2 branches missed.">            if (!getLineType().equals(myLine.getLineType())) {</span>
<span class="nc" id="L1095">                return false;</span>
            }

            /* Check value */
<span class="nc" id="L1099">            return thePayee.equals(myLine.getPayee());</span>
        }

        @Override
        public int hashCode() {
<span class="nc" id="L1104">            final int myResult = MoneyWiseQIFFile.HASH_BASE * getLineType().hashCode();</span>
<span class="nc" id="L1105">            return myResult + thePayee.hashCode();</span>
        }
    }

    /**
     * The Event Category line.
     * @param &lt;X&gt; the line type
     */
    public abstract static class MoneyWiseQIFCategoryLine&lt;X extends MoneyWiseQLineType&gt;
            extends MoneyWiseQIFLine&lt;X&gt; {
        /**
         * The event category.
         */
        private final MoneyWiseQIFEventCategory theCategory;

        /**
         * The class list.
         */
        private final List&lt;MoneyWiseQIFClass&gt; theClasses;

        /**
         * Constructor.
         * @param pCategory the Event Category
         */
        protected MoneyWiseQIFCategoryLine(final MoneyWiseQIFEventCategory pCategory) {
<span class="nc" id="L1130">            this(pCategory, null);</span>
<span class="nc" id="L1131">        }</span>

        /**
         * Constructor.
         * @param pCategory the Event Category
         * @param pClasses the classes
         */
        protected MoneyWiseQIFCategoryLine(final MoneyWiseQIFEventCategory pCategory,
<span class="nc" id="L1139">                                           final List&lt;MoneyWiseQIFClass&gt; pClasses) {</span>
            /* Store data */
<span class="nc" id="L1141">            theCategory = pCategory;</span>
<span class="nc" id="L1142">            theClasses = pClasses;</span>
<span class="nc" id="L1143">        }</span>

        @Override
        public String toString() {
<span class="nc" id="L1147">            return theCategory.toString();</span>
        }

        /**
         * Obtain event category.
         * @return the event category
         */
        public MoneyWiseQIFEventCategory getEventCategory() {
<span class="nc" id="L1155">            return theCategory;</span>
        }

        /**
         * Obtain class list.
         * @return the class list
         */
        public List&lt;MoneyWiseQIFClass&gt; getClassList() {
<span class="nc" id="L1163">            return theClasses;</span>
        }

        @Override
        protected void formatData(final OceanusDataFormatter pFormatter,
                                  final StringBuilder pBuilder) {
            /* Append the string data */
<span class="nc" id="L1170">            pBuilder.append(theCategory.getName());</span>

            /* If we have classes */
<span class="nc bnc" id="L1173" title="All 2 branches missed.">            if (theClasses != null) {</span>
                /* Add class indicator */
<span class="nc" id="L1175">                pBuilder.append(QIF_CLASS);</span>

                /* Iterate through the list */
<span class="nc" id="L1178">                final Iterator&lt;MoneyWiseQIFClass&gt; myIterator = theClasses.iterator();</span>
<span class="nc bnc" id="L1179" title="All 2 branches missed.">                while (myIterator.hasNext()) {</span>
<span class="nc" id="L1180">                    final MoneyWiseQIFClass myClass = myIterator.next();</span>

                    /* Add to the list */
<span class="nc" id="L1183">                    pBuilder.append(myClass.getName());</span>
<span class="nc bnc" id="L1184" title="All 2 branches missed.">                    if (myIterator.hasNext()) {</span>
<span class="nc" id="L1185">                        pBuilder.append(QIF_CLASSSEP);</span>
                    }
<span class="nc" id="L1187">                }</span>
            }
<span class="nc" id="L1189">        }</span>

        /**
         * Parse category line.
         * @param pFile the QIF File
         * @param pLine the line.
         * @return the account name (or null)
         */
        protected static MoneyWiseQIFEventCategory parseCategory(final MoneyWiseQIFFile pFile,
                                                                 final String pLine) {
            /* Determine line to use */
<span class="nc" id="L1200">            String myLine = pLine;</span>

            /* If the line contains a category separator */
<span class="nc bnc" id="L1203" title="All 2 branches missed.">            if (pLine.contains(QIF_CATSEP)) {</span>
                /* Drop data after separator */
<span class="nc" id="L1205">                final int i = pLine.indexOf(QIF_CATSEP);</span>
<span class="nc" id="L1206">                myLine = pLine.substring(0, i);</span>
            }

            /* If the line contains classes */
<span class="nc bnc" id="L1210" title="All 2 branches missed.">            if (myLine.contains(QIF_CLASS)) {</span>
                /* drop class data */
<span class="nc" id="L1212">                final int i = myLine.indexOf(QIF_CLASS);</span>
<span class="nc" id="L1213">                myLine = myLine.substring(0, i);</span>
            }

            /* If we have the account delimiters */
<span class="nc bnc" id="L1217" title="All 2 branches missed.">            if ((myLine.startsWith(QIF_XFERSTART))</span>
<span class="nc bnc" id="L1218" title="All 2 branches missed.">                    &amp;&amp; (myLine.endsWith(QIF_XFEREND))) {</span>
                /* This is an account */
<span class="nc" id="L1220">                return null;</span>
            }

            /* Return category */
<span class="nc" id="L1224">            return pFile.getCategory(myLine);</span>
        }

        /**
         * Parse category classes.
         * @param pFile the QIF File
         * @param pLine the line.
         * @return the account name (or null)
         */
        protected static List&lt;MoneyWiseQIFClass&gt; parseCategoryClasses(final MoneyWiseQIFFile pFile,
                                                                      final String pLine) {
            /* Determine line to use */
<span class="nc" id="L1236">            String myLine = pLine;</span>

            /* If the line contains a category separator */
<span class="nc bnc" id="L1239" title="All 2 branches missed.">            if (pLine.contains(QIF_CATSEP)) {</span>
                /* Drop data after separator */
<span class="nc" id="L1241">                final int i = pLine.indexOf(QIF_CATSEP);</span>
<span class="nc" id="L1242">                myLine = pLine.substring(0, i);</span>
            }

            /* If the line contains classes */
<span class="nc bnc" id="L1246" title="All 2 branches missed.">            if (myLine.contains(QIF_CLASS)) {</span>
                /* drop preceding data */
<span class="nc" id="L1248">                final int i = myLine.indexOf(QIF_CLASS);</span>
<span class="nc" id="L1249">                myLine = myLine.substring(i + 1);</span>

                /* Build list of classes */
<span class="nc" id="L1252">                final String[] myClasses = myLine.split(QIF_CLASSSEP);</span>
<span class="nc" id="L1253">                final List&lt;MoneyWiseQIFClass&gt; myList = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L1254" title="All 2 branches missed.">                for (String myClass : myClasses) {</span>
<span class="nc" id="L1255">                    myList.add(pFile.getClass(myClass));</span>
                }

                /* Return the classes */
<span class="nc" id="L1259">                return myList;</span>
            }

            /* Return no classes */
<span class="nc" id="L1263">            return null;</span>
        }

        @Override
        public boolean equals(final Object pThat) {
            /* Handle trivial cases */
<span class="nc bnc" id="L1269" title="All 2 branches missed.">            if (this == pThat) {</span>
<span class="nc" id="L1270">                return true;</span>
            }
<span class="nc bnc" id="L1272" title="All 2 branches missed.">            if (pThat == null) {</span>
<span class="nc" id="L1273">                return false;</span>
            }

            /* Check class */
<span class="nc bnc" id="L1277" title="All 2 branches missed.">            if (!getClass().equals(pThat.getClass())) {</span>
<span class="nc" id="L1278">                return false;</span>
            }

            /* Cast correctly */
<span class="nc" id="L1282">            final MoneyWiseQIFCategoryLine&lt;?&gt; myLine = (MoneyWiseQIFCategoryLine&lt;?&gt;) pThat;</span>

            /* Check line type */
<span class="nc bnc" id="L1285" title="All 2 branches missed.">            if (!getLineType().equals(myLine.getLineType())) {</span>
<span class="nc" id="L1286">                return false;</span>
            }

            /* Check category */
<span class="nc bnc" id="L1290" title="All 2 branches missed.">            if (!theCategory.equals(myLine.getEventCategory())) {</span>
<span class="nc" id="L1291">                return false;</span>
            }

            /* Check classes */
<span class="nc" id="L1295">            final List&lt;MoneyWiseQIFClass&gt; myClasses = myLine.getClassList();</span>
<span class="nc bnc" id="L1296" title="All 2 branches missed.">            if (theClasses == null) {</span>
<span class="nc bnc" id="L1297" title="All 2 branches missed.">                return myClasses == null;</span>
<span class="nc bnc" id="L1298" title="All 2 branches missed.">            } else if (myClasses == null) {</span>
<span class="nc" id="L1299">                return true;</span>
            }
<span class="nc" id="L1301">            return theClasses.equals(myClasses);</span>
        }

        @Override
        public int hashCode() {
<span class="nc" id="L1306">            int myResult = MoneyWiseQIFFile.HASH_BASE * getLineType().hashCode();</span>
<span class="nc bnc" id="L1307" title="All 2 branches missed.">            if (theClasses != null) {</span>
<span class="nc" id="L1308">                myResult += theClasses.hashCode();</span>
<span class="nc" id="L1309">                myResult *= MoneyWiseQIFFile.HASH_BASE;</span>
            }
<span class="nc" id="L1311">            return myResult + theCategory.hashCode();</span>
        }
    }

    /**
     * The Event Category line.
     * @param &lt;X&gt; the line type
     */
    public abstract static class MoneyWiseQIFCategoryAccountLine&lt;X extends MoneyWiseQLineType&gt;
            extends MoneyWiseQIFLine&lt;X&gt; {
        /**
         * The event category.
         */
        private final MoneyWiseQIFEventCategory theCategory;

        /**
         * The account.
         */
        private final MoneyWiseQIFAccount theAccount;

        /**
         * The class list.
         */
        private final List&lt;MoneyWiseQIFClass&gt; theClasses;

        /**
         * Constructor.
         * @param pCategory the Event Category
         * @param pAccount the Account
         */
        protected MoneyWiseQIFCategoryAccountLine(final MoneyWiseQIFEventCategory pCategory,
                                                  final MoneyWiseQIFAccount pAccount) {
<span class="nc" id="L1343">            this(pCategory, pAccount, null);</span>
<span class="nc" id="L1344">        }</span>

        /**
         * Constructor.
         * @param pCategory the Event Category
         * @param pAccount the Account
         * @param pClasses the classes
         */
        protected MoneyWiseQIFCategoryAccountLine(final MoneyWiseQIFEventCategory pCategory,
                                                  final MoneyWiseQIFAccount pAccount,
<span class="nc" id="L1354">                                                  final List&lt;MoneyWiseQIFClass&gt; pClasses) {</span>
            /* Store data */
<span class="nc" id="L1356">            theCategory = pCategory;</span>
<span class="nc" id="L1357">            theAccount = pAccount;</span>
<span class="nc" id="L1358">            theClasses = pClasses;</span>
<span class="nc" id="L1359">        }</span>

        /**
         * Obtain event category.
         * @return the event category
         */
        public MoneyWiseQIFEventCategory getEventCategory() {
<span class="nc" id="L1366">            return theCategory;</span>
        }

        /**
         * Obtain account.
         * @return the account
         */
        public MoneyWiseQIFAccount getAccount() {
<span class="nc" id="L1374">            return theAccount;</span>
        }

        /**
         * Obtain class list.
         * @return the class list
         */
        public List&lt;MoneyWiseQIFClass&gt; getClassList() {
<span class="nc" id="L1382">            return theClasses;</span>
        }

        @Override
        protected void formatData(final OceanusDataFormatter pFormatter,
                                  final StringBuilder pBuilder) {
            /* Append the string data */
<span class="nc" id="L1389">            pBuilder.append(theCategory.getName());</span>
<span class="nc" id="L1390">            pBuilder.append(QIF_CATSEP);</span>
<span class="nc" id="L1391">            pBuilder.append(QIF_XFERSTART);</span>
<span class="nc" id="L1392">            pBuilder.append(theAccount.getName());</span>
<span class="nc" id="L1393">            pBuilder.append(QIF_XFEREND);</span>

            /* If we have classes */
<span class="nc bnc" id="L1396" title="All 2 branches missed.">            if (theClasses != null) {</span>
                /* Add class indicator */
<span class="nc" id="L1398">                pBuilder.append(QIF_CLASS);</span>

                /* Iterate through the list */
<span class="nc" id="L1401">                final Iterator&lt;MoneyWiseQIFClass&gt; myIterator = theClasses.iterator();</span>
<span class="nc bnc" id="L1402" title="All 2 branches missed.">                while (myIterator.hasNext()) {</span>
<span class="nc" id="L1403">                    final MoneyWiseQIFClass myClass = myIterator.next();</span>

                    /* Add to the list */
<span class="nc" id="L1406">                    pBuilder.append(myClass.getName());</span>
<span class="nc bnc" id="L1407" title="All 2 branches missed.">                    if (myIterator.hasNext()) {</span>
<span class="nc" id="L1408">                        pBuilder.append(QIF_CLASSSEP);</span>
                    }
<span class="nc" id="L1410">                }</span>
            }
<span class="nc" id="L1412">        }</span>

        @Override
        public boolean equals(final Object pThat) {
            /* Handle trivial cases */
<span class="nc bnc" id="L1417" title="All 2 branches missed.">            if (this == pThat) {</span>
<span class="nc" id="L1418">                return true;</span>
            }
<span class="nc bnc" id="L1420" title="All 2 branches missed.">            if (pThat == null) {</span>
<span class="nc" id="L1421">                return false;</span>
            }

            /* Check class */
<span class="nc bnc" id="L1425" title="All 2 branches missed.">            if (!getClass().equals(pThat.getClass())) {</span>
<span class="nc" id="L1426">                return false;</span>
            }

            /* Cast correctly */
<span class="nc" id="L1430">            final MoneyWiseQIFCategoryAccountLine&lt;?&gt; myLine = (MoneyWiseQIFCategoryAccountLine&lt;?&gt;) pThat;</span>

            /* Check line type */
<span class="nc bnc" id="L1433" title="All 2 branches missed.">            if (!getLineType().equals(myLine.getLineType())) {</span>
<span class="nc" id="L1434">                return false;</span>
            }

            /* Check category */
<span class="nc bnc" id="L1438" title="All 2 branches missed.">            if (!theCategory.equals(myLine.getEventCategory())) {</span>
<span class="nc" id="L1439">                return false;</span>
            }

            /* Check account */
<span class="nc bnc" id="L1443" title="All 2 branches missed.">            if (!theAccount.equals(myLine.getAccount())) {</span>
<span class="nc" id="L1444">                return false;</span>
            }

            /* Check classes */
<span class="nc" id="L1448">            final List&lt;MoneyWiseQIFClass&gt; myClasses = myLine.getClassList();</span>
<span class="nc bnc" id="L1449" title="All 2 branches missed.">            if (theClasses == null) {</span>
<span class="nc bnc" id="L1450" title="All 2 branches missed.">                return myClasses == null;</span>
<span class="nc bnc" id="L1451" title="All 2 branches missed.">            } else if (myClasses == null) {</span>
<span class="nc" id="L1452">                return true;</span>
            }
<span class="nc" id="L1454">            return theClasses.equals(myClasses);</span>
        }

        @Override
        public int hashCode() {
<span class="nc" id="L1459">            int myResult = MoneyWiseQIFFile.HASH_BASE * getLineType().hashCode();</span>
<span class="nc bnc" id="L1460" title="All 2 branches missed.">            if (theClasses != null) {</span>
<span class="nc" id="L1461">                myResult += theClasses.hashCode();</span>
<span class="nc" id="L1462">                myResult *= MoneyWiseQIFFile.HASH_BASE;</span>
            }
<span class="nc" id="L1464">            myResult += theAccount.hashCode();</span>
<span class="nc" id="L1465">            myResult *= MoneyWiseQIFFile.HASH_BASE;</span>
<span class="nc" id="L1466">            return myResult + theCategory.hashCode();</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>