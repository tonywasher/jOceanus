<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>MoneyWiseAnalysis.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">MoneyWise Personal Finance - Core</a> &gt; <a href="index.source.html" class="el_package">io.github.tonywasher.joceanus.moneywise.lethe.data.analysis.data</a> &gt; <span class="el_source">MoneyWiseAnalysis.java</span></div><h1>MoneyWiseAnalysis.java</h1><pre class="source lang-java linenums">/*
 * MoneyWise: Finance Application
 * Copyright 2012-2026. Tony Washer
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not
 * use this file except in compliance with the License.  You may obtain a copy
 * of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */
package io.github.tonywasher.joceanus.moneywise.lethe.data.analysis.data;

import io.github.tonywasher.joceanus.oceanus.date.OceanusDate;
import io.github.tonywasher.joceanus.oceanus.date.OceanusDateRange;
import io.github.tonywasher.joceanus.oceanus.decimal.OceanusMoney;
import io.github.tonywasher.joceanus.oceanus.format.OceanusDataFormatter;
import io.github.tonywasher.joceanus.metis.field.MetisFieldItem;
import io.github.tonywasher.joceanus.metis.field.MetisFieldSet;
import io.github.tonywasher.joceanus.metis.preference.MetisPreferenceManager;
import io.github.tonywasher.joceanus.moneywise.data.basic.MoneyWiseBasicDataType;
import io.github.tonywasher.joceanus.moneywise.data.basic.MoneyWiseBasicResource;
import io.github.tonywasher.joceanus.moneywise.data.basic.MoneyWiseCash;
import io.github.tonywasher.joceanus.moneywise.data.basic.MoneyWiseCash.MoneyWiseCashList;
import io.github.tonywasher.joceanus.moneywise.data.basic.MoneyWiseDataSet;
import io.github.tonywasher.joceanus.moneywise.data.basic.MoneyWiseDeposit;
import io.github.tonywasher.joceanus.moneywise.data.basic.MoneyWiseDeposit.MoneyWiseDepositList;
import io.github.tonywasher.joceanus.moneywise.data.basic.MoneyWiseLoan;
import io.github.tonywasher.joceanus.moneywise.data.basic.MoneyWiseLoan.MoneyWiseLoanList;
import io.github.tonywasher.joceanus.moneywise.data.statics.MoneyWiseCurrency;
import io.github.tonywasher.joceanus.moneywise.data.statics.MoneyWiseStaticDataType;
import io.github.tonywasher.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisCashBucket.MoneyWiseAnalysisCashBucketList;
import io.github.tonywasher.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisCashCategoryBucket.MoneyWiseAnalysisCashCategoryBucketList;
import io.github.tonywasher.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisDepositBucket.MoneyWiseAnalysisDepositBucketList;
import io.github.tonywasher.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisDepositCategoryBucket.MoneyWiseAnalysisDepositCategoryBucketList;
import io.github.tonywasher.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisLoanBucket.MoneyWiseAnalysisLoanBucketList;
import io.github.tonywasher.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisLoanCategoryBucket.MoneyWiseAnalysisLoanCategoryBucketList;
import io.github.tonywasher.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisPayeeBucket.MoneyWiseAnalysisPayeeBucketList;
import io.github.tonywasher.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisPortfolioBucket.MoneyWiseAnalysisPortfolioBucketList;
import io.github.tonywasher.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisTaxBasisBucket.MoneyWiseAnalysisTaxBasisBucketList;
import io.github.tonywasher.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisTransCategoryBucket.MoneyWiseAnalysisTransCategoryBucketList;
import io.github.tonywasher.joceanus.moneywise.lethe.data.analysis.data.MoneyWiseAnalysisTransTagBucket.MoneyWiseAnalysisTransTagBucketList;
import io.github.tonywasher.joceanus.moneywise.tax.MoneyWiseTaxAnalysis;
import io.github.tonywasher.joceanus.moneywise.tax.MoneyWiseTaxYear;
import io.github.tonywasher.joceanus.moneywise.tax.MoneyWiseTaxYearCache;
import io.github.tonywasher.joceanus.moneywise.tax.uk.MoneyWiseUKTaxYearCache;
import io.github.tonywasher.joceanus.prometheus.views.PrometheusEditSet;

import java.util.Iterator;

/**
 * Data Analysis.
 *
 * @author Tony Washer
 */
public class MoneyWiseAnalysis
        implements MetisFieldItem {
    /**
     * Local Report fields.
     */
<span class="fc" id="L66">    private static final MetisFieldSet&lt;MoneyWiseAnalysis&gt; FIELD_DEFS = MetisFieldSet.newFieldSet(MoneyWiseAnalysis.class);</span>

    /*
     * Declare Fields.
     */
    static {
<span class="fc" id="L72">        FIELD_DEFS.declareLocalField(MoneyWiseBasicResource.MONEYWISEDATA_RANGE, MoneyWiseAnalysis::getDateRange);</span>
<span class="fc" id="L73">        FIELD_DEFS.declareLocalField(MoneyWiseAnalysisDataResource.TAX_YEARS, MoneyWiseAnalysis::getTaxYearCache);</span>
<span class="fc" id="L74">        FIELD_DEFS.declareLocalField(MoneyWiseStaticDataType.CURRENCY, MoneyWiseAnalysis::getCurrency);</span>
<span class="fc" id="L75">        FIELD_DEFS.declareLocalField(MoneyWiseBasicDataType.DEPOSIT.getListId(), MoneyWiseAnalysis::getDeposits);</span>
<span class="fc" id="L76">        FIELD_DEFS.declareLocalField(MoneyWiseBasicDataType.CASH.getListId(), MoneyWiseAnalysis::getCash);</span>
<span class="fc" id="L77">        FIELD_DEFS.declareLocalField(MoneyWiseBasicDataType.LOAN.getListId(), MoneyWiseAnalysis::getLoans);</span>
<span class="fc" id="L78">        FIELD_DEFS.declareLocalField(MoneyWiseBasicDataType.PAYEE.getListId(), MoneyWiseAnalysis::getPayees);</span>
<span class="fc" id="L79">        FIELD_DEFS.declareLocalField(MoneyWiseBasicDataType.PORTFOLIO.getListId(), MoneyWiseAnalysis::getPortfolios);</span>
<span class="fc" id="L80">        FIELD_DEFS.declareLocalField(MoneyWiseBasicDataType.DEPOSITCATEGORY.getListId(), MoneyWiseAnalysis::getDepositCategories);</span>
<span class="fc" id="L81">        FIELD_DEFS.declareLocalField(MoneyWiseBasicDataType.CASHCATEGORY.getListId(), MoneyWiseAnalysis::getCashCategories);</span>
<span class="fc" id="L82">        FIELD_DEFS.declareLocalField(MoneyWiseBasicDataType.LOANCATEGORY.getListId(), MoneyWiseAnalysis::getLoanCategories);</span>
<span class="fc" id="L83">        FIELD_DEFS.declareLocalField(MoneyWiseBasicDataType.TRANSCATEGORY.getListId(), MoneyWiseAnalysis::getTransCategories);</span>
<span class="fc" id="L84">        FIELD_DEFS.declareLocalField(MoneyWiseBasicDataType.TRANSTAG.getListId(), MoneyWiseAnalysis::getTransactionTags);</span>
<span class="fc" id="L85">        FIELD_DEFS.declareLocalField(MoneyWiseStaticDataType.TAXBASIS.getListId(), MoneyWiseAnalysis::getTaxBasis);</span>
<span class="fc" id="L86">        FIELD_DEFS.declareLocalField(MoneyWiseAnalysisDataResource.TAX_CALCULATION, MoneyWiseAnalysis::getTaxAnalysis);</span>
<span class="fc" id="L87">    }</span>

    /**
     * The EditSet.
     */
    private final PrometheusEditSet theEditSet;

    /**
     * The taxYear cache.
     */
    private final MoneyWiseTaxYearCache theTaxYearCache;

    /**
     * The Currency.
     */
    private final MoneyWiseCurrency theCurrency;

    /**
     * The Preference Manager.
     */
    private final MetisPreferenceManager thePreferences;

    /**
     * The DataRange.
     */
    private final OceanusDateRange theDateRange;

    /**
     * The deposit buckets.
     */
    private final MoneyWiseAnalysisDepositBucketList theDeposits;

    /**
     * The cash buckets.
     */
    private final MoneyWiseAnalysisCashBucketList theCash;

    /**
     * The loan buckets.
     */
    private final MoneyWiseAnalysisLoanBucketList theLoans;

    /**
     * The payee buckets.
     */
    private final MoneyWiseAnalysisPayeeBucketList thePayees;

    /**
     * The portfolio buckets.
     */
    private final MoneyWiseAnalysisPortfolioBucketList thePortfolios;

    /**
     * The deposit category buckets.
     */
    private final MoneyWiseAnalysisDepositCategoryBucketList theDepositCategories;

    /**
     * The cash category buckets.
     */
    private final MoneyWiseAnalysisCashCategoryBucketList theCashCategories;

    /**
     * The loan category buckets.
     */
    private final MoneyWiseAnalysisLoanCategoryBucketList theLoanCategories;

    /**
     * The transaction category buckets.
     */
    private final MoneyWiseAnalysisTransCategoryBucketList theTransCategories;

    /**
     * The TransactionTag buckets.
     */
    private final MoneyWiseAnalysisTransTagBucketList theTransTags;

    /**
     * The tax basis buckets.
     */
    private final MoneyWiseAnalysisTaxBasisBucketList theTaxBasis;

    /**
     * The new tax calculations.
     */
    private final MoneyWiseTaxAnalysis theTaxAnalysis;

    /**
     * Constructor for a full analysis.
     *
     * @param pEditSet       the editSet to analyse events for
     * @param pPreferenceMgr the preference manager
     */
    public MoneyWiseAnalysis(final PrometheusEditSet pEditSet,
<span class="fc" id="L181">                             final MetisPreferenceManager pPreferenceMgr) {</span>
        /* Store the data */
<span class="fc" id="L183">        theEditSet = pEditSet;</span>
<span class="fc" id="L184">        final MoneyWiseDataSet myDataSet = getData();</span>
<span class="fc" id="L185">        theCurrency = myDataSet.getReportingCurrency();</span>
<span class="fc" id="L186">        thePreferences = pPreferenceMgr;</span>
<span class="fc" id="L187">        theDateRange = myDataSet.getDateRange();</span>

        /* Access the TaxYearCache */
<span class="fc" id="L190">        theTaxYearCache = (MoneyWiseUKTaxYearCache) myDataSet.getTaxFactory();</span>

        /* Create a new set of buckets */
<span class="fc" id="L193">        theDeposits = new MoneyWiseAnalysisDepositBucketList(this);</span>
<span class="fc" id="L194">        theCash = new MoneyWiseAnalysisCashBucketList(this);</span>
<span class="fc" id="L195">        theLoans = new MoneyWiseAnalysisLoanBucketList(this);</span>
<span class="fc" id="L196">        thePortfolios = new MoneyWiseAnalysisPortfolioBucketList(this);</span>
<span class="fc" id="L197">        thePayees = new MoneyWiseAnalysisPayeeBucketList(this);</span>
<span class="fc" id="L198">        theTaxBasis = new MoneyWiseAnalysisTaxBasisBucketList(this);</span>
<span class="fc" id="L199">        theTransCategories = new MoneyWiseAnalysisTransCategoryBucketList(this);</span>
<span class="fc" id="L200">        theTransTags = new MoneyWiseAnalysisTransTagBucketList(this);</span>

        /* Create totalling buckets */
<span class="fc" id="L203">        theDepositCategories = new MoneyWiseAnalysisDepositCategoryBucketList(this);</span>
<span class="fc" id="L204">        theCashCategories = new MoneyWiseAnalysisCashCategoryBucketList(this);</span>
<span class="fc" id="L205">        theLoanCategories = new MoneyWiseAnalysisLoanCategoryBucketList(this);</span>
<span class="fc" id="L206">        theTaxAnalysis = null;</span>
<span class="fc" id="L207">    }</span>

    /**
     * Constructor for a copy analysis.
     *
     * @param pSource the base analysis
     */
<span class="nc" id="L214">    public MoneyWiseAnalysis(final MoneyWiseAnalysis pSource) {</span>
        /* Store the data */
<span class="nc" id="L216">        theEditSet = pSource.getEditSet();</span>
<span class="nc" id="L217">        theCurrency = pSource.getCurrency();</span>
<span class="nc" id="L218">        thePreferences = pSource.getPreferenceMgr();</span>
<span class="nc" id="L219">        theDateRange = pSource.getDateRange();</span>

        /* Access the TaxYearCache */
<span class="nc" id="L222">        theTaxYearCache = (MoneyWiseUKTaxYearCache) getData().getTaxFactory();</span>

        /* Create a new set of buckets */
<span class="nc" id="L225">        theDeposits = new MoneyWiseAnalysisDepositBucketList(this, pSource.getDeposits());</span>
<span class="nc" id="L226">        theCash = new MoneyWiseAnalysisCashBucketList(this, pSource.getCash());</span>
<span class="nc" id="L227">        theLoans = new MoneyWiseAnalysisLoanBucketList(this, pSource.getLoans());</span>
<span class="nc" id="L228">        thePortfolios = new MoneyWiseAnalysisPortfolioBucketList(this, pSource.getPortfolios());</span>
<span class="nc" id="L229">        thePayees = new MoneyWiseAnalysisPayeeBucketList(this);</span>
<span class="nc" id="L230">        theTaxBasis = new MoneyWiseAnalysisTaxBasisBucketList(this);</span>
<span class="nc" id="L231">        theTransCategories = new MoneyWiseAnalysisTransCategoryBucketList(this);</span>
<span class="nc" id="L232">        theTransTags = new MoneyWiseAnalysisTransTagBucketList(this);</span>

        /* Create totalling buckets */
<span class="nc" id="L235">        theDepositCategories = new MoneyWiseAnalysisDepositCategoryBucketList(this);</span>
<span class="nc" id="L236">        theCashCategories = new MoneyWiseAnalysisCashCategoryBucketList(this);</span>
<span class="nc" id="L237">        theLoanCategories = new MoneyWiseAnalysisLoanCategoryBucketList(this);</span>
<span class="nc" id="L238">        theTaxAnalysis = null;</span>
<span class="nc" id="L239">    }</span>

    /**
     * Constructor for a dated analysis.
     *
     * @param pManager the analysis manager
     * @param pDate    the date for the analysis
     */
    public MoneyWiseAnalysis(final MoneyWiseAnalysisManager pManager,
<span class="nc" id="L248">                             final OceanusDate pDate) {</span>
        /* Store the data */
<span class="nc" id="L250">        final MoneyWiseAnalysis myBase = pManager.getAnalysis();</span>
<span class="nc" id="L251">        theEditSet = myBase.getEditSet();</span>
<span class="nc" id="L252">        final MoneyWiseDataSet myDataSet = getData();</span>
<span class="nc" id="L253">        theCurrency = myBase.getCurrency();</span>
<span class="nc" id="L254">        thePreferences = myBase.getPreferenceMgr();</span>
<span class="nc" id="L255">        theDateRange = new OceanusDateRange(myDataSet.getDateRange().getStart(), pDate);</span>

        /* Access the TaxYearCache */
<span class="nc" id="L258">        theTaxYearCache = (MoneyWiseUKTaxYearCache) myDataSet.getTaxFactory();</span>

        /* Create a new set of buckets */
<span class="nc" id="L261">        theDeposits = new MoneyWiseAnalysisDepositBucketList(this, myBase.getDeposits(), pDate);</span>
<span class="nc" id="L262">        theCash = new MoneyWiseAnalysisCashBucketList(this, myBase.getCash(), pDate);</span>
<span class="nc" id="L263">        theLoans = new MoneyWiseAnalysisLoanBucketList(this, myBase.getLoans(), pDate);</span>
<span class="nc" id="L264">        thePortfolios = new MoneyWiseAnalysisPortfolioBucketList(this, myBase.getPortfolios(), pDate);</span>
<span class="nc" id="L265">        thePayees = new MoneyWiseAnalysisPayeeBucketList(this, myBase.getPayees(), pDate);</span>
<span class="nc" id="L266">        theTaxBasis = new MoneyWiseAnalysisTaxBasisBucketList(this, myBase.getTaxBasis(), pDate);</span>
<span class="nc" id="L267">        theTransCategories = new MoneyWiseAnalysisTransCategoryBucketList(this, myBase.getTransCategories(), pDate);</span>
<span class="nc" id="L268">        theTransTags = new MoneyWiseAnalysisTransTagBucketList(this, myBase.getTransactionTags(), pDate);</span>

        /* Create totalling buckets */
<span class="nc" id="L271">        theDepositCategories = new MoneyWiseAnalysisDepositCategoryBucketList(this);</span>
<span class="nc" id="L272">        theCashCategories = new MoneyWiseAnalysisCashCategoryBucketList(this);</span>
<span class="nc" id="L273">        theLoanCategories = new MoneyWiseAnalysisLoanCategoryBucketList(this);</span>
<span class="nc" id="L274">        theTaxAnalysis = null;</span>
<span class="nc" id="L275">    }</span>

    /**
     * Constructor for a ranged analysis.
     *
     * @param pManager the analysis manager
     * @param pRange   the range for the analysis
     */
    public MoneyWiseAnalysis(final MoneyWiseAnalysisManager pManager,
<span class="nc" id="L284">                             final OceanusDateRange pRange) {</span>
        /* Store the data */
<span class="nc" id="L286">        final MoneyWiseAnalysis myBase = pManager.getAnalysis();</span>
<span class="nc" id="L287">        theEditSet = myBase.getEditSet();</span>
<span class="nc" id="L288">        final MoneyWiseDataSet myDataSet = getData();</span>
<span class="nc" id="L289">        theCurrency = myBase.getCurrency();</span>
<span class="nc" id="L290">        thePreferences = myBase.getPreferenceMgr();</span>
<span class="nc" id="L291">        theDateRange = pRange;</span>

        /* Access the TaxYearCache */
<span class="nc" id="L294">        theTaxYearCache = (MoneyWiseUKTaxYearCache) myDataSet.getTaxFactory();</span>

        /* Create a new set of buckets */
<span class="nc" id="L297">        theDeposits = new MoneyWiseAnalysisDepositBucketList(this, myBase.getDeposits(), pRange);</span>
<span class="nc" id="L298">        theCash = new MoneyWiseAnalysisCashBucketList(this, myBase.getCash(), pRange);</span>
<span class="nc" id="L299">        theLoans = new MoneyWiseAnalysisLoanBucketList(this, myBase.getLoans(), pRange);</span>
<span class="nc" id="L300">        thePortfolios = new MoneyWiseAnalysisPortfolioBucketList(this, myBase.getPortfolios(), pRange);</span>
<span class="nc" id="L301">        thePayees = new MoneyWiseAnalysisPayeeBucketList(this, myBase.getPayees(), pRange);</span>
<span class="nc" id="L302">        theTaxBasis = new MoneyWiseAnalysisTaxBasisBucketList(this, myBase.getTaxBasis(), pRange);</span>
<span class="nc" id="L303">        theTransCategories = new MoneyWiseAnalysisTransCategoryBucketList(this, myBase.getTransCategories(), pRange);</span>
<span class="nc" id="L304">        theTransTags = new MoneyWiseAnalysisTransTagBucketList(this, myBase.getTransactionTags(), pRange);</span>

        /* Create totalling buckets */
<span class="nc" id="L307">        theDepositCategories = new MoneyWiseAnalysisDepositCategoryBucketList(this);</span>
<span class="nc" id="L308">        theCashCategories = new MoneyWiseAnalysisCashCategoryBucketList(this);</span>
<span class="nc" id="L309">        theLoanCategories = new MoneyWiseAnalysisLoanCategoryBucketList(this);</span>

        /* Handle new tax calculations */
<span class="nc" id="L312">        final MoneyWiseTaxYear myYear = (MoneyWiseTaxYear) theTaxYearCache.findTaxYearForRange(theDateRange);</span>
<span class="nc bnc" id="L313" title="All 2 branches missed.">        theTaxAnalysis = myYear != null</span>
<span class="nc" id="L314">                ? myYear.analyseTaxYear(thePreferences, theTaxBasis)</span>
<span class="nc" id="L315">                : null;</span>
<span class="nc" id="L316">    }</span>

    /**
     * Is the analysis manager idle?
     *
     * @return true/false
     */
    public boolean isIdle() {
<span class="nc bnc" id="L324" title="All 2 branches missed.">        return theCurrency == null;</span>
    }

    @Override
    public MetisFieldSet&lt;MoneyWiseAnalysis&gt; getDataFieldSet() {
<span class="nc" id="L329">        return FIELD_DEFS;</span>
    }

    @Override
    public String formatObject(final OceanusDataFormatter pFormatter) {
<span class="nc" id="L334">        return FIELD_DEFS.getName();</span>
    }

    /**
     * Obtain the editSet.
     *
     * @return the editSet
     */
    public PrometheusEditSet getEditSet() {
<span class="fc" id="L343">        return theEditSet;</span>
    }

    /**
     * Obtain the data.
     *
     * @return the data
     */
    public MoneyWiseDataSet getData() {
<span class="fc" id="L352">        return (MoneyWiseDataSet) theEditSet.getDataSet();</span>
    }

    /**
     * Obtain the currency.
     *
     * @return the currency
     */
    private MoneyWiseTaxYearCache getTaxYearCache() {
<span class="nc" id="L361">        return theTaxYearCache;</span>
    }

    /**
     * Obtain the currency.
     *
     * @return the currency
     */
    public MoneyWiseCurrency getCurrency() {
<span class="fc" id="L370">        return theCurrency;</span>
    }

    /**
     * Obtain the preference manager.
     *
     * @return the data
     */
    public MetisPreferenceManager getPreferenceMgr() {
<span class="nc" id="L379">        return thePreferences;</span>
    }

    /**
     * Obtain the date range.
     *
     * @return the date range
     */
    public OceanusDateRange getDateRange() {
<span class="fc" id="L388">        return theDateRange;</span>
    }

    /**
     * Is this a ranged analysis?
     *
     * @return true/false
     */
    public boolean isRangedAnalysis() {
<span class="nc bnc" id="L397" title="All 2 branches missed.">        return theDateRange.getStart() == null;</span>
    }

    /**
     * Obtain the deposit buckets list.
     *
     * @return the list
     */
    public MoneyWiseAnalysisDepositBucketList getDeposits() {
<span class="fc" id="L406">        return theDeposits;</span>
    }

    /**
     * Obtain the cash buckets list.
     *
     * @return the list
     */
    public MoneyWiseAnalysisCashBucketList getCash() {
<span class="fc" id="L415">        return theCash;</span>
    }

    /**
     * Obtain the loan buckets list.
     *
     * @return the list
     */
    public MoneyWiseAnalysisLoanBucketList getLoans() {
<span class="fc" id="L424">        return theLoans;</span>
    }

    /**
     * Obtain the portfolio buckets list.
     *
     * @return the list
     */
    public MoneyWiseAnalysisPortfolioBucketList getPortfolios() {
<span class="fc" id="L433">        return thePortfolios;</span>
    }

    /**
     * Obtain the payee buckets list.
     *
     * @return the list
     */
    public MoneyWiseAnalysisPayeeBucketList getPayees() {
<span class="fc" id="L442">        return thePayees;</span>
    }

    /**
     * Obtain the deposit categories list.
     *
     * @return the list
     */
    public MoneyWiseAnalysisDepositCategoryBucketList getDepositCategories() {
<span class="fc" id="L451">        return theDepositCategories;</span>
    }

    /**
     * Obtain the cash categories list.
     *
     * @return the list
     */
    public MoneyWiseAnalysisCashCategoryBucketList getCashCategories() {
<span class="fc" id="L460">        return theCashCategories;</span>
    }

    /**
     * Obtain the loan categories list.
     *
     * @return the list
     */
    public MoneyWiseAnalysisLoanCategoryBucketList getLoanCategories() {
<span class="fc" id="L469">        return theLoanCategories;</span>
    }

    /**
     * Obtain the transaction categories list.
     *
     * @return the list
     */
    public MoneyWiseAnalysisTransCategoryBucketList getTransCategories() {
<span class="fc" id="L478">        return theTransCategories;</span>
    }

    /**
     * Obtain the transactionTag list.
     *
     * @return the list
     */
    public MoneyWiseAnalysisTransTagBucketList getTransactionTags() {
<span class="fc" id="L487">        return theTransTags;</span>
    }

    /**
     * Obtain the tax basis list.
     *
     * @return the list
     */
    public MoneyWiseAnalysisTaxBasisBucketList getTaxBasis() {
<span class="fc" id="L496">        return theTaxBasis;</span>
    }

    /**
     * Obtain the tax analysis.
     *
     * @return the analysis
     */
    public MoneyWiseTaxAnalysis getTaxAnalysis() {
<span class="nc" id="L505">        return theTaxAnalysis;</span>
    }

    /**
     * Add opening balances for accounts.
     *
     * @param pHelper the transaction helper
     */
    public void addOpeningBalances(final MoneyWiseAnalysisTransactionHelper pHelper) {
        /* Iterate through the deposits */
<span class="fc" id="L515">        final Iterator&lt;MoneyWiseDeposit&gt; myDepIterator = theEditSet.getDataList(MoneyWiseBasicDataType.DEPOSIT, MoneyWiseDepositList.class).iterator();</span>
<span class="pc bpc" id="L516" title="1 of 2 branches missed.">        while (myDepIterator.hasNext()) {</span>
<span class="nc" id="L517">            final MoneyWiseDeposit myDeposit = myDepIterator.next();</span>

            /* If the deposit has an opening balance */
<span class="nc" id="L520">            final OceanusMoney myBalance = myDeposit.getOpeningBalance();</span>
<span class="nc bnc" id="L521" title="All 2 branches missed.">            if (myBalance != null) {</span>
                /* Obtain the actual deposit bucket */
<span class="nc" id="L523">                final MoneyWiseAnalysisDepositBucket myBucket = theDeposits.getBucket(myDeposit);</span>
<span class="nc" id="L524">                myBucket.setOpeningBalance(pHelper, myBalance);</span>
            }
<span class="nc" id="L526">        }</span>

        /* Iterate through the cash */
<span class="fc" id="L529">        final Iterator&lt;MoneyWiseCash&gt; myCashIterator = theEditSet.getDataList(MoneyWiseBasicDataType.CASH, MoneyWiseCashList.class).iterator();</span>
<span class="pc bpc" id="L530" title="1 of 2 branches missed.">        while (myCashIterator.hasNext()) {</span>
<span class="nc" id="L531">            final MoneyWiseCash myCash = myCashIterator.next();</span>

            /* If the cash has an opening balance */
<span class="nc" id="L534">            final OceanusMoney myBalance = myCash.getOpeningBalance();</span>
<span class="nc bnc" id="L535" title="All 2 branches missed.">            if (myBalance != null) {</span>
                /* Obtain the actual cash bucket */
<span class="nc" id="L537">                final MoneyWiseAnalysisCashBucket myBucket = theCash.getBucket(myCash);</span>
<span class="nc" id="L538">                myBucket.setOpeningBalance(pHelper, myBalance);</span>
            }
<span class="nc" id="L540">        }</span>

        /* Iterate through the loans */
<span class="fc" id="L543">        final Iterator&lt;MoneyWiseLoan&gt; myLoanIterator = theEditSet.getDataList(MoneyWiseBasicDataType.LOAN, MoneyWiseLoanList.class).iterator();</span>
<span class="pc bpc" id="L544" title="1 of 2 branches missed.">        while (myLoanIterator.hasNext()) {</span>
<span class="nc" id="L545">            final MoneyWiseLoan myLoan = myLoanIterator.next();</span>

            /* If the loan has an opening balance */
<span class="nc" id="L548">            final OceanusMoney myBalance = myLoan.getOpeningBalance();</span>
<span class="nc bnc" id="L549" title="All 2 branches missed.">            if (myBalance != null) {</span>
                /* Obtain the actual loan bucket */
<span class="nc" id="L551">                final MoneyWiseAnalysisLoanBucket myBucket = theLoans.getBucket(myLoan);</span>
<span class="nc" id="L552">                myBucket.setOpeningBalance(pHelper, myBalance);</span>
            }
<span class="nc" id="L554">        }</span>
<span class="fc" id="L555">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>